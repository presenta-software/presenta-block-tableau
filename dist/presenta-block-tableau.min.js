!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).PresentaBlockTableau=t()}(this,(function(){"use strict";var e="style_tableau__nzP0y",t="style_loading__tn5sw";!function(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===i&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}(".style_tableau__nzP0y{align-items:center;display:flex;height:100%;justify-content:center;width:100%}.style_tableau__nzP0y.style_loading__tn5sw{opacity:0}");
/*! tableau-2.1.2 */
var i={};
/*! tableau-2.2.1 */!function(){
/*! BEGIN MscorlibSlim */
var e={};!function(e){var t,i,n,r,a={__assemblies:{}};a.initAssembly=function(e,t,i){i=i||{},e.name=t,e.toString=function(){return this.name},e.__types={},e.getResourceNames=function(){return Object.keys(i)},e.getResourceDataBase64=function(e){return i[e]||null},e.getResourceData=function(e){var t=i[e];return t?a.dec64(t):null},a.__assemblies[t]=e},a.initAssembly(a,"mscorlib"),a.getAssemblies=function(){return Object.keys(a.__assemblies).map((function(e){return a.__assemblies[e]}))},a.isNullOrUndefined=function(e){return null==e},a.isValue=function(e){return null!=e},a.referenceEquals=function(e,t){return a.isValue(e)?e===t:!a.isValue(t)},a.mkdict=function(){for(var e=1!=arguments.length?arguments:arguments[0],t={},i=0;i<e.length;i+=2)t[e[i]]=e[i+1];return t},a.clone=function(e,t){return t?e.$clone(t):t},a.coalesce=function(e,t){return a.isValue(e)?e:t},a.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},a.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},a.isTypedArrayType=function(e){return["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint16Array","Uint32Array","Uint8ClampedArray"].indexOf(a.getTypeFullName(e))>=0},a.isArrayOrTypedArray=function(e){return a.isArray(e)||a.isTypedArrayType(a.getInstanceType(e))},a.getHashCode=function(e){if(a.isValue(e)){if("function"==typeof e.getHashCode)return e.getHashCode();if("boolean"==typeof e)return e?1:0;if("number"==typeof e){var t=e.toExponential();return t=t.substr(0,t.indexOf("e")),4294967295&parseInt(t.replace(".",""),10)}if("string"==typeof e){for(var i=0,n=0;n<e.length;n++)i=31*i+e.charCodeAt(n)&4294967295;return i}return a.isDate(e)?4294967295&e.valueOf():a.defaultHashCode(e)}throw new j("Cannot get hash code of null")},a.defaultHashCode=function(e){return e.$__hashCode__||(e.$__hashCode__=4294967296*Math.random()|0)},a.equals=function(e,t){if(!a.isValue(e))throw new j("Object is null");return e!==a&&"function"==typeof e.equals?e.equals(t):a.isDate(e)&&a.isDate(t)?e.valueOf()===t.valueOf():"function"==typeof e&&"function"==typeof t?a.delegateEquals(e,t):!(!a.isNullOrUndefined(e)||!a.isNullOrUndefined(t))||e===t},a.compare=function(e,t){if(a.isValue(e))return"number"==typeof e||"string"==typeof e||"boolean"==typeof e?e<t?-1:e>t?1:0:a.isDate(e)?a.compare(e.valueOf(),t.valueOf()):e.compareTo(t);throw new j("Object is null")},a.equalsT=function(e,t){if(a.isValue(e))return"number"==typeof e||"string"==typeof e||"boolean"==typeof e?e===t:a.isDate(e)?e.valueOf()===t.valueOf():e.equalsT(t);throw new j("Object is null")},a.staticEquals=function(e,t){return a.isValue(e)?!!a.isValue(t)&&a.equals(e,t):!a.isValue(t)},a.shallowCopy=function(e,t){for(var i=Object.keys(e),n=0,r=i.length;n<r;n++){var a=i[n];t[a]=e[a]}},a.isLower=function(e){var t=String.fromCharCode(e);return t===t.toLowerCase()&&t!==t.toUpperCase()},a.isUpper=function(e){var t=String.fromCharCode(e);return t!==t.toLowerCase()&&t===t.toUpperCase()},"object"==typeof window&&(window.Element||(window.Element=function(){},window.Element.isInstanceOfType=function(e){return e&&void 0===e.constructor&&"string"==typeof e.tagName}),window.Element.__typeName="Element"),a.clearKeys=function(e){for(var t in e)e.hasOwnProperty(t)&&delete e[t]},a.keyExists=function(e,t){return void 0!==e[t]},Object.keys||(Object.keys=(t=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable("toString"),r=(n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var a,s,o=[];for(a in e)t.call(e,a)&&o.push(a);if(i)for(s=0;s<r;s++)t.call(e,n[s])&&o.push(n[s]);return o})),a.getKeyCount=function(e){return Object.keys(e).length},a.__genericCache={},a._makeGenericTypeName=function(e,t){for(var i=e.__typeName,n=0;n<t.length;n++)i+=(0===n?"[":",")+"["+a.getTypeQName(t[n])+"]";return i+="]"},a.makeGenericType=function(e,t){var i=a._makeGenericTypeName(e,t);return a.__genericCache[i]||e.apply(null,t)},a.registerGenericClassInstance=function(e,t,i,n,r,s){var o=a._makeGenericTypeName(t,i);a.__genericCache[o]=e,e.__typeName=o,e.__genericTypeDefinition=t,e.__typeArguments=i,a.initClass(e,t.__assembly,n,r(),s())},a.registerGenericInterfaceInstance=function(e,t,i,n,r){var s=a._makeGenericTypeName(t,i);a.__genericCache[s]=e,e.__typeName=s,e.__genericTypeDefinition=t,e.__typeArguments=i,a.initInterface(e,t.__assembly,n,r())},a.isGenericTypeDefinition=function(e){return e.__isGenericTypeDefinition||!1},a.getGenericTypeDefinition=function(e){return e.__genericTypeDefinition||null},a.getGenericParameterCount=function(e){return e.__typeArgumentCount||0},a.getGenericArguments=function(e){return e.__typeArguments||null},a.setMetadata=function(e,t){if(t.members)for(var i=0;i<t.members.length;i++){var n=t.members[i];n.typeDef=e,n.adder&&(n.adder.typeDef=e),n.remover&&(n.remover.typeDef=e),n.getter&&(n.getter.typeDef=e),n.setter&&(n.setter.typeDef=e)}e.__metadata=t,t.variance&&(e.isAssignableFrom=function(e){var t=function(e,t){if(t.__genericTypeDefinition===e.__genericTypeDefinition&&t.__typeArguments.length==e.__typeArguments.length){for(var i=0;i<e.__typeArguments.length;i++){var n=e.__metadata.variance[i],r=e.__typeArguments[i],s=t.__typeArguments[i];switch(n){case 1:if(!a.isAssignableFrom(r,s))return!1;break;case 2:if(!a.isAssignableFrom(s,r))return!1;break;default:if(s!==r)return!1}}return!0}return!1};if(e.__interface&&t(this,e))return!0;for(var i=a.getInterfaces(e),n=0;n<i.length;n++)if(i[n]===this||t(this,i[n]))return!0;return!1})},a.setMetadata=function(e,t){},a.initClass=function(e,t,i,n,r){if(e.__class=!0,e.__assembly=t,e.__typeArguments||(t.__types[e.__typeName]=e),n&&n!==Object){var s=function(){};s.prototype=n.prototype,e.prototype=new s,e.prototype.constructor=e}a.shallowCopy(i,e.prototype),r&&(e.__interfaces=r)},a.initGenericClass=function(e,t,i){e.__class=!0,e.__assembly=t,t.__types[e.__typeName]=e,e.__typeArgumentCount=i,e.__isGenericTypeDefinition=!0},a.initInterface=function(e,t,i,n){e.__interface=!0,e.__assembly=t,e.__typeArguments||(t.__types[e.__typeName]=e),n&&(e.__interfaces=n),a.shallowCopy(i,e.prototype),e.isAssignableFrom=function(e){return a.contains(a.getInterfaces(e),this)}},a.initGenericInterface=function(e,t,i){e.__interface=!0,e.__assembly=t,t.__types[e.__typeName]=e,e.__typeArgumentCount=i,e.__isGenericTypeDefinition=!0},a.initEnum=function(e,t,i,n){e.__enum=!0,e.__assembly=t,t.__types[e.__typeName]=e,a.shallowCopy(i,e.prototype),e.getDefaultValue=e.createInstance=function(){return n?null:0},e.isInstanceOfType=function(e){return typeof e==(n?"string":"number")}},a.getBaseType=function(e){if(e===Object||e.__interface)return null;if(Object.getPrototypeOf)return Object.getPrototypeOf(e.prototype).constructor;var t=e.prototype;if(Object.prototype.hasOwnProperty.call(t,"constructor"))try{var i=t.constructor;return delete t.constructor,t.constructor}finally{t.constructor=i}return t.constructor},a.getTypeFullName=function(e){return e.__typeName||e.name||(e.toString().match(/^\s*function\s*([^\s(]+)/)||[])[1]||"Object"},a.getTypeQName=function(e){return a.getTypeFullName(e)+(e.__assembly?", "+e.__assembly.name:"")},a.getTypeName=function(e){var t=a.getTypeFullName(e),i=t.indexOf("["),n=t.lastIndexOf(".",i>=0?i:t.length);return n>0?t.substr(n+1):t},a.getTypeNamespace=function(e){var t=a.getTypeFullName(e),i=t.indexOf("["),n=t.lastIndexOf(".",i>=0?i:t.length);return n>0?t.substr(0,n):""},a.getTypeAssembly=function(e){return a.contains([Date,Number,Boolean,String,Function,Array],e)?a:e.__assembly||null},a._getAssemblyType=function(e,t){if(e.__types)return e.__types[t]||null;for(var i=t.split("."),n=0;n<i.length;n++)if(e=e[i[n]],!a.isValue(e))return null;return"function"!=typeof e?null:e},a.getAssemblyTypes=function(e){var t=[];if(e.__types)for(var i in e.__types)e.__types.hasOwnProperty(i)&&t.push(e.__types[i]);else{var n=function(e,i){for(var r in e)e.hasOwnProperty(r)&&n(e[r],r);"function"==typeof e&&a.isUpper(i.charCodeAt(0))&&t.push(e)};n(e,"")}return t},a.createAssemblyInstance=function(e,t){var i=a.getType(t,e);return i?a.createInstance(i):null},a.getInterfaces=function(e){return e.__interfaces?e.__interfaces:e===Date||e===Number?[l,o,s]:e===Boolean||e===String?[l,o]:e===Array||a.isTypedArrayType(e)?[h,f,$]:[]},a.isInstanceOfType=function(e,t){return!a.isNullOrUndefined(e)&&("function"==typeof t.isInstanceOfType?t.isInstanceOfType(e):a.isAssignableFrom(t,a.getInstanceType(e)))},a.isAssignableFrom=function(e,t){return e===t||"function"==typeof e.isAssignableFrom&&e.isAssignableFrom(t)||t.prototype instanceof e},a.isClass=function(e){return 1==e.__class||e===Array||e===Function||e===RegExp||e===String||e===Error||e===Object},a.isEnum=function(e){return!!e.__enum},a.isFlags=function(e){return e.__metadata&&e.__metadata.enumFlags||!1},a.isInterface=function(e){return!!e.__interface},a.safeCast=function(e,t){return!0===t?e:!1===t?null:a.isInstanceOfType(e,t)?e:null},a.cast=function(e,t){if(null==e)return e;if(!0===t||!1!==t&&a.isInstanceOfType(e,t))return e;throw new z("Cannot cast object to type "+a.getTypeFullName(t))},a.getInstanceType=function(e){if(!a.isValue(e))throw new j("Cannot get type of null");try{return e.constructor}catch(e){return Object}},a._getType=function(t,i,n){var r,s=!n,o=(n=n||/[[,\]]/g).lastIndex,l=n.exec(t),u=[];if(l)switch(r=t.substring(o,l.index),l[0]){case"[":if("["!=t[l.index+1])return null;for(;;){if(n.exec(t),!(c=a._getType(t,e,n)))return null;if(u.push(c),"]"===(l=n.exec(t))[0])break;if(","!==l[0])return null}if((l=n.exec(t))&&","===l[0]&&(n.exec(t),!(i=a.__assemblies[(n.lastIndex>0?t.substring(l.index+1,n.lastIndex-1):t.substring(l.index+1)).trim()])))return null;break;case"]":break;case",":if(n.exec(t),!(i=a.__assemblies[(n.lastIndex>0?t.substring(l.index+1,n.lastIndex-1):t.substring(l.index+1)).trim()]))return null}else r=t.substring(o);if(s&&n.lastIndex)return null;var c=a._getAssemblyType(i,r.trim());return u.length?a.makeGenericType(c,u):c},a.getType=function(t,i){return t?a._getType(t,i||e):null},a.getDefaultValue=function(e){return"function"==typeof e.getDefaultValue?e.getDefaultValue():e!==Boolean&&(e===Date?new Date(0):e===Number?0:null)},a.createInstance=function(e){return"function"==typeof e.createInstance?e.createInstance():e!==Boolean&&(e===Date?new Date(0):e===Number?0:e===String?"":new e)};var s=function(){};s.__typeName="ss.IFormattable",a.IFormattable=s,a.initInterface(s,a,{format:null});var o=function(){};o.__typeName="ss.IComparable",a.IComparable=o,a.initInterface(o,a,{compareTo:null});var l=function(){};l.__typeName="ss.IEquatable",a.IEquatable=l,a.initInterface(l,a,{equalsT:null}),a.isNullOrEmptyString=function(e){return!e||!e.length},String.prototype.trim||(String.prototype.trim=function(){return a.trimStartString(a.trimEndString(this))}),a.trimEndString=function(e,t){return e.replace(t?new RegExp("["+String.fromCharCode.apply(null,t)+"]+$"):/\s*$/,"")},a.trimStartString=function(e,t){return e.replace(t?new RegExp("^["+String.fromCharCode.apply(null,t)+"]+"):/^\s*/,"")},a.trimString=function(e,t){return a.trimStartString(a.trimEndString(e,t),t)},a.arrayClone=function(e){return 1===e.length?[e[0]]:Array.apply(null,e)},Array.prototype.map||(Array.prototype.map=function(e,t){for(var i=this.length,n=new Array(i),r=0;r<i;r++)r in this&&(n[r]=e.call(t,this[r],r,this));return n}),Array.prototype.some||(Array.prototype.some=function(e,t){for(var i=this.length,n=0;n<i;n++)if(n in this&&e.call(t,this[n],n,this))return!0;return!1}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var i,n;if(null==this)throw new TypeError(" this is null or not defined");var r=Object(this),a=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(i=t),n=0;n<a;){var s;n in r&&(s=r[n],e.call(i,s,n,r)),n++}}),Array.prototype.filter||(Array.prototype.filter=function(e){if(null==this)throw new TypeError;var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n=[],r=arguments.length>=2?arguments[1]:void 0,a=0;a<i;a++)if(a in t){var s=t[a];e.call(r,s,a,t)&&n.push(s)}return n}),a._delegateContains=function(e,t,i){for(var n=0;n<e.length;n+=2)if(e[n]===t&&e[n+1]===i)return!0;return!1},a._mkdel=function(e){var t=function(){if(2==e.length)return e[1].apply(e[0],arguments);for(var t=a.arrayClone(e),i=0;i<t.length;i+=2)a._delegateContains(e,t[i],t[i+1])&&t[i+1].apply(t[i],arguments);return null};return t._targets=e,t},a.mkdel=function(e,t){return e?a._mkdel([e,t]):t},a.delegateCombine=function(e,t){if(!e)return t._targets?t:a.mkdel(null,t);if(!t)return e._targets?e:a.mkdel(null,e);var i=e._targets?e._targets:[null,e],n=t._targets?t._targets:[null,t];return a._mkdel(i.concat(n))},a.delegateRemove=function(e,t){if(!e||e===t)return null;if(!t)return e;var i,n=e._targets,r=null;t._targets?(r=t._targets[0],i=t._targets[1]):i=t;for(var s=0;s<n.length;s+=2)if(n[s]===r&&n[s+1]===i){if(2==n.length)return null;var o=a.arrayClone(n);return o.splice(s,2),a._mkdel(o)}return e},a.delegateEquals=function(e,t){if(e===t)return!0;if(!e._targets&&!t._targets)return!1;var i=e._targets||[null,e],n=t._targets||[null,t];if(i.length!=n.length)return!1;for(var r=0;r<i.length;r++)if(i[r]!==n[r])return!1;return!0};var u=function(){};u.__typeName="ss.Enum",a.Enum=u,a.initClass(u,a,{}),u.getValues=function(e){var t=[],i=e.prototype;for(var n in i)i.hasOwnProperty(n)&&t.push(i[n]);return t};var c=function(){};c.__typeName="ss.IEnumerator",a.IEnumerator=c,a.initInterface(c,a,{current:null,moveNext:null,reset:null},[S]);var h=function(){};h.__typeName="ss.IEnumerable",a.IEnumerable=h,a.initInterface(h,a,{getEnumerator:null}),a.getEnumerator=function(e){return e.getEnumerator?e.getEnumerator():new y(e)};var f=function(){};f.__typeName="ss.ICollection",a.ICollection=f,a.initInterface(f,a,{get_count:null,add:null,clear:null,contains:null,remove:null}),a.count=function(e){return e.get_count?e.get_count():e.length},a.add=function(e,t){if(e.add)e.add(t);else{if(!a.isArray(e))throw new I;e.push(t)}},a.clear=function(e){if(e.clear)e.clear();else{if(!a.isArray(e))throw new I;e.length=0}},a.remove=function(e,t){if(e.remove)return e.remove(t);if(a.isArray(e)){var i=a.indexOf(e,t);return i>=0&&(e.splice(i,1),!0)}throw new I},a.contains=function(e,t){return e.contains?e.contains(t):a.indexOf(e,t)>=0};var m=function(){};m.__typeName="ss.IEqualityComparer",a.IEqualityComparer=m,a.initInterface(m,a,{areEqual:null,getObjectHashCode:null});var d=function(){};d.__typeName="ss.IComparer",a.IComparer=d,a.initInterface(d,a,{compare:null}),a.unbox=function(e){if(!a.isValue(e))throw new F("Nullable object must have a value.");return e};var p=function(e){var t=function(){};return t.isInstanceOfType=function(t){return a.isInstanceOfType(t,e)},a.registerGenericClassInstance(t,p,[e],{},(function(){return null}),(function(){return[]})),t};p.__typeName="ss.Nullable$1",a.Nullable$1=p,a.initGenericClass(p,a,1),p.eq=function(e,t){return a.isValue(e)?e===t:!a.isValue(t)},p.ne=function(e,t){return a.isValue(e)?e!==t:a.isValue(t)},p.le=function(e,t){return a.isValue(e)&&a.isValue(t)&&e<=t},p.ge=function(e,t){return a.isValue(e)&&a.isValue(t)&&e>=t},p.lt=function(e,t){return a.isValue(e)&&a.isValue(t)&&e<t},p.gt=function(e,t){return a.isValue(e)&&a.isValue(t)&&e>t},p.sub=function(e,t){return a.isValue(e)&&a.isValue(t)?e-t:null},p.add=function(e,t){return a.isValue(e)&&a.isValue(t)?e+t:null},p.mod=function(e,t){return a.isValue(e)&&a.isValue(t)?e%t:null},p.div=function(e,t){return a.isValue(e)&&a.isValue(t)?e/t:null},p.mul=function(e,t){return a.isValue(e)&&a.isValue(t)?e*t:null},p.band=function(e,t){return a.isValue(e)&&a.isValue(t)?e&t:null},p.bor=function(e,t){return a.isValue(e)&&a.isValue(t)?e|t:null},p.xor=function(e,t){return a.isValue(e)&&a.isValue(t)?e^t:null},p.shl=function(e,t){return a.isValue(e)&&a.isValue(t)?e<<t:null},p.srs=function(e,t){return a.isValue(e)&&a.isValue(t)?e>>t:null},p.sru=function(e,t){return a.isValue(e)&&a.isValue(t)?e>>>t:null},p.and=function(e,t){return!0===e&&!0===t||!1!==e&&!1!==t&&null},p.or=function(e,t){return!0===e||!0===t||(!1!==e||!1!==t)&&null},p.not=function(e){return a.isValue(e)?!e:null},p.neg=function(e){return a.isValue(e)?-e:null},p.pos=function(e){return a.isValue(e)?+e:null},p.cpl=function(e){return a.isValue(e)?~e:null},p.lift=function(){for(var e=0;e<arguments.length;e++)if(!a.isValue(arguments[e]))return null;return arguments[0].apply(null,Array.prototype.slice.call(arguments,1))};var $=function(){};$.__typeName="ss.IList",a.IList=$,a.initInterface($,a,{get_item:null,set_item:null,indexOf:null,insert:null,removeAt:null},[f,h]),a.getItem=function(e,t){return e.get_item?e.get_item(t):e[t]},a.setItem=function(e,t,i){e.set_item?e.set_item(t,i):e[t]=i},a.indexOf=function(e,t){if(t&&"function"==typeof t.equals||"function"!=typeof e.indexOf){if(a.isArrayOrTypedArray(e)){for(var i=0;i<e.length;i++)if(a.staticEquals(e[i],t))return i;return-1}return e.indexOf(t)}return e.indexOf(t)},a.insert=function(e,t,i){if(e.insert)e.insert(t,i);else{if(!a.isArray(e))throw new I;e.splice(t,0,i)}},a.removeAt=function(e,t){if(e.removeAt)e.removeAt(t);else{if(!a.isArray(e))throw new I;e.splice(t,1)}};var _=function(){};_.__typeName="ss.IDictionary",a.IDictionary=_,a.initInterface(_,a,{get_item:null,set_item:null,get_keys:null,get_values:null,containsKey:null,add:null,remove:null,tryGetValue:null},[h]);var g=function(){};g.__typeName="ss.Int32",a.Int32=g,a.initClass(g,a,{},Object,[l,o,s]),g.__class=!1,g.isInstanceOfType=function(e){return"number"==typeof e&&isFinite(e)&&Math.round(e,0)==e},g.getDefaultValue=g.createInstance=function(){return 0},g.div=function(e,t){if(!a.isValue(e)||!a.isValue(t))return null;if(0===t)throw new P;return g.trunc(e/t)},g.trunc=function(e){return a.isValue(e)?e>0?Math.floor(e):Math.ceil(e):null},g.tryParse=function(e,t,i,n){if(t.$=0,!/^[+-]?[0-9]+$/.test(e))return 0;var r=parseInt(e,10);return!(r<i||r>n)&&(t.$=r,!0)};var v=function(){};v.__typeName="ss.JsDate",a.JsDate=v,a.initClass(v,a,{},Object,[l,o]),v.createInstance=function(){return new Date},v.isInstanceOfType=function(e){return e instanceof Date};var y=function(e){this._array=e,this._index=-1};y.__typeName="ss.ArrayEnumerator",a.ArrayEnumerator=y,a.initClass(y,a,{moveNext:function(){return this._index++,this._index<this._array.length},reset:function(){this._index=-1},current:function(){if(this._index<0||this._index>=this._array.length)throw"Invalid operation";return this._array[this._index]},dispose:function(){}},null,[c,S]);var w=function(e){this._keys=Object.keys(e),this._index=-1,this._object=e};w.__typeName="ss.ObjectEnumerator",a.ObjectEnumerator=w,a.initClass(w,a,{moveNext:function(){return this._index++,this._index<this._keys.length},reset:function(){this._index=-1},current:function(){if(this._index<0||this._index>=this._keys.length)throw new F("Invalid operation");var e=this._keys[this._index];return{key:e,value:this._object[e]}},dispose:function(){}},null,[c,S]);var b=function(){};b.__typeName="ss.EqualityComparer",a.EqualityComparer=b,a.initClass(b,a,{areEqual:function(e,t){return a.staticEquals(e,t)},getObjectHashCode:function(e){return a.isValue(e)?a.getHashCode(e):0}},null,[m]),b.def=new b;var E=function(e){this.f=e};E.__typeName="ss.Comparer",a.Comparer=E,a.initClass(E,a,{compare:function(e,t){return this.f(e,t)}},null,[d]),E.def=new E((function(e,t){return a.isValue(e)?a.isValue(t)?a.compare(e,t):1:a.isValue(t)?-1:0}));var S=function(){};S.__typeName="ss.IDisposable",a.IDisposable=S,a.initInterface(S,a,{dispose:null});var N=function(e){this._parts=a.isValue(e)&&""!=e?[e]:[],this.length=a.isValue(e)?e.length:0};N.__typeName="ss.StringBuilder",a.StringBuilder=N,a.initClass(N,a,{append:function(e){if(a.isValue(e)){var t=e.toString();a.add(this._parts,t),this.length+=t.length}return this},appendChar:function(e){return this.append(String.fromCharCode(e))},appendLine:function(e){return this.append(e),this.append("\r\n"),this},appendLineChar:function(e){return this.appendLine(String.fromCharCode(e))},clear:function(){this._parts=[],this.length=0},toString:function(){return this._parts.join("")}});var C=function(){};C.__typeName="ss.EventArgs",a.EventArgs=C,a.initClass(C,a,{}),C.Empty=new C;var T=function(e,t){this._message=e||"An error occurred.",this._innerException=t||null,this._error=new Error};T.__typeName="ss.Exception",a.Exception=T,a.initClass(T,a,{get_message:function(){return this._message},get_innerException:function(){return this._innerException},get_stack:function(){return this._error.stack},toString:function(){var e=this._message,t=this;return a.isNullOrEmptyString(e)&&(e=a.isValue(a.getInstanceType(t))&&a.isValue(a.getTypeFullName(a.getInstanceType(t)))?a.getTypeFullName(a.getInstanceType(t)):"[object Exception]"),e}}),T.wrap=function(e){return a.isInstanceOfType(e,T)?e:e instanceof TypeError?new j(e.message,new k(e)):e instanceof RangeError?new R(null,e.message,new k(e)):e instanceof Error?new k(e):new T(e.toString())};var A=function(e,t){T.call(this,e||"The method or operation is not implemented.",t)};A.__typeName="ss.NotImplementedException",a.NotImplementedException=A,a.initClass(A,a,{},T);var I=function(e,t){T.call(this,e||"Specified method is not supported.",t)};I.__typeName="ss.NotSupportedException",a.NotSupportedException=I,a.initClass(I,a,{},T);var O=function(e,t){this.innerExceptions=a.isValue(t)?a.arrayFromEnumerable(t):[],T.call(this,e||"One or more errors occurred.",this.innerExceptions.length?this.innerExceptions[0]:null)};O.__typeName="ss.AggregateException",a.AggregateException=O,a.initClass(O,a,{flatten:function(){for(var e=[],t=0;t<this.innerExceptions.length;t++){var i=this.innerExceptions[t];a.isInstanceOfType(i,O)?e.push.apply(e,i.flatten().innerExceptions):e.push(i)}return new O(this._message,e)}},T);var V=function(e,t,i){T.call(this,t||(e.length&&e[0]?e[0].toString():"An error occurred"),i),this.arguments=a.arrayClone(e)};V.__typeName="ss.PromiseException",a.PromiseException=V,a.initClass(V,a,{get_arguments:function(){return this._arguments}},T);var k=function(e,t,i){T.call(this,t||e.message,i),this.error=e};k.__typeName="ss.JsErrorException",a.JsErrorException=k,a.initClass(k,a,{get_stack:function(){return this.error.stack}},T);var x=function(e,t,i){T.call(this,e||"Value does not fall within the expected range.",i),this.paramName=t||null};x.__typeName="ss.ArgumentException",a.ArgumentException=x,a.initClass(x,a,{},T);var D=function(e,t,i){t||(t="Value cannot be null.",e&&(t+="\nParameter name: "+e)),x.call(this,t,e,i)};D.__typeName="ss.ArgumentNullException",a.ArgumentNullException=D,a.initClass(D,a,{},x);var R=function(e,t,i,n){t||(t="Value is out of range.",e&&(t+="\nParameter name: "+e)),x.call(this,t,e,i),this.actualValue=n||null};R.__typeName="ss.ArgumentOutOfRangeException",a.ArgumentOutOfRangeException=R,a.initClass(R,a,{},x);var U=function(e,t){T.call(this,e||"Invalid format.",t)};U.__typeName="ss.FormatException",a.FormatException=U,a.initClass(U,a,{},T);var P=function(e,t){T.call(this,e||"Division by 0.",t)};P.__typeName="ss.DivideByZeroException",a.DivideByZeroException=P,a.initClass(P,a,{},T);var z=function(e,t){T.call(this,e||"The cast is not valid.",t)};z.__typeName="ss.InvalidCastException",a.InvalidCastException=z,a.initClass(z,a,{},T);var F=function(e,t){T.call(this,e||"Operation is not valid due to the current state of the object.",t)};F.__typeName="ss.InvalidOperationException",a.InvalidOperationException=F,a.initClass(F,a,{},T);var j=function(e,t){T.call(this,e||"Object is null.",t)};j.__typeName="ss.NullReferenceException",a.NullReferenceException=j,a.initClass(j,a,{},T);var M=function(e,t){T.call(this,e||"Key not found.",t)};M.__typeName="ss.KeyNotFoundException",a.KeyNotFoundException=M,a.initClass(M,a,{},T);var H=function(e,t){T.call(this,e||"Ambiguous match.",t)};H.__typeName="ss.AmbiguousMatchException",a.AmbiguousMatchException=H,a.initClass(H,a,{},T);var L=function(e,t){this._getEnumerator=e,this._this=t};L.__typeName="ss.IteratorBlockEnumerable",a.IteratorBlockEnumerable=L,a.initClass(L,a,{getEnumerator:function(){return this._getEnumerator.call(this._this)}},null,[h]);var W=function(e,t,i,n){this._moveNext=e,this._getCurrent=t,this._dispose=i,this._this=n};W.__typeName="ss.IteratorBlockEnumerator",a.IteratorBlockEnumerator=W,a.initClass(W,a,{moveNext:function(){try{return this._moveNext.call(this._this)}catch(e){throw this._dispose&&this._dispose.call(this._this),e}},current:function(){return this._getCurrent.call(this._this)},reset:function(){throw new I("Reset is not supported.")},dispose:function(){this._dispose&&this._dispose.call(this._this)}},null,[c,S]);var G=function(e){this._valueFactory=e,this.isValueCreated=!1};G.__typeName="ss.Lazy",a.Lazy=G,a.initClass(G,a,{value:function(){return this.isValueCreated||(this._value=this._valueFactory(),delete this._valueFactory,this.isValueCreated=!0),this._value}}),void 0===e.HTMLElement&&(e.HTMLElement=Element),void 0===e.MessageEvent&&(e.MessageEvent=Event),Date.now=Date.now||function(){return+new Date},e.ss=a}(e);var t=e.ss;e.HTMLElement,e.MessageEvent,
/*! BEGIN CoreSlim */
function(){var i={};e.tab=e.tab||{},t.initAssembly(i,"tabcoreslim");var n=function(){};n.__typeName="tab.CookieHelper",n.getCookie=function(){return document.cookie},n.setCookie=function(e){document.cookie=e},e.tab.CookieHelper=n;var r=function(){};r.__typeName="tab.EscapingUtil",r.escapeHtml=function(e){var i=t.coalesce(e,"");return i=(i=(i=(i=(i=(i=i.replace(new RegExp("&","g"),"&amp;")).replace(new RegExp("<","g"),"&lt;")).replace(new RegExp(">","g"),"&gt;")).replace(new RegExp('"',"g"),"&quot;")).replace(new RegExp("'","g"),"&#39;")).replace(new RegExp("/","g"),"&#47;")},e.tab.EscapingUtil=r;var a=function(){};a.__typeName="tab.ScriptEx",e.tab.ScriptEx=a;var s=function(e){this.$0=null,this.$0=e};s.__typeName="tab.WindowHelper",s.get_windowSelf=function(){return window.self},s.get_windowParent=function(){return window.parent},s.get_selection=function(){return"function"==typeof window.getSelection?window.getSelection():"function"==typeof document.getSelection?document.getSelection():null},s.close=function(e){e.close()},s.getOpener=function(e){return e.opener},s.getLocation=function(e){return e.location},s.getPathAndSearch=function(e){return e.location.pathname+e.location.search},s.setLocationHref=function(e,t){e.location.href=t},s.locationReplace=function(e,t){e.location.replace(t)},s.open=function(e,t,i){return window.open(e,t,i)},s.reload=function(e,t){e.location.reload(t)},s.requestAnimationFrame=function(e){return s.$c(e)},s.cancelAnimationFrame=function(e){t.isValue(e)&&s.$b(e)},s.setTimeout=function(e,t){return window.setTimeout(e,t)},s.setInterval=function(e,t){return window.setInterval(e,t)},s.addListener=function(e,t,i){"addEventListener"in e?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)},s.removeListener=function(e,t,i){"removeEventListener"in e?e.removeEventListener(t,i,!1):e.detachEvent("on"+t,i)},s.$0=function(){var e=0;s.$c=function(t){var i=(new Date).getTime(),n=Math.max(0,16-(i-e));return e=i+n,window.setTimeout(t,n)}},s.clearSelection=function(){var e=s.get_selection();t.isValue(e)&&("function"==typeof e.removeAllRanges?e.removeAllRanges():"function"==typeof e.empty&&e.empty())},e.tab.WindowHelper=s,t.initClass(n,i,{}),t.initClass(r,i,{}),t.initClass(a,i,{}),t.initClass(s,i,{get_pageXOffset:function(){return s.$7(this.$0)},get_pageYOffset:function(){return s.$8(this.$0)},get_clientWidth:function(){return s.$2(this.$0)},get_clientHeight:function(){return s.$1(this.$0)},get_innerWidth:function(){return s.$4(this.$0)},get_outerWidth:function(){return s.$6(this.$0)},get_innerHeight:function(){return s.$3(this.$0)},get_outerHeight:function(){return s.$5(this.$0)},get_screenLeft:function(){return s.$9(this.$0)},get_screenTop:function(){return s.$a(this.$0)},isQuirksMode:function(){return"BackCompat"===document.compatMode}}),function(){s.$4=null,s.$3=null,s.$2=null,s.$1=null,s.$7=null,s.$8=null,s.$9=null,s.$a=null,s.$6=null,s.$5=null,s.$c=null,s.$b=null,s.$4="innerWidth"in window?function(e){return e.innerWidth}:function(e){return e.document.documentElement.offsetWidth},s.$6="outerWidth"in window?function(e){return e.outerWidth}:s.$4,s.$3="innerHeight"in window?function(e){return e.innerHeight}:function(e){return e.document.documentElement.offsetHeight},s.$5="outerHeight"in window?function(e){return e.outerHeight}:s.$3,s.$2="clientWidth"in window?function(e){return e.clientWidth}:function(e){return e.document.documentElement.clientWidth},s.$1="clientHeight"in window?function(e){return e.clientHeight}:function(e){return e.document.documentElement.clientHeight},s.$7=t.isValue(window.self.pageXOffset)?function(e){return e.pageXOffset}:function(e){return e.document.documentElement.scrollLeft},s.$8=t.isValue(window.self.pageYOffset)?function(e){return e.pageYOffset}:function(e){return e.document.documentElement.scrollTop},s.$9="screenLeft"in window?function(e){return e.screenLeft}:function(e){return e.screenX},s.$a="screenTop"in window?function(e){return e.screenTop}:function(e){return e.screenY};var e="requestAnimationFrame",i="cancelAnimationFrame",n=["ms","moz","webkit","o"],r=null,a=null;e in window&&(r=e),i in window&&(a=i);for(var o=0;o<n.length&&(t.isNullOrUndefined(r)||t.isNullOrUndefined(a));++o){var l=n[o],u=l+"RequestAnimationFrame";t.isNullOrUndefined(r)&&u in window&&(r=u),t.isNullOrUndefined(a)&&((u=l+"CancelAnimationFrame")in window&&(a=u),(u=l+"CancelRequestAnimationFrame")in window&&(a=u))}t.isValue(r)?s.$c=function(e){return window[r](e)}:s.$0(),s.$b=t.isValue(a)?function(e){window[a](e)}:function(e){window.clearTimeout(e)}}()}();var n=e.tab;e.tableauSoftware=e.tableauSoftware||{},
/*! BEGIN ApiShared */
function(){var r={};e.tab=e.tab||{},e.tableauSoftware=e.tableauSoftware||{},t.initAssembly(r,"vqlapishared");var a=function(){this.$2=null,this.$1$1=null};a.__typeName="tab.$0";var s=function(){};s.__typeName="tab.$1",s.$0=function(e){var n;if(e instanceof i.Promise)n=e;else if(t.isValue(e)&&"function"==typeof e.valueOf&&(e=e.valueOf()),s.$1(e)){var r=new d;e.then(t.mkdel(r,r.resolve),t.mkdel(r,r.reject)),n=r.get_promise()}else n=s.$4(e);return n},s.$2=function(e){return s.$0(e).then((function(e){return s.$3(e)}),null)},s.$4=function(e){return new _((function(i,n){try{return s.$0(t.isValue(i)?i(e):e)}catch(e){var r=t.Exception.wrap(e);return s.$3(r)}}))},s.$3=function(e){return new _((function(i,n){try{return t.isValue(n)?s.$0(n(e)):s.$3(e)}catch(e){var r=t.Exception.wrap(e);return s.$3(r)}}))},s.$1=function(e){return t.isValue(e)&&"function"==typeof e.then};var o=function(e,t,i,n){this.$1$1=null,this.$1$2=null,this.$1$3=null,this.$1$4=null,this.set_name(e),this.set_commandId(t),this.set_hostId(i),this.set_parameters(n)};o.__typeName="tab._ApiCommand",o.generateNextCommandId=function(){var e="cmd"+o.$0;return o.$0++,e},o.parse=function(e){var t,i,n=e.indexOf(String.fromCharCode(44));if(n<0)return new o(t=e,null,null,null);t=e.substr(0,n);var r,a=e.substr(n+1);if((n=a.indexOf(String.fromCharCode(44)))<0)return new o(t,i=a,null,null);i=a.substr(0,n);var s=a.substr(n+1);if((n=s.indexOf(String.fromCharCode(44)))<0)return new o(t,i,r=s,null);r=s.substr(0,n);var l=s.substr(n+1);return new o(t,i,r,l)},e.tab._ApiCommand=o;var l=function(){};l.__typeName="tab._ApiObjectRegistry",l.registerApiMessageRouter=function(e){return l.$3(Object).call(null,e)},l.getApiMessageRouter=function(){return l.$2(Object).call(null)},l.disposeApiMessageRouter=function(){l.$0(Object).call(null)},l.$3=function(e){return function(i){var n=window._ApiObjectRegistryGlobalState.creationRegistry,r=t.getTypeFullName(e),a=n[r];return n[r]=i,a}},l.$1=function(e){return function(){var i=t.getTypeFullName(e),n=window._ApiObjectRegistryGlobalState.creationRegistry[i];if(t.isNullOrUndefined(n))throw v.createInternalError("No creation function has been registered for interface type '"+i+"'.");return n()}},l.$2=function(e){return function(){var i=window._ApiObjectRegistryGlobalState.singletonInstanceRegistry,n=t.getTypeFullName(e),r=i[n];return t.isNullOrUndefined(r)&&(r=l.$1(e).call(null),i[n]=r),r}},l.$0=function(e){return function(){var i=window._ApiObjectRegistryGlobalState.singletonInstanceRegistry,n=t.getTypeFullName(e),r=i[n];return delete i[n],r}},e.tab._ApiObjectRegistry=l;var u=function(e,t,i){this.$1=null,this.$2=null,this.$0=null,this.$1=e,this.$2=t,this.$0=i};u.__typeName="tab._ApiServerNotification",u.deserialize=function(e){var t=JSON.parse(e),i=t["api.workbookName"],n=t["api.worksheetName"],r=t["api.commandData"];return new u(i,n,r)},e.tab._ApiServerNotification=u;var c=function(e){this.$1=null,this.$0=null;var t=JSON.parse(e);this.$1=t["api.commandResult"],this.$0=t["api.commandData"]};c.__typeName="tab._ApiServerResultParser",e.tab._ApiServerResultParser=c;var h=function(){this.$4=[],this.$3={}};h.__typeName="tab._CollectionImpl",e.tab._CollectionImpl=h;var f=function(e,i,n,r){this.$1=null,this.$0=null,this.$3=!1,this.$2=0,$.verifyString(e,"Column Field Name"),this.$1=e,this.$0=i,this.$3=t.coalesce(n,!1),this.$2=r};f.__typeName="tab._ColumnImpl",e.tab._ColumnImpl=f;var m=function(e,t,i,n){this.$2=null,this.$3=null,this.$4=0,this.$0=null,this.$1=!1,this.$3=e,this.$4=i,this.$0=n,this.$1=t,this.$2=t?"Summary Data Table":"Underlying Data Table"};m.__typeName="tab._DataTableImpl",e.tab._DataTableImpl=m;var d=function(){this.$3=null,this.$5=null,this.$2=[],this.$4=null,this.$3=new _(t.mkdel(this,this.then)),this.$5=t.mkdel(this,this.$0),this.$4=t.mkdel(this,this.$1)};d.__typeName="tab._DeferredImpl",e.tab._DeferredImpl=d;var p=function(){};p.__typeName="tab._jQueryShim",p.isFunction=function(e){return"function"===p.type(e)},p.isArray=function(e){return t.isValue(Array.isArray)?Array.isArray(e):"array"===p.type(e)},p.type=function(e){return t.isNullOrUndefined(e)?String(e):p.$8[p.$d.call(e)]||"object"},p.trim=function(e){return t.isValue(p.$e)?t.isNullOrUndefined(e)?"":p.$e.call(e):t.isNullOrUndefined(e)?"":e.toString().replace(p.$f,"").replace(p.$g,"")},p.parseJSON=function(e){if("string"!=typeof e||t.isNullOrUndefined(e))return null;if(e=p.trim(e),t.isValue(JSON)&&t.isValue(JSON.parse))return JSON.parse(e);if(p.$a.test(e.replace(p.$b,"@").replace(p.$c,"]").replace(p.$9,"")))return new Function("return "+e)();throw new t.Exception("Invalid JSON: "+e)},e.tab._jQueryShim=p;var $=function(){};$.__typeName="tab._Param",$.verifyString=function(e,i){if(t.isNullOrUndefined(e)||0===e.length)throw v.createInternalStringArgumentException(i)},$.verifyValue=function(e,i){if(t.isNullOrUndefined(e))throw v.createInternalNullArgumentException(i)},e.tab._Param=$;var _=function(e){this.then=null,this.then=e};_.__typeName="tab._PromiseImpl",e.tab._PromiseImpl=_;var g=function(e,t,i,n){this.left=0,this.top=0,this.width=0,this.height=0,this.left=e,this.top=t,this.width=i,this.height=n};g.__typeName="tab._Rect",e.tab._Rect=g;var v=function(){};v.__typeName="tab._TableauException",v.create=function(e,i){var n=new t.Exception(i);return n.tableauSoftwareErrorCode=e,n},v.createInternalError=function(e){return t.isValue(e)?v.create("internalError","Internal error. Please contact Tableau support with the following information: "+e):v.create("internalError","Internal error. Please contact Tableau support")},v.createInternalNullArgumentException=function(e){return v.createInternalError("Null/undefined argument '"+e+"'.")},v.createInternalStringArgumentException=function(e){return v.createInternalError("Invalid string argument '"+e+"'.")},v.createServerError=function(e){return v.create("serverError",e)},v.createNotActiveSheet=function(){return v.create("notActiveSheet","Operation not allowed on non-active sheet")},v.createInvalidCustomViewName=function(e){return v.create("invalidCustomViewName","Invalid custom view name: "+e)},v.createInvalidParameter=function(e){return v.create("invalidParameter","Invalid parameter: "+e)},v.createInvalidFilterFieldNameOrValue=function(e){return v.create("invalidFilterFieldNameOrValue","Invalid filter field name or value: "+e)},v.createInvalidDateParameter=function(e){return v.create("invalidDateParameter","Invalid date parameter: "+e)},v.createNullOrEmptyParameter=function(e){return v.create("nullOrEmptyParameter","Parameter cannot be null or empty: "+e)},v.createMissingMaxSize=function(){return v.create("missingMaxSize","Missing maxSize for SheetSizeBehavior.ATMOST")},v.createMissingMinSize=function(){return v.create("missingMinSize","Missing minSize for SheetSizeBehavior.ATLEAST")},v.createMissingMinMaxSize=function(){return v.create("missingMinMaxSize","Missing minSize or maxSize for SheetSizeBehavior.RANGE")},v.createInvalidRangeSize=function(){return v.create("invalidSize","Missing minSize or maxSize for SheetSizeBehavior.RANGE")},v.createInvalidSizeValue=function(){return v.create("invalidSize","Size value cannot be less than zero")},v.createInvalidSheetSizeParam=function(){return v.create("invalidSize","Invalid sheet size parameter")},v.createSizeConflictForExactly=function(){return v.create("invalidSize","Conflicting size values for SheetSizeBehavior.EXACTLY")},v.createInvalidSizeBehaviorOnWorksheet=function(){return v.create("invalidSizeBehaviorOnWorksheet","Only SheetSizeBehavior.AUTOMATIC is allowed on Worksheets")},v.createNoUrlForHiddenWorksheet=function(){return v.create("noUrlForHiddenWorksheet","Hidden worksheets do not have a URL.")},v.createInvalidAggregationFieldName=function(e){return v.create("invalidAggregationFieldName","Invalid aggregation type for field '"+e+"'")},v.createInvalidToolbarButtonName=function(e){return v.create("invalidToolbarButtonName","Invalid toolbar button name: '"+e+"'")},v.createIndexOutOfRange=function(e){return v.create("indexOutOfRange","Index '"+e+"' is out of range.")},v.createUnsupportedEventName=function(e){return v.create("unsupportedEventName","Unsupported event '"+e+"'.")},v.createBrowserNotCapable=function(){return v.create("browserNotCapable","This browser is incapable of supporting the Tableau JavaScript API.")},e.tab._TableauException=v;var y=function(){};y.__typeName="tab._Utility",y.isNullOrEmpty=function(e){return t.isNullOrUndefined(e)||(e.length||0)<=0},y.isString=function(e){return"string"==typeof e},y.isNumber=function(e){return"number"==typeof e},y.isDate=function(e){return!("object"!=typeof e||!t.isInstanceOfType(e,t.JsDate))||"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},y.isDateValid=function(e){return!isNaN(e.getTime())},y.indexOf=function(e,i,n){if(t.isValue(Array.prototype.indexOf))return e.indexOf(i,n);n=n||0;var r=e.length;if(r>0)for(var a=n;a<r;a++)if(t.referenceEquals(e[a],i))return a;return-1},y.contains=function(e,t,i){return y.indexOf(e,t,i)>=0},y.getTopmostWindow=function(){for(var e=window.self;t.isValue(e.parent)&&!t.referenceEquals(e.parent,e);)e=e.parent;return e},y.toInt=function(e){if(y.isNumber(e))return t.Int32.trunc(e);var i=parseInt(e.toString(),10);return isNaN(i)?0:i},y.hasClass=function(e,i){var n=new RegExp("[\\n\\t\\r]","g");return t.isValue(e)&&(" "+e.className+" ").replace(n," ").indexOf(" "+i+" ")>-1},y.findParentWithClassName=function(e,i,n){var r=t.isValue(e)?e.parentNode:null;for(n=n||document.body;t.isValue(r);){if(y.hasClass(r,i))return r;r=t.referenceEquals(r,n)?null:r.parentNode}return r},y.hasJsonParse=function(){return t.isValue(JSON)&&t.isValue(JSON.parse)},y.hasWindowPostMessage=function(){return t.isValue(window.postMessage)},y.isPostMessageSynchronous=function(){if(y.isIE()){var e=new RegExp("(msie) ([\\w.]+)").exec(window.navigator.userAgent.toLowerCase())[2]||"0";return parseInt(e,10)<=8}return!1},y.hasDocumentAttachEvent=function(){return t.isValue(document.attachEvent)},y.hasWindowAddEventListener=function(){return t.isValue(window.addEventListener)},y.isElementOfTag=function(e,i){return t.isValue(e)&&1===e.nodeType&&t.referenceEquals(e.tagName.toLowerCase(),i.toLowerCase())},y.elementToString=function(e){var i=new t.StringBuilder;if(i.append(e.tagName.toLowerCase()),y.isNullOrEmpty(e.id)||i.append("#").append(e.id),!y.isNullOrEmpty(e.className)){var n=e.className.split(" ");i.append(".").append(n.join("."))}return i.toString()},y.tableauGCS=function(e){return"function"==typeof window.getComputedStyle?window.getComputedStyle(e):e.currentStyle},y.isIE=function(){return window.navigator.userAgent.indexOf("MSIE")>-1&&t.isNullOrUndefined(window.opera)},y.isSafari=function(){var e=window.navigator.userAgent,t=e.indexOf("Chrome")>=0;return e.indexOf("Safari")>=0&&!t},y.mobileDetect=function(){var e=window.navigator.userAgent;return-1!==e.indexOf("iPad")||(-1!==e.indexOf("Android")||-1!==e.indexOf("AppleWebKit")&&-1!==e.indexOf("Mobile"))},y.visibleContentRectInDocumentCoordinates=function(e){for(var i=y.contentRectInDocumentCoordinates(e),r=e.parentElement;t.isValue(r)&&t.isValue(r.parentElement);r=r.parentElement){var a=y.$0(r).overflow;"auto"!==a&&"scroll"!==a&&"hidden"!==a||(i=i.intersect(y.contentRectInDocumentCoordinates(r)))}var s=y.contentRectInDocumentCoordinates(document.documentElement),o=new n.WindowHelper(window.self);return o.isQuirksMode()&&(s.height=document.body.clientHeight-s.left,s.width=document.body.clientWidth-s.top),s.left+=o.get_pageXOffset(),s.top+=o.get_pageYOffset(),i.intersect(s)},y.contentRectInDocumentCoordinates=function(e){var t=y.getBoundingClientRect(e),i=y.$0(e),r=y.toInt(i.paddingLeft),a=y.toInt(i.paddingTop),s=y.toInt(i.borderLeftWidth),o=y.toInt(i.borderTopWidth),l=y.computeContentSize(e),u=new n.WindowHelper(window.self),c=t.left+r+s+u.get_pageXOffset(),h=t.top+a+o+u.get_pageYOffset();return new g(c,h,l.width,l.height)},y.getBoundingClientRect=function(e){var i=e.getBoundingClientRect(),n=t.Int32.trunc(i.top),r=t.Int32.trunc(i.left),a=t.Int32.trunc(i.right),s=t.Int32.trunc(i.bottom);return new g(r,n,a-r,s-n)},y.convertRawValue=function(e,i){if(t.isNullOrUndefined(e))return null;switch(i){case"bool":return e;case"date":case"number":return t.isNullOrUndefined(e)?Number.NaN:e;default:case"string":return e}},y.getDataValue=function(e){return t.isNullOrUndefined(e)?G.$ctor(null,null,null):G.$ctor(y.convertRawValue(e.value,e.type),e.formattedValue,e.aliasedValue)},y.serializeDateForServer=function(e){var i="";t.isValue(e)&&y.isDate(e)&&(i=e.getUTCFullYear()+"-"+(e.getUTCMonth()+1)+"-"+e.getUTCDate()+" "+e.getUTCHours()+":"+e.getUTCMinutes()+":"+e.getUTCSeconds());return i},y.computeContentSize=function(e){var t=y.$0(e),i=parseFloat(t.paddingLeft),n=parseFloat(t.paddingTop),r=parseFloat(t.paddingRight),a=parseFloat(t.paddingBottom),s=e.clientWidth-Math.round(i+r),o=e.clientHeight-Math.round(n+a);return ne.$ctor(s,o)},y.$0=function(e){return"function"==typeof window.getComputedStyle?t.isValue(e.ownerDocument.defaultView.opener)?e.ownerDocument.defaultView.getComputedStyle(e):window.getComputedStyle(e):t.isValue(e.currentStyle)?e.currentStyle:e.style},y.roundVizSizeInPixels=function(e){if(t.isNullOrUndefined(e)||-1===e.indexOf("px"))return e;var i=parseFloat(e.split("px")[0]);return Math.round(i)+"px"},y.noResultPromiseHelper=function(e,i,r){var a=new n._Deferred,s=new(t.makeGenericType(H,[Object]))(e,1,(function(e){a.resolve()}),(function(e,t){a.reject(v.createServerError(t))}));return r.sendCommand(Object).call(r,i,s),a.get_promise()},y.clone=function(e){return function(e){return JSON.parse(JSON.stringify(e))}},e.tab._Utility=y;var w=function(){};w.__typeName="tab.ApiDashboardObjectType",e.tab.ApiDashboardObjectType=w;var b=function(){};b.__typeName="tab.ApiDateRangeType",e.tab.ApiDateRangeType=b;var E=function(){};E.__typeName="tab.ApiDeviceType",e.tab.ApiDeviceType=E;var S=function(){};S.__typeName="tab.ApiEnumConverter",S.convertDashboardObjectType=function(e){switch(e){case"blank":return"blank";case"image":return"image";case"legend":return"legend";case"pageFilter":return"pageFilter";case"parameterControl":return"parameterControl";case"quickFilter":return"quickFilter";case"text":return"text";case"title":return"title";case"webPage":return"webPage";case"worksheet":return"worksheet";default:throw v.createInternalError("Unknown ApiCrossDomainDashboardObjectType: "+e)}},S.convertDateRange=function(e){switch(e){case"curr":return"curr";case"last":return"last";case"lastn":return"lastn";case"next":return"next";case"nextn":return"nextn";case"todate":return"todate";default:throw v.createInternalError("Unknown ApiCrossDomainDateRangeType: "+e)}},S.convertFieldAggregation=function(e){switch(e){case"ATTR":return"ATTR";case"AVG":return"AVG";case"COUNT":return"COUNT";case"COUNTD":return"COUNTD";case"DAY":return"DAY";case"END":return"END";case"HOUR":return"HOUR";case"INOUT":return"INOUT";case"KURTOSIS":return"KURTOSIS";case"MAX":return"MAX";case"MDY":return"MDY";case"MEDIAN":return"MEDIAN";case"MIN":return"MIN";case"MINUTE":return"MINUTE";case"MONTH":return"MONTH";case"MONTHYEAR":return"MONTHYEAR";case"NONE":return"NONE";case"PERCENTILE":return"PERCENTILE";case"QUART1":return"QUART1";case"QUART3":return"QUART3";case"QTR":return"QTR";case"SECOND":return"SECOND";case"SKEWNESS":return"SKEWNESS";case"STDEV":return"STDEV";case"STDEVP":return"STDEVP";case"SUM":return"SUM";case"SUM_XSQR":return"SUM_XSQR";case"TRUNC_DAY":return"TRUNC_DAY";case"TRUNC_HOUR":return"TRUNC_HOUR";case"TRUNC_MINUTE":return"TRUNC_MINUTE";case"TRUNC_MONTH":return"TRUNC_MONTH";case"TRUNC_QTR":return"TRUNC_QTR";case"TRUNC_SECOND":return"TRUNC_SECOND";case"TRUNC_WEEK":return"TRUNC_WEEK";case"TRUNC_YEAR":return"TRUNC_YEAR";case"USER":return"USER";case"VAR":return"VAR";case"VARP":return"VARP";case"WEEK":return"WEEK";case"WEEKDAY":return"WEEKDAY";case"YEAR":return"YEAR";default:throw v.createInternalError("Unknown ApiCrossDomainFieldAggregationType: "+e)}},S.convertFieldRole=function(e){switch(e){case"dimension":return"dimension";case"measure":return"measure";case"unknown":return"unknown";default:throw v.createInternalError("Unknown ApiCrossDomainFieldRoleType: "+e)}},S.convertFilterType=function(e){switch(e){case"categorical":return"categorical";case"hierarchical":return"hierarchical";case"quantitative":return"quantitative";case"relativedate":return"relativedate";default:throw v.createInternalError("Unknown ApiCrossDomainFilterType: "+e)}},S.convertParameterAllowableValuesType=function(e){switch(e){case"all":return"all";case"list":return"list";case"range":return"range";default:throw v.createInternalError("Unknown ApiCrossDomainParameterAllowableValuesType: "+e)}},S.convertParameterDataType=function(e){switch(e){case"boolean":return"boolean";case"date":return"date";case"datetime":return"datetime";case"float":return"float";case"integer":return"integer";case"string":return"string";default:throw v.createInternalError("Unknown ApiCrossDomainParameterDataType: "+e)}},S.convertPeriodType=function(e){switch(e){case"year":return"year";case"quarter":return"quarter";case"month":return"month";case"week":return"week";case"day":return"day";case"hour":return"hour";case"minute":return"minute";case"second":return"second";default:throw v.createInternalError("Unknown ApiCrossDomainPeriodType: "+e)}},S.convertSheetType=function(e){switch(e){case"worksheet":return"worksheet";case"dashboard":return"dashboard";case"story":return"story";default:throw v.createInternalError("Unknown ApiCrossDomainSheetType: "+e)}},S.convertDataType=function(e){switch(e){case"boolean":return"boolean";case"date":return"date";case"datetime":return"datetime";case"float":return"float";case"integer":return"integer";case"string":return"string";default:throw v.createInternalError("Unknown ApiCrossDomainParameterDataType: "+e)}},e.tab.ApiEnumConverter=S;var N=function(){};N.__typeName="tab.ApiErrorCode",e.tab.ApiErrorCode=N;var C=function(){};C.__typeName="tab.ApiFieldAggregationType",e.tab.ApiFieldAggregationType=C;var T=function(){};T.__typeName="tab.ApiFieldRoleType",e.tab.ApiFieldRoleType=T;var A=function(){};A.__typeName="tab.ApiFilterType",e.tab.ApiFilterType=A;var I=function(){};I.__typeName="tab.ApiFilterUpdateType",e.tab.ApiFilterUpdateType=I;var O=function(){};O.__typeName="tab.ApiMessageHandler",e.tab.ApiMessageHandler=O;var V=function(e,t){this.$1=null,this.$0=null,$.verifyValue(e,"router"),this.$1=e,this.$0=t};V.__typeName="tab.ApiMessagingOptions",e.tab.ApiMessagingOptions=V;var k=function(){};k.__typeName="tab.ApiNullOption",e.tab.ApiNullOption=k;var x=function(){};x.__typeName="tab.ApiParameterAllowableValuesType",e.tab.ApiParameterAllowableValuesType=x;var D=function(){};D.__typeName="tab.ApiParameterDataType",e.tab.ApiParameterDataType=D;var R=function(){};R.__typeName="tab.ApiPeriodType",e.tab.ApiPeriodType=R;var U=function(){};U.__typeName="tab.ApiSelectionUpdateType",e.tab.ApiSelectionUpdateType=U;var P=function(){};P.__typeName="tab.ApiSheetSizeBehavior",e.tab.ApiSheetSizeBehavior=P;var z=function(){};z.__typeName="tab.ApiSheetType",e.tab.ApiSheetType=z;var F=function(){};F.__typeName="tab.ApiTableauEventName",e.tab.ApiTableauEventName=F;var j=function(){};j.__typeName="tab.ApiToolbarButtonName",e.tab.ApiToolbarButtonName=j;var M=function(){};M.__typeName="tab.ApiToolbarPosition",e.tab.ApiToolbarPosition=M;var H=function(e){var i=function(e,t,i,n){this.$0=null,this.$3=0,this.$2=null,this.$1=null,this.$0=e,this.$2=i,this.$3=t,this.$1=n};return t.registerGenericClassInstance(i,H,[e],{get_commandName:function(){return this.$0},get_successCallback:function(){return this.$2},get_successCallbackTiming:function(){return this.$3},get_errorCallback:function(){return this.$1}},(function(){return null}),(function(){return[]})),i};H.__typeName="tab.CommandReturnHandler$1",t.initGenericClass(H,r,1),e.tab.CommandReturnHandler$1=H;var L=function(e){if(this.$8=0,this.$6={},this.$4={},this.$5={},this.$7=null,this.$7=e,y.hasWindowAddEventListener())window.addEventListener("message",t.mkdel(this,this.$1),!1);else if(y.hasDocumentAttachEvent()){var i=t.mkdel(this,this.$1);document.attachEvent("onmessage",i),window.attachEvent("onmessage",i)}else window.onmessage=t.mkdel(this,this.$1);this.$8=0};L.__typeName="tab.CrossDomainMessager",e.tab.CrossDomainMessager=L;var W=function(){};W.__typeName="tab.DataType",e.tab.DataType=W;var G=function(){};G.__typeName="tab.DataValue",G.$ctor=function(e,t,i){var n=new Object;return n.value=null,n.formattedValue=null,n.value=e,y.isNullOrEmpty(i)?n.formattedValue=t:n.formattedValue=i,n},G.isInstanceOfType=function(){return!0},e.tab.DataValue=G;var q=function(){};q.__typeName="tab.FilterCommandsBuilder",e.tab.FilterCommandsBuilder=q;var B=function(){};B.__typeName="tab.GetDataCommandsBuilder",e.tab.GetDataCommandsBuilder=B;var K=function(){this.$2$1=null,O.call(this)};K.__typeName="tab.HostedApiMessageHandler",e.tab.HostedApiMessageHandler=K;var J=function(){this.$0=null,this.$0=new L(null)};J.__typeName="tab.HostedApiMessageRouter",e.tab.HostedApiMessageRouter=J;var Q=function(e){if(this.$2=null,this.$3=new n._Collection,this.$4=0,p.isArray(e))for(var i=e,r=0;r<i.length;r++){var a=i[r];if(!t.isValue(a.fieldName))throw v.createInvalidParameter("pair.fieldName");if(!t.isValue(a.value))throw v.createInvalidParameter("pair.value");var s=new ue(a.fieldName,a.value);this.$3._add(s.fieldName,s)}else this.$4=e};Q.__typeName="tab.MarkImpl",Q.processActiveMarks=function(e){var i=new n._Collection;if(t.isNullOrUndefined(e)||y.isNullOrEmpty(e.marks))return i;for(var r=0;r<e.marks.length;r++){var a=e.marks[r],s=a.tupleId,o=new se(s);i._add(s.toString(),o);for(var l=0;l<a.pairs.length;l++){var u=a.pairs[l],c=y.convertRawValue(u.value,u.valueDataType),h=new ue(u.fieldName,c);h.formattedValue=u.formattedValue,o.impl.get_pairs()._has(h.fieldName)||o.impl.$0(h)}}return i},e.tab.MarkImpl=Q;var Y=function(e,t){this.$0=null,this.$1$1=null,this.set_name(e),this.$0=t};Y.__typeName="tab.NonApiCommand",Y.parse=function(e){var t=e.split(String.fromCharCode(44)),i=t[0],n=t.slice(1);return new Y(i,n)},e.tab.NonApiCommand=Y;var X=function(){};X.__typeName="tab.Point",X.$ctor=function(e,t){var i=new Object;return i.x=0,i.y=0,i.x=e,i.y=t,i},X.isInstanceOfType=function(){return!0},e.tab.Point=X;var Z=function(){};Z.__typeName="tab.PublicEnums",Z.tryNormalizeEnum=function(e){return function(i,n){if(t.isValue(i))for(var r=i.toString().toUpperCase(),a=t.Enum.getValues(e),s=0;s<a.length;s++){var o=a[s],l=o.toUpperCase();if(t.referenceEquals(r,l))return n.$=o,!0}return n.$=t.getDefaultValue(e),!1}},Z.normalizeEnum=function(e){return function(t,i){var n={};if(!Z.tryNormalizeEnum(e).call(null,t,n))throw v.createInvalidParameter(i);return n.$}},Z.isValidEnum=function(e){return function(t){return Z.tryNormalizeEnum(e).call(null,t,{})}},e.tab.PublicEnums=Z;var ee=function(){};ee.__typeName="tab.SharedUtils",e.tab.SharedUtils=ee;var te=function(){};te.__typeName="tab.SheetSize",te.$ctor=function(e,i,n){var r=new Object;return r.behavior=null,r.minSize=null,r.maxSize=null,r.behavior=t.coalesce(e,"automatic"),t.isValue(i)?r.minSize=i:delete r.minSize,t.isValue(n)?r.maxSize=n:delete r.maxSize,r},te.isInstanceOfType=function(){return!0},e.tab.SheetSize=te;var ie=function(){};ie.__typeName="tab.SheetSizeFactory",ie.createAutomatic=function(){return te.$ctor("automatic",null,null)},ie.fromSizeConstraints=function(e){var t=e.minHeight,i=e.minWidth,n=e.maxHeight,r=e.maxWidth,a="automatic",s=null,o=null;return 0===t&&0===i?0===n&&0===r||(a="atmost",o=ne.$ctor(r,n)):0===n&&0===r?(a="atleast",s=ne.$ctor(i,t)):n===t&&r===i&&i>0?(a="exactly",s=ne.$ctor(i,t),o=ne.$ctor(i,t)):(a="range",0===i&&0===r&&(r=2147483647),s=ne.$ctor(i,t),o=ne.$ctor(r,n)),te.$ctor(a,s,o)},e.tab.SheetSizeFactory=ie;var ne=function(){};ne.__typeName="tab.Size",ne.$ctor=function(e,t){var i=new Object;return i.width=0,i.height=0,i.width=e,i.height=t,i},ne.isInstanceOfType=function(){return!0},e.tab.Size=ne;var re=function(e){this.$0=null,this.$0=e};re.__typeName="tableauSoftware.Column",e.tableauSoftware.Column=re;var ae=function(e){this.$0=null,this.$0=e};ae.__typeName="tableauSoftware.DataTable",e.tableauSoftware.DataTable=ae;var se=function(e){this.impl=null,this.impl=new Q(e)};se.__typeName="tableauSoftware.Mark",e.tableauSoftware.Mark=se;var oe,le,ue=function(e,i){this.fieldName=null,this.value=null,this.formattedValue=null,this.fieldName=e,this.value=i,this.formattedValue=t.isValue(i)?i.toString():""};ue.__typeName="tableauSoftware.Pair",e.tableauSoftware.Pair=ue,t.initClass(a,r,{add_stateReadyForQuery:function(e){this.$1$1=t.delegateCombine(this.$1$1,e)},remove_stateReadyForQuery:function(e){this.$1$1=t.delegateRemove(this.$1$1,e)},get_iframe:function(){return null},get_hostId:function(){return this.$2},set_hostId:function(e){this.$2=e},$1:function(){return"*"},handleEventNotification:function(e,t){},$0:function(){this.$1$1(null)}}),t.initClass(s,r,{}),t.initClass(o,r,{get_name:function(){return this.$1$1},set_name:function(e){this.$1$1=e},get_hostId:function(){return this.$1$2},set_hostId:function(e){this.$1$2=e},get_commandId:function(){return this.$1$3},set_commandId:function(e){this.$1$3=e},get_parameters:function(){return this.$1$4},set_parameters:function(e){this.$1$4=e},get_isApiCommandName:function(){return 0===this.get_rawName().indexOf("api.",0)},get_rawName:function(){return this.get_name().toString()},serialize:function(){var e=[];return e.push(this.get_name()),e.push(this.get_commandId()),e.push(this.get_hostId()),t.isValue(this.get_parameters())&&e.push(this.get_parameters()),e.join(",")}}),t.initClass(l,r,{}),t.initClass(u,r,{get_workbookName:function(){return this.$1},get_worksheetName:function(){return this.$2},get_data:function(){return this.$0},serialize:function(){var e={};return e["api.workbookName"]=this.$1,e["api.worksheetName"]=this.$2,e["api.commandData"]=this.$0,JSON.stringify(e)}}),t.initClass(c,r,{get_result:function(){return this.$1},get_data:function(){return this.$0}}),t.initClass(h,r,{get__length:function(){return this.$4.length},get__rawArray:function(){return this.$4},get_item:function(e){return this.$4[e]},_get:function(e){var i=this.$0(e);if(t.isValue(this.$3[i]))return this.$3[i]},_has:function(e){return t.isValue(this._get(e))},_add:function(e,t){this.$1(e,t);var i=this.$0(e);this.$4.push(t),this.$3[i]=t},_addToFirst:function(e,t){this.$1(e,t);var i=this.$0(e);this.$4.unshift(t),this.$3[i]=t},_remove:function(e){var i=this.$0(e);if(t.isValue(this.$3[i])){var n=this.$3[i];delete this.$3[i];for(var r=0;r<this.$4.length;r++)if(t.referenceEquals(this.$4[r],n)){this.$4.splice(r,1);break}}},_toApiCollection:function(){var e=this.$4.concat();return e.get=t.mkdel(this,(function(e){return this._get(e)})),e.has=t.mkdel(this,(function(e){return this._has(e)})),e},$2:function(e){if(y.isNullOrEmpty(e))throw new t.Exception("Null key");if(this._has(e))throw new t.Exception("Duplicate key '"+e+"'")},$1:function(e,i){if(this.$2(e),t.isNullOrUndefined(i))throw new t.Exception("Null item")},$0:function(e){return"_"+e}}),t.initClass(f,r,{get_fieldName:function(){return this.$1},get_dataType:function(){return this.$0},get_isReferenced:function(){return this.$3},get_index:function(){return this.$2}}),t.initClass(m,r,{get_name:function(){return this.$2},get_rows:function(){return this.$3},get_columns:function(){return this.$0},get_totalRowCount:function(){return this.$4},get_isSummaryData:function(){return this.$1}}),t.initClass(d,r,{get_promise:function(){return this.$3},all:function(e){var t=new d,i=e.length,n=i,r=[];if(0===i)return t.resolve(r),t.get_promise();for(var a=function(e,i){s.$0(e).then((function(e){return r[i]=e,0===--n&&t.resolve(r),null}),(function(e){return t.reject(e),null}))},o=0;o<i;o++)a(e[o],o);return t.get_promise()},then:function(e,t){return this.$5(e,t)},resolve:function(e){return this.$4(e)},reject:function(e){return this.$4(s.$3(e))},$0:function(e,i){var n=new d;return this.$2.push((function(r){r.then(e,i).then(t.mkdel(n,n.resolve),t.mkdel(n,n.reject))})),n.get_promise()},$1:function(e){var t=s.$0(e);this.$5=t.then,this.$4=s.$0;for(var i=0;i<this.$2.length;i++){(0,this.$2[i])(t)}return this.$2=null,t}}),t.initClass(p,r,{}),t.initClass($,r,{}),t.initClass(_,r,{always:function(e){return this.then(e,e)},otherwise:function(e){return this.then(null,e)}}),t.initClass(g,r,{intersect:function(e){var t=Math.max(this.left,e.left),i=Math.max(this.top,e.top),n=Math.min(this.left+this.width,e.left+e.width),r=Math.min(this.top+this.height,e.top+e.height);return n<=t||r<=i?new g(0,0,0,0):new g(t,i,n-t,r-i)}}),t.initClass(v,r,{}),t.initClass(y,r,{}),t.initEnum(w,r,{blank:"blank",worksheet:"worksheet",quickFilter:"quickFilter",parameterControl:"parameterControl",pageFilter:"pageFilter",legend:"legend",title:"title",text:"text",image:"image",webPage:"webPage",addIn:"addIn"},!0),t.initEnum(b,r,{last:"last",lastn:"lastn",next:"next",nextn:"nextn",curr:"curr",todate:"todate"},!0),t.initEnum(E,r,{default:"default",desktop:"desktop",tablet:"tablet",phone:"phone"},!0),t.initClass(S,r,{}),t.initEnum(N,r,{internalError:"internalError",serverError:"serverError",invalidAggregationFieldName:"invalidAggregationFieldName",invalidToolbarButtonName:"invalidToolbarButtonName",invalidParameter:"invalidParameter",invalidUrl:"invalidUrl",staleDataReference:"staleDataReference",vizAlreadyInManager:"vizAlreadyInManager",noUrlOrParentElementNotFound:"noUrlOrParentElementNotFound",invalidFilterFieldName:"invalidFilterFieldName",invalidFilterFieldValue:"invalidFilterFieldValue",invalidFilterFieldNameOrValue:"invalidFilterFieldNameOrValue",filterCannotBePerformed:"filterCannotBePerformed",notActiveSheet:"notActiveSheet",invalidCustomViewName:"invalidCustomViewName",missingRangeNForRelativeDateFilters:"missingRangeNForRelativeDateFilters",missingMaxSize:"missingMaxSize",missingMinSize:"missingMinSize",missingMinMaxSize:"missingMinMaxSize",invalidSize:"invalidSize",invalidSizeBehaviorOnWorksheet:"invalidSizeBehaviorOnWorksheet",sheetNotInWorkbook:"sheetNotInWorkbook",indexOutOfRange:"indexOutOfRange",downloadWorkbookNotAllowed:"downloadWorkbookNotAllowed",nullOrEmptyParameter:"nullOrEmptyParameter",browserNotCapable:"browserNotCapable",unsupportedEventName:"unsupportedEventName",invalidDateParameter:"invalidDateParameter",invalidSelectionFieldName:"invalidSelectionFieldName",invalidSelectionValue:"invalidSelectionValue",invalidSelectionDate:"invalidSelectionDate",noUrlForHiddenWorksheet:"noUrlForHiddenWorksheet",maxVizResizeAttempts:"maxVizResizeAttempts"},!0),t.initEnum(C,r,{SUM:"SUM",AVG:"AVG",MIN:"MIN",MAX:"MAX",STDEV:"STDEV",STDEVP:"STDEVP",VAR:"VAR",VARP:"VARP",COUNT:"COUNT",COUNTD:"COUNTD",MEDIAN:"MEDIAN",ATTR:"ATTR",NONE:"NONE",PERCENTILE:"PERCENTILE",YEAR:"YEAR",QTR:"QTR",MONTH:"MONTH",DAY:"DAY",HOUR:"HOUR",MINUTE:"MINUTE",SECOND:"SECOND",WEEK:"WEEK",WEEKDAY:"WEEKDAY",MONTHYEAR:"MONTHYEAR",MDY:"MDY",END:"END",TRUNC_YEAR:"TRUNC_YEAR",TRUNC_QTR:"TRUNC_QTR",TRUNC_MONTH:"TRUNC_MONTH",TRUNC_WEEK:"TRUNC_WEEK",TRUNC_DAY:"TRUNC_DAY",TRUNC_HOUR:"TRUNC_HOUR",TRUNC_MINUTE:"TRUNC_MINUTE",TRUNC_SECOND:"TRUNC_SECOND",QUART1:"QUART1",QUART3:"QUART3",SKEWNESS:"SKEWNESS",KURTOSIS:"KURTOSIS",INOUT:"INOUT",SUM_XSQR:"SUM_XSQR",USER:"USER"},!0),t.initEnum(T,r,{dimension:"dimension",measure:"measure",unknown:"unknown"},!0),t.initEnum(A,r,{categorical:"categorical",quantitative:"quantitative",hierarchical:"hierarchical",relativedate:"relativedate"},!0),t.initEnum(I,r,{all:"all",replace:"replace",add:"add",remove:"remove"},!0),t.initClass(O,r,{handleEventNotification:function(e,i){throw new t.NotImplementedException}}),t.initClass(V,r,{get_handler:function(){return this.$0},get_router:function(){return this.$1},sendCommand:function(e){return function(t,i){this.$1.sendCommand(e).call(this.$1,this.$0,t,i)}},dispose:function(){this.$1.unregisterHandler(this.$0)}}),t.initEnum(k,r,{nullValues:"nullValues",nonNullValues:"nonNullValues",allValues:"allValues"},!0),t.initEnum(x,r,{all:"all",list:"list",range:"range"},!0),t.initEnum(D,r,{float:"float",integer:"integer",string:"string",boolean:"boolean",date:"date",datetime:"datetime"},!0),t.initEnum(R,r,{year:"year",quarter:"quarter",month:"month",week:"week",day:"day",hour:"hour",minute:"minute",second:"second"},!0),t.initEnum(U,r,{replace:"replace",add:"add",remove:"remove"},!0),t.initEnum(P,r,{automatic:"automatic",exactly:"exactly",range:"range",atleast:"atleast",atmost:"atmost"},!0),t.initEnum(z,r,{worksheet:"worksheet",dashboard:"dashboard",story:"story"},!0),t.initEnum(F,r,{customviewload:"customviewload",customviewremove:"customviewremove",customviewsave:"customviewsave",customviewsetdefault:"customviewsetdefault",filterchange:"filterchange",firstinteractive:"firstinteractive",firstvizsizeknown:"firstvizsizeknown",marksselection:"marksselection",markshighlight:"markshighlight",parametervaluechange:"parametervaluechange",storypointswitch:"storypointswitch",tabswitch:"tabswitch",toolbarstatechange:"toolbarstatechange",vizresize:"vizresize"},!0),t.initEnum(j,r,{redo:"redo",undo:"undo"},!0),t.initEnum(M,r,{top:"top",bottom:"bottom"},!0),t.initClass(L,r,{registerHandler:function(e){var i="host"+this.$8;if(t.isValue(e.get_hostId())||t.isValue(this.$6[e.get_hostId()]))throw v.createInternalError("Host '"+e.get_hostId()+"' is already registered.");this.$8++,e.set_hostId(i),this.$6[i]=e,e.add_stateReadyForQuery(t.mkdel(this,this.$3))},unregisterHandler:function(e){(t.isValue(e.get_hostId())||t.isValue(this.$6[e.get_hostId()]))&&(delete this.$6[e.get_hostId()],e.remove_stateReadyForQuery(t.mkdel(this,this.$3)))},sendCommand:function(e){return function(e,i,n){var r=e.get_iframe(),a=e.get_hostId();if(y.hasWindowPostMessage()&&!t.isNullOrUndefined(r)&&!t.isNullOrUndefined(r.contentWindow)){var s=o.generateNextCommandId(),l=this.$4[a];t.isNullOrUndefined(l)&&(l={},this.$4[a]=l),l[s]=n;var u=n.get_commandName(),c=null;t.isValue(i)&&(c=JSON.stringify(i));var h=new o(u,s,a,c).serialize();y.isPostMessageSynchronous()?window.setTimeout((function(){r.contentWindow.postMessage(h,"*")}),0):r.contentWindow.postMessage(h,"*")}}},$3:function(e){var i=this.$5[e.get_hostId()];if(!y.isNullOrEmpty(i))for(;i.length>0;){var n=i.pop();t.isValue(n)&&n()}},$1:function(e){var i=e;if(!t.isNullOrUndefined(i.data)){var n=o.parse(i.data.toString()),r=n.get_hostId(),a=this.$6[r];if(!t.isNullOrUndefined(a)&&t.referenceEquals(a.get_hostId(),n.get_hostId())||(a=this.$0(i)),n.get_isApiCommandName())if("xdomainSourceId"===n.get_commandId()){if(a.handleEventNotification(n.get_name(),n.get_parameters()),"api.FirstVizSizeKnownEvent"===n.get_name()){var s=new Y("tableau.bootstrap",[]);i.source.postMessage(s.serialize(),"*")}}else this.$2(n);else if(!t.isNullOrUndefined(this.$7)){var l=Y.parse(i.data.toString());this.$7(l,a)}}},$2:function(e){var i=this.$4[e.get_hostId()],n=t.isValue(i)?i[e.get_commandId()]:null;if(!t.isNullOrUndefined(n)&&(delete i[e.get_commandId()],e.get_name()===n.get_commandName())){var r=new c(e.get_parameters()),a=r.get_data();if("api.success"===r.get_result())switch(n.get_successCallbackTiming()){case 0:t.isValue(n.get_successCallback())&&n.get_successCallback()(a);break;case 1:var s=this.$5[e.get_hostId()];t.isNullOrUndefined(s)&&(s=[],this.$5[e.get_hostId()]=s),s.push((function(){t.isValue(n.get_successCallback())&&n.get_successCallback()(a)}));break;default:throw v.createInternalError("Unknown timing value: "+n.get_successCallbackTiming())}else if(t.isValue(n.get_errorCallback())){var o="api.remotefailed"===r.get_result(),l=t.isValue(a)?a.toString():"";n.get_errorCallback()(o,l)}}},$0:function(e){var i=new t.ObjectEnumerator(this.$6);try{for(;i.moveNext();){var n=i.current();if(this.$6.hasOwnProperty(n.key)&&t.referenceEquals(n.value.get_iframe().contentWindow,e.source))return n.value}}finally{i.dispose()}return new a}}),t.initEnum(W,r,{float:"float",integer:"integer",string:"string",boolean:"boolean",date:"date",datetime:"datetime"},!0),t.initClass(G,r,{},Object),t.initClass(q,r,{buildApplyFiltersCommandParams:function(e,i,n,r){if(y.isNullOrEmpty(e))throw v.createNullOrEmptyParameter("fieldName");n=Z.normalizeEnum(I).call(null,n,"updateType");var a=[];if(p.isArray(i))for(var s=0;s<i.length;s++)a.push(i[s].toString());else t.isValue(i)&&a.push(i.toString());var o={};return o["api.fieldCaption"]=e,o["api.filterUpdateType"]=n,o["api.exclude"]=!(!t.isValue(r)||!r.isExcludeMode),"all"!==n&&(o["api.filterCategoricalValues"]=a),o},buildRangeFilterCommandParams:function(e,i){if(y.isNullOrEmpty(e))throw v.createNullOrEmptyParameter("fieldName");if(t.isNullOrUndefined(i))throw v.createNullOrEmptyParameter("filterOptions");var n={};if(n["api.fieldCaption"]=e,t.isValue(i.min))if(y.isDate(i.min)){var r=i.min;if(!y.isDateValid(r))throw v.createInvalidDateParameter("filterOptions.min");n["api.filterRangeMin"]=y.serializeDateForServer(r)}else n["api.filterRangeMin"]=i.min;if(t.isValue(i.max))if(y.isDate(i.max)){var a=i.max;if(!y.isDateValid(a))throw v.createInvalidDateParameter("filterOptions.max");n["api.filterRangeMax"]=y.serializeDateForServer(a)}else n["api.filterRangeMax"]=i.max;return t.isValue(i.nullOption)&&(n["api.filterRangeNullOption"]=i.nullOption),n},buildRelativeDateFilterCommandParams:function(e,i){if(y.isNullOrEmpty(e))throw v.createInvalidParameter("fieldName");if(t.isNullOrUndefined(i))throw v.createInvalidParameter("filterOptions");var n={};if(n["api.fieldCaption"]=e,t.isValue(i)){if(n["api.filterPeriodType"]=i.periodType,n["api.filterDateRangeType"]=i.rangeType,"lastn"===i.rangeType||"nextn"===i.rangeType){if(t.isNullOrUndefined(i.rangeN))throw v.create("missingRangeNForRelativeDateFilters","Missing rangeN field for a relative date filter of LASTN or NEXTN.");n["api.filterDateRange"]=i.rangeN}t.isValue(i.anchorDate)&&(n["api.filterDateArchorValue"]=y.serializeDateForServer(i.anchorDate))}return n},buildHierarchicalFilterCommandParams:function(e,i,n,r){if(y.isNullOrEmpty(e))throw v.createNullOrEmptyParameter("fieldName");n=Z.normalizeEnum(I).call(null,n,"updateType");var a=null,s=null;if(p.isArray(i)){a=[];for(var o=i,l=0;l<o.length;l++)a.push(o[l].toString())}else if(y.isString(i))(a=[]).push(i.toString());else if(t.isValue(i)&&t.isValue(i.levels)){var u=i.levels;if(s=[],p.isArray(u))for(var c=u,h=0;h<c.length;h++)s.push(c[h].toString());else s.push(u.toString())}else if(t.isValue(i))throw v.createInvalidParameter("values");var f={};return f["api.fieldCaption"]=e,f["api.filterUpdateType"]=n,f["api.exclude"]=!(!t.isValue(r)||!r.isExcludeMode),t.isValue(a)&&(f["api.filterHierarchicalValues"]=JSON.stringify(a)),t.isValue(s)&&(f["api.filterHierarchicalLevels"]=JSON.stringify(s)),f},buildClearFilterCommandsParam:function(e){if(y.isNullOrEmpty(e))throw v.createNullOrEmptyParameter("fieldName");var t={};return t["api.fieldCaption"]=e,t},filterCommandError:function(e){var i=e;if(t.isValue(i)&&t.isValue(i.errorCode)){var n=t.isValue(i.additionalInformation)?i.additionalInformation.toString():"";switch(i.errorCode){case"invalidFilterFieldName":return v.create("invalidFilterFieldName",n);case"invalidFilterFieldValue":return v.create("invalidFilterFieldValue",n);case"invalidAggregationFieldName":return v.createInvalidAggregationFieldName(n);default:return v.createServerError(n)}}return null},normalizeRangeFilterOption:function(e){if(t.isNullOrUndefined(e))throw v.createNullOrEmptyParameter("filterOptions");if(t.isNullOrUndefined(e.min)&&t.isNullOrUndefined(e.max))throw v.create("invalidParameter","At least one of filterOptions.min or filterOptions.max must be specified.");var i=new Object;return t.isValue(e.min)&&(i.min=e.min),t.isValue(e.max)&&(i.max=e.max),t.isValue(e.nullOption)&&(i.nullOption=Z.normalizeEnum(k).call(null,e.nullOption,"filterOptions.nullOption")),i},normalizeRelativeDateFilterOptions:function(e){if(t.isNullOrUndefined(e))throw v.createNullOrEmptyParameter("filterOptions");var i=new Object;if(i.rangeType=Z.normalizeEnum(b).call(null,e.rangeType,"filterOptions.rangeType"),i.periodType=Z.normalizeEnum(R).call(null,e.periodType,"filterOptions.periodType"),"lastn"===i.rangeType||"nextn"===i.rangeType){if(t.isNullOrUndefined(e.rangeN))throw v.create("missingRangeNForRelativeDateFilters","Missing rangeN field for a relative date filter of LASTN or NEXTN.");i.rangeN=y.toInt(e.rangeN)}if(t.isValue(e.anchorDate)){if(!y.isDate(e.anchorDate)||!y.isDateValid(e.anchorDate))throw v.createInvalidDateParameter("filterOptions.anchorDate");i.anchorDate=e.anchorDate}return i},createFilterCommandReturnHandler:function(e,i,n){return new(t.makeGenericType(H,[Object]))(e,1,t.mkdel(this,(function(e){var r=this.filterCommandError(e);t.isNullOrUndefined(r)?n.resolve(i):n.reject(r)})),(function(e,t){if(e)n.reject(v.createInvalidFilterFieldNameOrValue(i));else{var r=v.create("filterCannotBePerformed",t);n.reject(r)}}))}}),t.initClass(B,r,{getSummaryDataCommandParams:function(e){var i={};return e=e||new Object,i["api.ignoreAliases"]=t.coalesce(e.ignoreAliases,!1),i["api.ignoreSelection"]=t.coalesce(e.ignoreSelection,!1),i["api.maxRows"]=t.coalesce(e.maxRows,0),i},getUnderlyingDataCommandParams:function(e){var i={};return e=e||new Object,i["api.ignoreAliases"]=t.coalesce(e.ignoreAliases,!1),i["api.ignoreSelection"]=t.coalesce(e.ignoreSelection,!1),i["api.includeAllColumns"]=t.coalesce(e.includeAllColumns,!1),i["api.maxRows"]=t.coalesce(e.maxRows,0),i},getSummaryDataResponseHandler:function(e){return new(t.makeGenericType(H,[Object]))("api.GetSummaryTableCommand",0,t.mkdel(this,(function(t){var i=t,n=this.processGetDataPresModel(i);e.resolve(n)})),(function(t,i){e.reject(v.createServerError(i))}))},getUnderlyingDataResponseHandler:function(e){return new(t.makeGenericType(H,[Object]))("api.GetUnderlyingTableCommand",0,t.mkdel(this,(function(t){var i=t,n=this.processGetDataPresModel(i);e.resolve(n)})),(function(t,i){e.reject(v.createServerError(i))}))},processGetDataPresModel:function(e){var t=this.$1(e.dataTable),i=this.$0(e.headers),n=new m(t,e.isSummary,t.length,i);return new ae(n)},$1:function(e){for(var t=[],i=0;i<e.length;i++){for(var n=e[i],r=[],a=0;a<n.length;a++){var s=n[a];r.push(y.getDataValue(s))}t.push(r)}return t},$0:function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i],r=new f(n.fieldName,S.convertDataType(n.dataType),n.isReferenced,n.index);t.push(new re(r))}return t}}),t.initClass(K,r,{add_stateReadyForQuery:function(e){this.$2$1=t.delegateCombine(this.$2$1,e)},remove_stateReadyForQuery:function(e){this.$2$1=t.delegateRemove(this.$2$1,e)},get_hostId:function(){return null},set_hostId:function(e){},get_iframe:function(){return null}},O),t.initClass(J,r,{registerHandler:function(e){this.$0.registerHandler(e)},unregisterHandler:function(e){this.$0.unregisterHandler(e)},sendCommand:function(e){return function(t,i,n){this.$0.sendCommand(e).call(this.$0,t,i,n)}}}),t.initClass(Q,r,{get_pairs:function(){return this.$3},get_tupleId:function(){return this.$4},$1:function(){return t.isNullOrUndefined(this.$2)&&(this.$2=this.$3._toApiCollection()),this.$2},$0:function(e){this.$3._add(e.fieldName,e)}}),t.initClass(Y,r,{get_name:function(){return this.$1$1},set_name:function(e){this.$1$1=e},get_parameters:function(){return this.$0},serialize:function(){var e=[];return e.push(this.get_name().toString()),(e=e.concat.apply(e,this.$0)).join(",")}}),t.initClass(X,r,{},Object),t.initClass(Z,r,{}),t.initClass(ee,r,{addVisualIdForWorksheet:function(e,i,n){e["api.worksheetName"]=i,t.isValue(n)&&(e["api.dashboardName"]=n)}}),t.initClass(te,r,{},Object),t.initClass(ie,r,{}),t.initClass(ne,r,{},Object),t.initClass(re,r,{getFieldName:function(){return this.$0.get_fieldName()},getDataType:function(){return this.$0.get_dataType()},getIsReferenced:function(){return this.$0.get_isReferenced()},getIndex:function(){return this.$0.get_index()}}),t.initClass(ae,r,{getName:function(){return this.$0.get_name()},getData:function(){return this.$0.get_rows()},getColumns:function(){return this.$0.get_columns()},getTotalRowCount:function(){return this.$0.get_totalRowCount()},getIsSummaryData:function(){return this.$0.get_isSummaryData()}}),t.initClass(se,r,{getPairs:function(){return this.impl.$1()}}),t.initClass(ue,r,{}),o.crossDomainEventNotificationId="xdomainSourceId",o.$0=0,oe=window._ApiObjectRegistryGlobalState,t.isNullOrUndefined(oe)&&(oe=new Object),window._ApiObjectRegistryGlobalState=oe,window._ApiObjectRegistryGlobalState.creationRegistry=window._ApiObjectRegistryGlobalState.creationRegistry||{},window._ApiObjectRegistryGlobalState.singletonInstanceRegistry=window._ApiObjectRegistryGlobalState.singletonInstanceRegistry||{},p.$0="array",p.$1="boolean",p.$2="date",p.$3="function",p.$4="number",p.$5="object",p.$6="regexp",p.$7="string",p.$8=t.mkdict(["[object Boolean]","boolean","[object Number]","number","[object String]","string","[object Function]","function","[object Array]","array","[object Date]","date","[object RegExp]","regexp","[object Object]","object"]),p.$e=String.prototype.trim,p.$d=Object.prototype.toString,p.$f=new RegExp("^[\\s\\xA0]+"),p.$g=new RegExp("[\\s\\xA0]+$"),p.$a=new RegExp("^[\\],:{}\\s]*$"),p.$b=new RegExp('\\\\(?:["\\\\\\/bfnrt]|u[0-9a-fA-F]{4})',"g"),p.$c=new RegExp('"[^"\\\\\\n\\r]*"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?',"g"),p.$9=new RegExp("(?:^|:|,)(?:\\s*\\[)+","g"),(le=e.tableauSoftware).DeviceType={DEFAULT:"default",DESKTOP:"desktop",TABLET:"tablet",PHONE:"phone"},le.DashboardObjectType={BLANK:"blank",WORKSHEET:"worksheet",QUICK_FILTER:"quickFilter",PARAMETER_CONTROL:"parameterControl",PAGE_FILTER:"pageFilter",LEGEND:"legend",TITLE:"title",TEXT:"text",IMAGE:"image",WEB_PAGE:"webPage",ADDIN:"addIn"},le.DataType={FLOAT:"float",INTEGER:"integer",STRING:"string",BOOLEAN:"boolean",DATE:"date",DATETIME:"datetime"},le.DateRangeType={LAST:"last",LASTN:"lastn",NEXT:"next",NEXTN:"nextn",CURR:"curr",TODATE:"todate"},le.ErrorCode={INTERNAL_ERROR:"internalError",SERVER_ERROR:"serverError",INVALID_AGGREGATION_FIELD_NAME:"invalidAggregationFieldName",INVALID_TOOLBAR_BUTTON_NAME:"invalidToolbarButtonName",INVALID_PARAMETER:"invalidParameter",INVALID_URL:"invalidUrl",STALE_DATA_REFERENCE:"staleDataReference",VIZ_ALREADY_IN_MANAGER:"vizAlreadyInManager",NO_URL_OR_PARENT_ELEMENT_NOT_FOUND:"noUrlOrParentElementNotFound",INVALID_FILTER_FIELDNAME:"invalidFilterFieldName",INVALID_FILTER_FIELDVALUE:"invalidFilterFieldValue",INVALID_FILTER_FIELDNAME_OR_VALUE:"invalidFilterFieldNameOrValue",FILTER_CANNOT_BE_PERFORMED:"filterCannotBePerformed",NOT_ACTIVE_SHEET:"notActiveSheet",INVALID_CUSTOM_VIEW_NAME:"invalidCustomViewName",MISSING_RANGEN_FOR_RELATIVE_DATE_FILTERS:"missingRangeNForRelativeDateFilters",MISSING_MAX_SIZE:"missingMaxSize",MISSING_MIN_SIZE:"missingMinSize",MISSING_MINMAX_SIZE:"missingMinMaxSize",INVALID_SIZE:"invalidSize",INVALID_SIZE_BEHAVIOR_ON_WORKSHEET:"invalidSizeBehaviorOnWorksheet",SHEET_NOT_IN_WORKBOOK:"sheetNotInWorkbook",INDEX_OUT_OF_RANGE:"indexOutOfRange",DOWNLOAD_WORKBOOK_NOT_ALLOWED:"downloadWorkbookNotAllowed",NULL_OR_EMPTY_PARAMETER:"nullOrEmptyParameter",BROWSER_NOT_CAPABLE:"browserNotCapable",UNSUPPORTED_EVENT_NAME:"unsupportedEventName",INVALID_DATE_PARAMETER:"invalidDateParameter",INVALID_SELECTION_FIELDNAME:"invalidSelectionFieldName",INVALID_SELECTION_VALUE:"invalidSelectionValue",INVALID_SELECTION_DATE:"invalidSelectionDate",NO_URL_FOR_HIDDEN_WORKSHEET:"noUrlForHiddenWorksheet",MAX_VIZ_RESIZE_ATTEMPTS:"maxVizResizeAttempts"},le.FieldAggregationType={SUM:"SUM",AVG:"AVG",MIN:"MIN",MAX:"MAX",STDEV:"STDEV",STDEVP:"STDEVP",VAR:"VAR",VARP:"VARP",COUNT:"COUNT",COUNTD:"COUNTD",MEDIAN:"MEDIAN",ATTR:"ATTR",NONE:"NONE",PERCENTILE:"PERCENTILE",YEAR:"YEAR",QTR:"QTR",MONTH:"MONTH",DAY:"DAY",HOUR:"HOUR",MINUTE:"MINUTE",SECOND:"SECOND",WEEK:"WEEK",WEEKDAY:"WEEKDAY",MONTHYEAR:"MONTHYEAR",MDY:"MDY",END:"END",TRUNC_YEAR:"TRUNC_YEAR",TRUNC_QTR:"TRUNC_QTR",TRUNC_MONTH:"TRUNC_MONTH",TRUNC_WEEK:"TRUNC_WEEK",TRUNC_DAY:"TRUNC_DAY",TRUNC_HOUR:"TRUNC_HOUR",TRUNC_MINUTE:"TRUNC_MINUTE",TRUNC_SECOND:"TRUNC_SECOND",QUART1:"QUART1",QUART3:"QUART3",SKEWNESS:"SKEWNESS",KURTOSIS:"KURTOSIS",INOUT:"INOUT",SUM_XSQR:"SUM_XSQR",USER:"USER"},le.FieldRoleType={DIMENSION:"dimension",MEASURE:"measure",UNKNOWN:"unknown"},le.FilterUpdateType={ALL:"all",REPLACE:"replace",ADD:"add",REMOVE:"remove"},le.FilterType={CATEGORICAL:"categorical",QUANTITATIVE:"quantitative",HIERARCHICAL:"hierarchical",RELATIVEDATE:"relativedate"},le.NullOption={NULL_VALUES:"nullValues",NON_NULL_VALUES:"nonNullValues",ALL_VALUES:"allValues"},le.ParameterAllowableValuesType={ALL:"all",LIST:"list",RANGE:"range"},le.ParameterDataType={FLOAT:"float",INTEGER:"integer",STRING:"string",BOOLEAN:"boolean",DATE:"date",DATETIME:"datetime"},le.PeriodType={YEAR:"year",QUARTER:"quarter",MONTH:"month",WEEK:"week",DAY:"day",HOUR:"hour",MINUTE:"minute",SECOND:"second"},le.SelectionUpdateType={REPLACE:"replace",ADD:"add",REMOVE:"remove"},le.SheetSizeBehavior={AUTOMATIC:"automatic",EXACTLY:"exactly",RANGE:"range",ATLEAST:"atleast",ATMOST:"atmost"},le.SheetType={WORKSHEET:"worksheet",DASHBOARD:"dashboard",STORY:"story"},le.TableauEventName={CUSTOM_VIEW_LOAD:"customviewload",CUSTOM_VIEW_REMOVE:"customviewremove",CUSTOM_VIEW_SAVE:"customviewsave",CUSTOM_VIEW_SET_DEFAULT:"customviewsetdefault",FILTER_CHANGE:"filterchange",FIRST_INTERACTIVE:"firstinteractive",FIRST_VIZ_SIZE_KNOWN:"firstvizsizeknown",MARKS_SELECTION:"marksselection",MARKS_HIGHLIGHT:"markshighlight",PARAMETER_VALUE_CHANGE:"parametervaluechange",STORY_POINT_SWITCH:"storypointswitch",TAB_SWITCH:"tabswitch",TOOLBAR_STATE_CHANGE:"toolbarstatechange",VIZ_RESIZE:"vizresize"},le.ToolbarPosition={TOP:"top",BOTTOM:"bottom"},le.ToolbarButtonName={REDO:"redo",UNDO:"undo"}}(),
/*! API */
function(){var i={};e.tab=e.tab||{},e.tableauSoftware=e.tableauSoftware||{},t.initAssembly(i,"Tableau.JavaScript.Vql.Api");var r=function(e,t){this.$2=null,C.call(this,e,null),this.$2=t};r.__typeName="tab.$0";var a=function(e,t,i,n){this.$3=null,this.$4=null,C.call(this,e,t),this.$3=i,this.$4=n};a.__typeName="tab.$1";var s=function(e,t){C.call(this,e,t)};s.__typeName="tab.$2";var o=function(){};o.__typeName="tab.$3",o.isInstanceOfType=function(){return!0};var l=function(e){if(this.$i=null,this.$h=null,this.$c=null,this.$d=null,this.$b=null,this.$a=null,this.$g=null,this.$f=null,this.$j=null,this.$e=null,this.$h=e.name,this.$c=n._Utility.getDataValue(e.currentValue),this.$d=n.ApiEnumConverter.convertParameterDataType(e.dataType),this.$b=n.ApiEnumConverter.convertParameterAllowableValuesType(e.allowableValuesType),t.isValue(e.allowableValues)&&"list"===this.$b){this.$a=[];for(var i=0;i<e.allowableValues.length;i++){var r=e.allowableValues[i];this.$a.push(n._Utility.getDataValue(r))}}"range"===this.$b&&(this.$g=n._Utility.getDataValue(e.minValue),this.$f=n._Utility.getDataValue(e.maxValue),this.$j=e.stepSize,("date"===this.$d||"datetime"===this.$d)&&t.isValue(this.$j)&&t.isValue(e.dateStepPeriod)&&(this.$e=n.ApiEnumConverter.convertPeriodType(e.dateStepPeriod)))};l.__typeName="tab.$4";var u=function(e,t){C.call(this,e,t)};u.__typeName="tab.$5";var c=function(e,t){this.$2=null,C.call(this,e,null),this.$2=t};c.__typeName="tab.$6";var h=function(){};h.__typeName="tab._ApiBootstrap",h.initialize=function(){n._ApiObjectRegistry.registerApiMessageRouter((function(){return new V}))},e.tab._ApiBootstrap=h;var f=function(e,t,i){this.$c=null,this.$j=null,this.$l=null,this.$g=null,this.$h=null,this.$i=null,this.$k=null,this.$e=!1,this.$d=!1,this.$f=!1,this.$l=e,this.$h=t,this.$g=i,this.$e=!1,this.$d=!1,this.$f=!1};f.__typeName="tab._CustomViewImpl",f._getAsync=function(e){var t=new n._Deferred;return t.resolve(e.get__customViewImpl().$5()),t.get_promise()},f._createNew=function(e,i,n,r){var a=new f(e,n.name,i);return a.$e=n.isPublic,a.$k=n.url,a.$i=n.owner.friendlyName,a.$d=t.isValue(r)&&t.unbox(r)===n.id,a.$j=n,a},f._saveNewAsync=function(e,i,r){var a=new n._Deferred,s={};s["api.customViewName"]=r;var o=f.$0("api.SaveNewCustomViewCommand",a,(function(n){f._processCustomViewUpdate(e,i,n,!0);var r=null;t.isValue(e.$p())&&(r=e.$p().get_item(0)),a.resolve(r)}));return i.sendCommand(Object).call(i,s,o),a.get_promise()},f._showCustomViewAsync=function(e,i,r){var a=new n._Deferred,s={};t.isValue(r)&&(s["api.customViewParam"]=r);var o=f.$0("api.ShowCustomViewCommand",a,(function(t){var i=e.get_activeCustomView();a.resolve(i)}));return i.sendCommand(Object).call(i,s,o),a.get_promise()},f._makeCurrentCustomViewDefaultAsync=function(e,t){var i=new n._Deferred,r=f.$0("api.MakeCurrentCustomViewDefaultCommand",i,(function(t){var n=e.get_activeCustomView();i.resolve(n)}));return t.sendCommand(Object).call(t,{},r),i.get_promise()},f._getCustomViewsAsync=function(e,i){var r=new n._Deferred,a=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.FetchCustomViewsCommand",0,(function(t){f._processCustomViews(e,i,t),r.resolve(e.$i()._toApiCollection())}),(function(e,t){r.reject(n._TableauException.create("serverError",t))}));return i.sendCommand(Object).call(i,null,a),r.get_promise()},f._processCustomViews=function(e,t,i){f._processCustomViewUpdate(e,t,i,!1)},f._processCustomViewUpdate=function(e,i,r,a){a&&e.$q(new n._Collection),e.$h(null);var s=null;t.isValue(r.currentView)&&(s=r.currentView.name);var o=r.defaultCustomViewId;if(a&&t.isValue(r.newView)){var l=f._createNew(e,i,r.newView,o);e.$p()._add(l.$7(),l.$5())}if(e.$o(e.$i()),e.$j(new n._Collection),t.isValue(r.customViews)){var u=r.customViews;if(u.length>0)for(var c=0;c<u.length;c++){var h=f._createNew(e,i,u[c],o);e.$i()._add(h.$7(),h.$5()),e.$n()._has(h.$7())?e.$n()._remove(h.$7()):a&&(e.$p()._has(h.$7())||e.$p()._add(h.$7(),h.$5())),t.isValue(s)&&t.referenceEquals(h.$7(),s)&&e.$h(h.$5())}}},f.$0=function(e,i,r){return new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))(e,0,r,(function(e,t){i.reject(n._TableauException.create("serverError",t))}))};var m=function(e,t,i){this.$d=null,this.$f=new n._Collection,this.$e=new n._Collection,p.call(this,e,t,i)};m.__typeName="tab._DashboardImpl",e.tab._DashboardImpl=m;var d=function(e,t){this.$3=null,this.$1=new n._Collection,this.$2=!1,this.$0=null,n._Param.verifyString(e,"name"),this.$3=e,this.$2=t};d.__typeName="tab._DataSourceImpl",d.processDataSource=function(e){for(var i=new d(e.name,e.isPrimary),r=t.coalesce(e.fields,[]),a=0;a<r.length;a++){var s=r[a],o=n.ApiEnumConverter.convertFieldRole(s.role),l=n.ApiEnumConverter.convertFieldAggregation(s.aggregation),u=new J(i.get_dataSource(),s.name,o,l);i.addField(u)}return i},d.processDataSourcesForWorksheet=function(e){for(var i=new n._Collection,r=null,a=0;a<e.dataSources.length;a++){var s=e.dataSources[a],o=d.processDataSource(s);s.isPrimary?r=o:i._add(s.name,o.get_dataSource())}return t.isValue(r)&&i._addToFirst(r.get_name(),r.get_dataSource()),i},e.tab._DataSourceImpl=d;var p=function(e,t,i){this.$5=null,this.$1=0,this.$2=!1,this.$3=!1,this.$7=null,this.$8=null,this.$9=null,this.$a=null,this.$4=null,this.$6=null,this.$b=0,n._Param.verifyValue(e,"sheetInfoImpl"),n._Param.verifyValue(t,"workbookImpl"),n._Param.verifyValue(i,"messagingOptions"),this.$5=e.name,this.$1=e.index,this.$2=e.isActive,this.$3=e.isHidden,this.$7=e.sheetType,this.$8=e.size,this.$9=e.url,this.$a=t,this.$4=i,this.$b=e.zoneId};p.__typeName="tab._SheetImpl",p.$0=function(e){return t.isValue(e)?n._Utility.toInt(e):e},p.$1=function(e){var i=n.PublicEnums.normalizeEnum(n.ApiSheetSizeBehavior).call(null,e.behavior,"size.behavior"),r=e.minSize;t.isValue(r)&&(r=n.Size.$ctor(p.$0(e.minSize.width),p.$0(e.minSize.height)));var a=e.maxSize;return t.isValue(a)&&(a=n.Size.$ctor(p.$0(e.maxSize.width),p.$0(e.maxSize.height))),n.SheetSize.$ctor(i,r,a)},e.tab._SheetImpl=p;var $=function(){};$.__typeName="tab._SheetInfoImpl",$.$ctor=function(e,t,i,n,r,a,s,o,l){var u=new Object;return u.name=null,u.index=0,u.workbook=null,u.url=null,u.isHidden=!1,u.sheetType=null,u.zoneId=0,u.size=null,u.isActive=!1,u.name=e,u.sheetType=t,u.index=i,u.size=n,u.workbook=r,u.url=a,u.isActive=s,u.isHidden=o,u.zoneId=l,u},$.isInstanceOfType=function(){return!0},e.tab._SheetInfoImpl=$;var _=function(e,t,i,r,a){this.$g=null,this.$h=null,this.$i=null,this.$j=null,this.$2$1=null,p.call(this,e,t,i),n._Param.verifyValue(r,"storyPm"),n._Param.verifyValue(a,"findSheetFunc"),this.$h=a,this.update(r)};_.__typeName="tab._StoryImpl",e.tab._StoryImpl=_;var g=function(e,i){if(this.$1=null,this.$3=0,this.$4=!1,this.$5=!1,this.$2=null,this.$6=null,this.$7=null,this.$8=0,this.$4=e.isActive,this.$5=e.isUpdated,this.$1=e.caption,this.$3=e.index,this.$6=e.parentStoryImpl,this.$8=e.storyPointId,this.$2=i,t.isValue(i)&&(this.$2.set_parentStoryPointImpl(this),"dashboard"===i.get_sheetType()))for(var n=this.$2,r=0;r<n.get_worksheets().get__length();r++){n.get_worksheets().get_item(r)._impl.set_parentStoryPointImpl(this)}};g.__typeName="tab._StoryPointImpl",g.createContainedSheet=function(e,i,r,a){var s=n.ApiEnumConverter.convertSheetType(e.sheetType),o=n.SheetSizeFactory.createAutomatic(),l=a(e.name),u=t.isNullOrUndefined(l),c=u?"":l.getUrl(),h=$.$ctor(e.name,s,-1,o,i.get_workbook(),c,!1,u,e.zoneId);if("worksheet"===e.sheetType){return new S(h,i,r,null)}if("dashboard"===e.sheetType){var f=new m(h,i,r),d=E.$0(e.dashboardZones);return f.$c(d,a),f}throw"story"===e.sheetType?n._TableauException.createInternalError("Cannot have a story embedded within another story."):n._TableauException.createInternalError("Unknown sheet type '"+e.sheetType+"'")},e.tab._StoryPointImpl=g;var v=function(){};v.__typeName="tab._StoryPointInfoImpl",v.$ctor=function(e,t,i,n,r,a){var s=new Object;return s.storyPointId=0,s.parentStoryImpl=null,s.caption=null,s.index=0,s.isActive=!1,s.isUpdated=!1,s.caption=e,s.index=t,s.storyPointId=i,s.isActive=n,s.isUpdated=r,s.parentStoryImpl=a,s},v.isInstanceOfType=function(){return!0},e.tab._StoryPointInfoImpl=v;var y=function(e,t){this.$0=null,this.$2=null,this.$1=null,this.$2=e,this.$1=t};y.__typeName="tab._ToolbarStateImpl",e.tab._ToolbarStateImpl=y;var w=function(){};w.__typeName="tab._VizManagerImpl",w.$4=function(){return w.$5.concat()},w.$0=function(e){w.$3(e),w.$5.push(e)},w.$2=function(e){for(var i=0,n=w.$5.length;i<n;i++)if(t.referenceEquals(w.$5[i],e)){w.$5.splice(i,1);break}},w.$1=function(){for(var e=0,t=w.$5.length;e<t;e++)w.$5[e]._impl.$O()},w.$3=function(e){for(var i=e.getParentElement(),r=0,a=w.$5.length;r<a;r++)if(t.referenceEquals(w.$5[r].getParentElement(),i)){var s="Another viz is already present in element '"+n._Utility.elementToString(i)+"'.";throw n._TableauException.create("vizAlreadyInManager",s)}};var b=function(e,i,r){if(this.name="",this.host_url=null,this.tabs=!1,this.toolbar=!1,this.toolBarPosition=null,this.device=null,this.hostId=null,this.width=null,this.height=null,this.parentElement=null,this.userSuppliedParameters=null,this.staticImageUrl=null,this.fixedSize=!1,this.displayStaticImage=!1,this.iframeSizedToWindow=!1,this.$2=null,this.$1=null,t.isNullOrUndefined(e)||t.isNullOrUndefined(i))throw n._TableauException.create("noUrlOrParentElementNotFound","URL is empty or Parent element not found");t.isNullOrUndefined(r)&&((r=new Object).hideTabs=!1,r.hideToolbar=!1,r.onFirstInteractive=null),t.isValue(r.height)||t.isValue(r.width)?(this.fixedSize=!0,n._Utility.isNumber(r.height)&&(r.height=r.height.toString()+"px"),n._Utility.isNumber(r.width)&&(r.width=r.width.toString()+"px"),this.height=t.isValue(r.height)?n._Utility.roundVizSizeInPixels(r.height.toString()):null,this.width=t.isValue(r.width)?n._Utility.roundVizSizeInPixels(r.width.toString()):null):this.fixedSize=!1,this.displayStaticImage=r.displayStaticImage||!1,this.staticImageUrl=r.staticImageUrl||"",this.tabs=!r.hideTabs,this.toolbar=!r.hideToolbar,this.device=r.device,this.iframeSizedToWindow=r.iframeSizedToWindow,this.parentElement=e,this.$1=r,this.toolBarPosition=r.toolbarPosition;var a=i.split("?");this.$2=a[0],2===a.length?this.userSuppliedParameters=a[1]:this.userSuppliedParameters="";var s=new RegExp(".*?[^/:]/","").exec(this.$2);if(t.isNullOrUndefined(s)||-1===s[0].toLowerCase().indexOf("http://")&&-1===s[0].toLowerCase().indexOf("https://"))throw n._TableauException.create("invalidUrl","Invalid url");this.host_url=s[0].toLowerCase(),this.name=this.$2.replace(s[0],""),this.name=this.name.replace("views/","")};b.__typeName="tab._VizParameters",e.tab._VizParameters=b;var E=function(e,t,i){this.$E=null,this.$D=null,this.$y=null,this.$s=null,this.$r=null,this.$A=new n._Collection,this.$v=!1,this.$x=null,this.$t=null,this.$u=new n._Collection,this.$C=new n._Collection,this.$B=new n._Collection,this.$z=null,this.$w=null,this.$D=e,this.$x=t,this.$5(i)};E.__typeName="tab._WorkbookImpl",E.$0=function(e){e=t.coalesce(e,[]);for(var i=[],r=0;r<e.length;r++){var a=e[r],s=n.ApiEnumConverter.convertDashboardObjectType(a.zoneType),o=n.Size.$ctor(a.width,a.height),l=n.Point.$ctor(a.x,a.y),u={name:a.name,objectType:s,position:l,size:o,zoneId:a.zoneId};i.push(u)}return i},E.$2=function(e){if(t.isNullOrUndefined(e))return null;if(n._Utility.isString(e))return e;var i=t.safeCast(e,te);if(t.isValue(i))return i.getName();var r=t.safeCast(e,ie);return t.isValue(r)?r.getName():null},E.$1=function(e){return t.isNullOrUndefined(e)?n.SheetSizeFactory.createAutomatic():n.SheetSizeFactory.fromSizeConstraints(e.sizeConstraints)},E.$4=function(e){for(var t=new n._Collection,i=0;i<e.parameters.length;i++){var r=e.parameters[i],a=new l(r);t._add(a.$7(),a.$8())}return t},E.$3=function(e,i){for(var n=0;n<i.parameters.length;n++){var r=i.parameters[n];if(t.referenceEquals(r.name,e))return new l(r)}return null},e.tab._WorkbookImpl=E;var S=function(e,t,i,r){this.$N=null,this.$K=null,this.$J=new n.GetDataCommandsBuilder,this.$H=new n.FilterCommandsBuilder,this.$M=new n.SharedUtils,this.$I=new n._Collection,this.$L=new n._Collection,this.highlightedMarks=null,p.call(this,e,t,i),this.$K=r};S.__typeName="tab._WorksheetImpl",S.$1=function(e){var i=e;if(t.isValue(i)&&t.isValue(i.errorCode)){var r=t.isValue(i.additionalInformation)?i.additionalInformation.toString():"";switch(i.errorCode){case"invalidFilterFieldName":return n._TableauException.create("invalidFilterFieldName",r);case"invalidFilterFieldValue":return n._TableauException.create("invalidFilterFieldValue",r);case"invalidAggregationFieldName":return n._TableauException.createInvalidAggregationFieldName(r);default:return n._TableauException.createServerError(r)}}return null},S.$0=function(e){var i=e;if(t.isValue(i)&&t.isValue(i.errorCode)){var r=t.isValue(i.additionalInformation)?i.additionalInformation.toString():"";switch(i.errorCode){case"invalidSelectionFieldName":return n._TableauException.create("invalidSelectionFieldName",r);case"invalidSelectionValue":return n._TableauException.create("invalidSelectionValue",r);case"invalidSelectionDate":return n._TableauException.create("invalidSelectionDate",r)}}return null},e.tab._WorksheetImpl=S;var N=function(e,t,i){this.$2=null,P.call(this,e,t),this.$2=new r(t._impl.get__workbookImpl(),i)};N.__typeName="tab.CustomViewEvent",e.tab.CustomViewEvent=N;var C=function(e,t){this.$0=null,this.$1=null,this.$0=e,this.$1=t};C.__typeName="tab.EventContext",e.tab.EventContext=C;var T=function(e,t,i,n,r){this.$4=null,this.$3=null,L.call(this,e,t,i),this.$4=r,this.$3=new a(t._impl.get__workbookImpl(),i,n,r)};T.__typeName="tab.FilterEvent",e.tab.FilterEvent=T;var A=function(e,t,i){this.$2=null,P.call(this,e,t),this.$2=i};A.__typeName="tab.FirstVizSizeKnownEvent",e.tab.FirstVizSizeKnownEvent=A;var I=function(e,t,i){this.$3=null,L.call(this,e,t,i),this.$3=new s(t._impl.get__workbookImpl(),i)};I.__typeName="tab.HighlightEvent",e.tab.HighlightEvent=I;var O=function(){};O.__typeName="tab.IJsApiMessageHandler",e.tab.IJsApiMessageHandler=O;var V=function(){this.$3={},this.$2=null;var e=t.mkdel(this,(function(e,t){this.$1(e,t)}));this.$2=new n.CrossDomainMessager(e)};V.__typeName="tab.JsApiMessageRouter",e.tab.JsApiMessageRouter=V;var k=function(e,t){this.$1=null,this.$0=null,n._Param.verifyValue(e,"router"),n._Param.verifyValue(t,"handler"),this.$1=e,this.$0=t};k.__typeName="tab.JsApiMessagingOptions",e.tab.JsApiMessagingOptions=k;var x=function(e,t,i){this.$3=null,L.call(this,e,t,i),this.$3=new u(t._impl.get__workbookImpl(),i)};x.__typeName="tab.MarksEvent",e.tab.MarksEvent=x;var D=function(e,t,i){this.$2=null,P.call(this,e,t),this.$2=new c(t._impl.get__workbookImpl(),i)};D.__typeName="tab.ParameterEvent",e.tab.ParameterEvent=D;var R=function(){};R.__typeName="tab.StoryPointInfoImplUtil",R.clone=function(e){return v.$ctor(e.caption,e.index,e.storyPointId,e.isActive,e.isUpdated,e.parentStoryImpl)},e.tab.StoryPointInfoImplUtil=R;var U=function(e,t,i,n){this.$3=null,this.$2=null,P.call(this,e,t),this.$3=i,this.$2=n};U.__typeName="tab.StoryPointSwitchEvent",e.tab.StoryPointSwitchEvent=U;var P=function(e,t){this.$1=null,this.$0=null,this.$1=t,this.$0=e};P.__typeName="tab.TableauEvent",e.tab.TableauEvent=P;var z=function(e,t,i,n){this.$3=null,this.$2=null,P.call(this,e,t),this.$3=i,this.$2=n};z.__typeName="tab.TabSwitchEvent",e.tab.TabSwitchEvent=z;var F=function(e,t,i){this.$2=null,P.call(this,e,t),this.$2=i};F.__typeName="tab.ToolbarStateEvent",e.tab.ToolbarStateEvent=F;var j=function(e,i,r,a,s){if(this.$1b=null,this.$1p=null,this.$1e=null,this.$1o=null,this.$1n=null,this.$1f=null,this.$1h=null,this.$1s=null,this.$1l=null,this.$1m=null,this.$1k=!1,this.$1d=!1,this.$1i=!1,this.$1c=!1,this.$1j=null,this.$1q=null,this.$1r=null,this.$1g=!1,this.$1$1=null,this.$1$2=null,this.$1$3=null,this.$1$4=null,this.$1$5=null,this.$1$6=null,this.$1$7=null,this.$1$8=null,this.$1$9=null,this.$1$10=null,this.$1$11=null,this.$1$12=null,this.$1$13=null,this.$1$14=null,!n._Utility.hasWindowPostMessage()||!n._Utility.hasJsonParse())throw n._TableauException.createBrowserNotCapable();this.$1j=new k(e,this),this.$1p=i,(t.isNullOrUndefined(r)||1!==r.nodeType)&&(r=document.body),this.$1n=new b(r,a,s),t.isValue(s)&&(this.$1l=s.onFirstInteractive,this.$1m=s.onFirstVizSizeKnown)};j.__typeName="tab.VizImpl",e.tab.VizImpl=j;var M=function(e,t,i){this.$2=null,P.call(this,e,t),this.$2=i};M.__typeName="tab.VizResizeEvent",e.tab.VizResizeEvent=M;var H=function(){};H.__typeName="tab.VizSize",H.$ctor=function(e,t){var i=new Object;return i.sheetSize=null,i.chromeHeight=0,i.sheetSize=e,i.chromeHeight=t,i},H.isInstanceOfType=function(){return!0},e.tab.VizSize=H;var L=function(e,t,i){this.$2=null,P.call(this,e,t),this.$2=i};L.__typeName="tab.WorksheetEvent",e.tab.WorksheetEvent=L;var W=function(e,t){this.$a=!1,this.$9=null,Q.call(this,e,t),this.$8(t)};W.__typeName="tableauSoftware.CategoricalFilter",e.tableauSoftware.CategoricalFilter=W;var G=function(e){this._impl=null,this._impl=e};G.__typeName="tableauSoftware.CustomView",e.tableauSoftware.CustomView=G;var q=function(e){this._impl=null,te.call(this,e)};q.__typeName="tableauSoftware.Dashboard",e.tableauSoftware.Dashboard=q;var B=function(e,i,r){if(this.$2=null,this.$0=null,this.$1=null,"worksheet"===e.objectType&&t.isNullOrUndefined(r))throw n._TableauException.createInternalError("worksheet parameter is required for WORKSHEET objects");if("worksheet"!==e.objectType&&t.isValue(r))throw n._TableauException.createInternalError("worksheet parameter should be undefined for non-WORKSHEET objects");this.$2=e,this.$0=i,this.$1=r};B.__typeName="tableauSoftware.DashboardObject",e.tableauSoftware.DashboardObject=B;var K=function(e){this.$0=null,this.$0=e};K.__typeName="tableauSoftware.DataSource",e.tableauSoftware.DataSource=K;var J=function(e,t,i,n){this.$0=null,this.$3=null,this.$2=null,this.$1=null,this.$0=e,this.$3=t,this.$2=i,this.$1=n};J.__typeName="tableauSoftware.Field",e.tableauSoftware.Field=J;var Q=function(e,t){this.$7=null,this.$6=null,this.$1=null,this.$3=null,this.$2=null,this.$5=null,this.$4=null,this.$7=e,this.$0(t)};Q.__typeName="tableauSoftware.Filter",Q.$0=function(e,t){switch(t.filterType){case"categorical":return new W(e,t);case"relativedate":return new ee(e,t);case"hierarchical":return new Y(e,t);case"quantitative":return new Z(e,t)}return null},Q.processFiltersList=function(e,t){for(var i=new n._Collection,r=0;r<t.filters.length;r++){var a=t.filters[r];i._has(a.caption)||i._add(a.caption,a.caption)}for(var s=new n._Collection,o=0;o<t.filters.length;o++){var l=t.filters[o],u=Q.$0(e,l);if(s._has(l.caption)){for(var c=l.caption.toString()+"_"+l.filterType.toString(),h=c,f=1;i._has(h);)h=c+"_"+f,f++;s._add(h,u)}else s._add(l.caption,u)}return s},e.tableauSoftware.Filter=Q;var Y=function(e,t){this.$9=0,Q.call(this,e,t),this.$8(t)};Y.__typeName="tableauSoftware.HierarchicalFilter",e.tableauSoftware.HierarchicalFilter=Y;var X=function(e){this._impl=null,this._impl=e};X.__typeName="tableauSoftware.Parameter",e.tableauSoftware.Parameter=X;var Z=function(e,t){this.$a=null,this.$9=null,this.$d=null,this.$c=null,this.$b=!1,Q.call(this,e,t),this.$8(t)};Z.__typeName="tableauSoftware.QuantitativeFilter",e.tableauSoftware.QuantitativeFilter=Z;var ee=function(e,t){this.$9=null,this.$b=null,this.$a=0,Q.call(this,e,t),this.$8(t)};ee.__typeName="tableauSoftware.RelativeDateFilter",e.tableauSoftware.RelativeDateFilter=ee;var te=function(e){this._impl=null,n._Param.verifyValue(e,"sheetImpl"),this._impl=e};te.__typeName="tableauSoftware.Sheet",e.tableauSoftware.Sheet=te;var ie=function(e){this.$0=null,this.$0=e};ie.__typeName="tableauSoftware.SheetInfo",e.tableauSoftware.SheetInfo=ie;var ne=function(e){this._impl=null,te.call(this,e)};ne.__typeName="tableauSoftware.Story",e.tableauSoftware.Story=ne;var re=function(e){this.$0=null,this.$0=e};re.__typeName="tableauSoftware.StoryPoint",e.tableauSoftware.StoryPoint=re;var ae=function(e){this._impl=null,this._impl=e};ae.__typeName="tableauSoftware.StoryPointInfo",e.tableauSoftware.StoryPointInfo=ae;var se=function(e){this._impl=null,this._impl=e};se.__typeName="tableauSoftware.ToolbarState",e.tableauSoftware.ToolbarState=se;var oe=function(e,i,n,r){this.$0=0,this.$2=0,this.$3=0,this.$1=null,this.$0=e,this.$2=i,this.$3=n,this.$1=t.coalesce(r,null)};oe.__typeName="tableauSoftware.Version",oe.getCurrent=function(){return oe.$0},e.tableauSoftware.Version=oe;var le=function(e,t,i){this._impl=null;var r=n._ApiObjectRegistry.getApiMessageRouter();this._impl=new j(r,this,e,t,i),this._impl.$4()};le.__typeName="tableauSoftware.Viz",e.tableauSoftware.Viz=le;var ue=function(){};ue.__typeName="tableauSoftware.VizManager",ue.getVizs=function(){return w.$4()},e.tableauSoftware.VizManager=ue;var ce=function(e){this.$0=null,this.$0=e};ce.__typeName="tableauSoftware.Workbook",e.tableauSoftware.Workbook=ce;var he=function(e){this._impl=null,te.call(this,e)};he.__typeName="tableauSoftware.Worksheet",e.tableauSoftware.Worksheet=he,t.initClass(C,i,{get__workbookImpl:function(){return this.$0},get__worksheetImpl:function(){return this.$1}}),t.initClass(r,i,{get__customViewImpl:function(){return this.$2}},C),t.initClass(a,i,{get__filterFieldName:function(){return this.$3},$2:function(){return this.$4}},C),t.initClass(s,i,{},C),t.initClass(o,i,{}),t.initClass(l,i,{$8:function(){return t.isNullOrUndefined(this.$i)&&(this.$i=new X(this)),this.$i},$7:function(){return this.$h},$2:function(){return this.$c},$3:function(){return this.$d},$1:function(){return this.$b},$0:function(){return this.$a},$6:function(){return this.$g},$5:function(){return this.$f},$9:function(){return this.$j},$4:function(){return this.$e}}),t.initClass(u,i,{},C),t.initClass(c,i,{get__parameterName:function(){return this.$2}},C),t.initClass(h,i,{}),t.initClass(f,i,{$5:function(){return t.isNullOrUndefined(this.$c)&&(this.$c=new G(this)),this.$c},$b:function(){return this.$l.get_workbook()},$a:function(){return this.$k},$7:function(){return this.$h},$8:function(e){if(this.$f)throw n._TableauException.create("staleDataReference","Stale data");this.$h=e},$9:function(){return this.$i},$3:function(){return this.$e},$4:function(e){if(this.$f)throw n._TableauException.create("staleDataReference","Stale data");this.$e=e},$6:function(){return this.$d},$2:function(){if(this.$f||t.isNullOrUndefined(this.$j))throw n._TableauException.create("staleDataReference","Stale data");this.$j.isPublic=this.$e,this.$j.name=this.$h;var e=new n._Deferred,i={};i["api.customViewParam"]=this.$j;var r=f.$0("api.UpdateCustomViewCommand",e,t.mkdel(this,(function(t){f._processCustomViewUpdate(this.$l,this.$g,t,!0),e.resolve(this.$5())})));return this.$g.sendCommand(Object).call(this.$g,i,r),e.get_promise()},$1:function(){var e=new n._Deferred,i={};i["api.customViewParam"]=this.$j;var r=f.$0("api.RemoveCustomViewCommand",e,t.mkdel(this,(function(t){this.$f=!0,f._processCustomViews(this.$l,this.$g,t),e.resolve(this.$5())})));return this.$g.sendCommand(Object).call(this.$g,i,r),e.get_promise()},_showAsync:function(){if(this.$f||t.isNullOrUndefined(this.$j))throw n._TableauException.create("staleDataReference","Stale data");return f._showCustomViewAsync(this.$l,this.$g,this.$j)},$0:function(e){return!t.referenceEquals(this.$i,e.$i)||!t.referenceEquals(this.$k,e.$k)||this.$e!==e.$e||this.$d!==e.$d}}),t.initClass(p,i,{get_sheet:null,get_name:function(){return this.$5},get_index:function(){return this.$1},get_workbookImpl:function(){return this.$a},get_workbook:function(){return this.$a.get_workbook()},get_url:function(){if(this.$3)throw n._TableauException.createNoUrlForHiddenWorksheet();return this.$9},get_size:function(){return this.$8},get_isHidden:function(){return this.$3},get_isActive:function(){return this.$2},set_isActive:function(e){this.$2=e},get_isDashboard:function(){return"dashboard"===this.$7},get_isStory:function(){return"story"===this.$7},get_sheetType:function(){return this.$7},get_parentStoryPoint:function(){return t.isValue(this.$6)?this.$6.get_storyPoint():null},get_parentStoryPointImpl:function(){return this.$6},set_parentStoryPointImpl:function(e){if("story"===this.$7)throw n._TableauException.createInternalError("A story cannot be a child of another story.");this.$6=e},get_zoneId:function(){return this.$b},get_messagingOptions:function(){return this.$4},changeSizeAsync:function(e){if(e=p.$1(e),"worksheet"===this.$7&&"automatic"!==e.behavior)throw n._TableauException.createInvalidSizeBehaviorOnWorksheet();var i=new n._Deferred;if(this.$8.behavior===e.behavior&&"automatic"===e.behavior)return i.resolve(e),i.get_promise();var r=this.$0(e),a={};a["api.setSheetSizeName"]=this.$5,a["api.minWidth"]=r["api.minWidth"],a["api.minHeight"]=r["api.minHeight"],a["api.maxWidth"]=r["api.maxWidth"],a["api.maxHeight"]=r["api.maxHeight"];var s=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.SetSheetSizeCommand",1,t.mkdel(this,(function(e){this.get_workbookImpl()._update(t.mkdel(this,(function(){var e=this.get_workbookImpl().get_publishedSheets()._get(this.get_name()).getSize();i.resolve(e)})))})),(function(e,t){i.reject(n._TableauException.createServerError(t))}));return this.sendCommand(Object).call(this,a,s),i.get_promise()},sendCommand:function(e){return function(t,i){this.$4.sendCommand(e).call(this.$4,t,i)}},$0:function(e){var i=null;if(t.isNullOrUndefined(e)||t.isNullOrUndefined(e.behavior)||"automatic"!==e.behavior&&t.isNullOrUndefined(e.minSize)&&t.isNullOrUndefined(e.maxSize))throw n._TableauException.createInvalidSheetSizeParam();var r=0,a=0,s=0,o=0,l={"api.minWidth":0,"api.minHeight":0,"api.maxWidth":0,"api.maxHeight":0};if("automatic"===e.behavior)i=n.SheetSize.$ctor("automatic",void 0,void 0);else if("atmost"===e.behavior){if(t.isNullOrUndefined(e.maxSize)||t.isNullOrUndefined(e.maxSize.width)||t.isNullOrUndefined(e.maxSize.height))throw n._TableauException.createMissingMaxSize();if(e.maxSize.width<0||e.maxSize.height<0)throw n._TableauException.createInvalidSizeValue();l["api.maxWidth"]=e.maxSize.width,l["api.maxHeight"]=e.maxSize.height,i=n.SheetSize.$ctor("atmost",void 0,e.maxSize)}else if("atleast"===e.behavior){if(t.isNullOrUndefined(e.minSize)||t.isNullOrUndefined(e.minSize.width)||t.isNullOrUndefined(e.minSize.height))throw n._TableauException.createMissingMinSize();if(e.minSize.width<0||e.minSize.height<0)throw n._TableauException.createInvalidSizeValue();l["api.minWidth"]=e.minSize.width,l["api.minHeight"]=e.minSize.height,i=n.SheetSize.$ctor("atleast",e.minSize,void 0)}else if("range"===e.behavior){if(t.isNullOrUndefined(e.minSize)||t.isNullOrUndefined(e.maxSize)||t.isNullOrUndefined(e.minSize.width)||t.isNullOrUndefined(e.maxSize.width)||t.isNullOrUndefined(e.minSize.height)||t.isNullOrUndefined(e.maxSize.height))throw n._TableauException.createMissingMinMaxSize();if(e.minSize.width<0||e.minSize.height<0||e.maxSize.width<0||e.maxSize.height<0||e.minSize.width>e.maxSize.width||e.minSize.height>e.maxSize.height)throw n._TableauException.createInvalidRangeSize();l["api.minWidth"]=e.minSize.width,l["api.minHeight"]=e.minSize.height,l["api.maxWidth"]=e.maxSize.width,l["api.maxHeight"]=e.maxSize.height,i=n.SheetSize.$ctor("range",e.minSize,e.maxSize)}else if("exactly"===e.behavior){if(t.isValue(e.minSize)&&t.isValue(e.maxSize)&&t.isValue(e.minSize.width)&&t.isValue(e.maxSize.width)&&t.isValue(e.minSize.height)&&t.isValue(e.maxSize.height)){if(r=e.minSize.width,a=e.minSize.height,s=e.maxSize.width,o=e.maxSize.height,r!==s||a!==o)throw n._TableauException.createSizeConflictForExactly()}else t.isValue(e.minSize)&&t.isValue(e.minSize.width)&&t.isValue(e.minSize.height)?(s=r=e.minSize.width,o=a=e.minSize.height):t.isValue(e.maxSize)&&t.isValue(e.maxSize.width)&&t.isValue(e.maxSize.height)&&(r=s=e.maxSize.width,a=o=e.maxSize.height);l["api.minWidth"]=r,l["api.minHeight"]=a,l["api.maxWidth"]=s,l["api.maxHeight"]=o,i=n.SheetSize.$ctor("exactly",n.Size.$ctor(r,a),n.Size.$ctor(s,o))}return this.$8=i,l}}),t.initClass(m,i,{get_sheet:function(){return this.get_dashboard()},get_dashboard:function(){return t.isNullOrUndefined(this.$d)&&(this.$d=new q(this)),this.$d},get_worksheets:function(){return this.$f},get_objects:function(){return this.$e},$c:function(e,i){this.$e=new n._Collection,this.$f=new n._Collection;for(var r=0;r<e.length;r++){var a=e[r],s=null;if("worksheet"===e[r].objectType){var o=a.name;if(t.isNullOrUndefined(o))continue;var l=this.$f.get__length(),u=n.SheetSizeFactory.createAutomatic(),c=i(o),h=t.isNullOrUndefined(c),f=h?"":c.getUrl(),m=$.$ctor(o,"worksheet",l,u,this.get_workbook(),f,!1,h,a.zoneId),d=new S(m,this.get_workbookImpl(),this.get_messagingOptions(),this);s=d.get_worksheet(),this.$f._add(o,d.get_worksheet())}var p=new B(a,this.get_dashboard(),s);this.$e._add(r.toString(),p)}}},p),t.initClass(d,i,{get_dataSource:function(){return t.isNullOrUndefined(this.$0)&&(this.$0=new K(this)),this.$0},get_name:function(){return this.$3},get_fields:function(){return this.$1},get_isPrimary:function(){return this.$2},addField:function(e){this.$1._add(e.getName(),e)}}),t.initClass($,i,{},Object),t.initClass(_,i,{add_activeStoryPointChange:function(e){this.$2$1=t.delegateCombine(this.$2$1,e)},remove_activeStoryPointChange:function(e){this.$2$1=t.delegateRemove(this.$2$1,e)},get_activeStoryPointImpl:function(){return this.$g},get_sheet:function(){return this.get_story()},get_story:function(){return t.isNullOrUndefined(this.$i)&&(this.$i=new ne(this)),this.$i},get_storyPointsInfo:function(){return this.$j},update:function(e){var i=null,n=null;this.$j=this.$j||new Array(e.storyPoints.length);for(var r=0;r<e.storyPoints.length;r++){var a=e.storyPoints[r],s=a.caption,o=r===e.activeStoryPointIndex,l=v.$ctor(s,r,a.storyPointId,o,a.isUpdated,this);if(t.isNullOrUndefined(this.$j[r]))this.$j[r]=new ae(l);else if(this.$j[r]._impl.storyPointId===l.storyPointId){var u=this.$j[r]._impl;u.caption=l.caption,u.index=l.index,u.isActive=o,u.isUpdated=l.isUpdated}else this.$j[r]=new ae(l);o&&(i=a.containedSheetInfo,n=l)}var c=this.$j.length-e.storyPoints.length;this.$j.splice(e.storyPoints.length,c);var h=t.isNullOrUndefined(this.$g)||this.$g.get_storyPointId()!==n.storyPointId;t.isValue(this.$g)&&h&&this.$g.set_isActive(!1);var f=this.$g;if(h){var m=g.createContainedSheet(i,this.get_workbookImpl(),this.get_messagingOptions(),this.$h);this.$g=new g(n,m)}else this.$g.set_isActive(n.isActive),this.$g.set_isUpdated(n.isUpdated);h&&t.isValue(f)&&this.$d(this.$j[f.get_index()],this.$g.get_storyPoint())},activatePreviousStoryPointAsync:function(){return this.$c("api.ActivatePreviousStoryPoint")},activateNextStoryPointAsync:function(){return this.$c("api.ActivateNextStoryPoint")},activateStoryPointAsync:function(e){var i=new n._Deferred;if(e<0||e>=this.$j.length)throw n._TableauException.createIndexOutOfRange(e);var r={};r["api.storyPointIndex"]=e;var a=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.ActivateStoryPoint",0,t.mkdel(this,(function(e){this.$e(e),i.resolve(this.$g.get_storyPoint())})),(function(e,t){i.reject(n._TableauException.createServerError(t))}));return this.sendCommand(Object).call(this,r,a),i.get_promise()},revertStoryPointAsync:function(e){if((e=e||this.$g.get_index())<0||e>=this.$j.length)throw n._TableauException.createIndexOutOfRange(e);var i=new n._Deferred,r={};r["api.storyPointIndex"]=e;var a=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.RevertStoryPoint",0,t.mkdel(this,(function(t){this.$f(e,t),i.resolve(this.$j[e])})),(function(e,t){i.reject(n._TableauException.createServerError(t))}));return this.sendCommand(Object).call(this,r,a),i.get_promise()},$c:function(e){if("api.ActivatePreviousStoryPoint"!==e&&"api.ActivateNextStoryPoint"!==e)throw n._TableauException.createInternalError("commandName '"+e+"' is invalid.");var i=new n._Deferred,r=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))(e,0,t.mkdel(this,(function(e){this.$e(e),i.resolve(this.$g.get_storyPoint())})),(function(e,t){i.reject(n._TableauException.createServerError(t))}));return this.sendCommand(Object).call(this,{},r),i.get_promise()},$f:function(e,t){var i=this.$j[e]._impl;if(i.storyPointId!==t.storyPointId)throw n._TableauException.createInternalError("We should not be updating a story point where the IDs don't match. Existing storyPointID="+i.storyPointId+", newStoryPointID="+t.storyPointId);i.caption=t.caption,i.isUpdated=t.isUpdated,t.storyPointId===this.$g.get_storyPointId()&&this.$g.set_isUpdated(t.isUpdated)},$e:function(e){var t=this.$g,i=e.index;if(t.get_index()!==i){var n=this.$j[t.get_index()],r=this.$j[i]._impl,a=g.createContainedSheet(e.containedSheetInfo,this.get_workbookImpl(),this.get_messagingOptions(),this.$h);r.isActive=!0,this.$g=new g(r,a),t.set_isActive(!1),n._impl.isActive=!1,this.$d(n,this.$g.get_storyPoint())}},$d:function(e,i){t.staticEquals(this.$2$1,null)||this.$2$1(e,i)}},p),t.initClass(g,i,{get_caption:function(){return this.$1},get_containedSheetImpl:function(){return this.$2},get_index:function(){return this.$3},get_isActive:function(){return this.$4},set_isActive:function(e){this.$4=e},get_isUpdated:function(){return this.$5},set_isUpdated:function(e){this.$5=e},get_parentStoryImpl:function(){return this.$6},get_storyPoint:function(){return t.isNullOrUndefined(this.$7)&&(this.$7=new re(this)),this.$7},get_storyPointId:function(){return this.$8},$0:function(){return v.$ctor(this.$1,this.$3,this.$8,this.$4,this.$5,this.$6)}}),t.initClass(v,i,{},Object),t.initClass(y,i,{get_toolbarState:function(){return t.isNullOrUndefined(this.$0)&&(this.$0=new se(this)),this.$0},get_viz:function(){return this.$2.$18()},isButtonEnabled:function(e){switch(e){case"redo":return this.$1.canRedo;case"undo":return this.$1.canUndo;default:throw n._TableauException.createInvalidToolbarButtonName(e)}}}),t.initClass(w,i,{}),t.initClass(b,i,{get_url:function(){return this.$0()},get_baseUrl:function(){return this.$2},$0:function(){var e=[];e.push(this.get_baseUrl()),e.push("?"),this.userSuppliedParameters.length>0&&(e.push(this.userSuppliedParameters),e.push("&")),!this.fixedSize&&!(-1!==this.userSuppliedParameters.indexOf(":size="))&&this.parentElement.clientWidth*this.parentElement.clientHeight>0&&(e.push(":size="),e.push(this.parentElement.clientWidth+","+this.parentElement.clientHeight),e.push("&")),e.push(":embed=y"),e.push("&:showVizHome=n"),this.fixedSize||e.push("&:bootstrapWhenNotified=y"),this.tabs||e.push("&:tabs=n"),this.displayStaticImage&&e.push("&:display_static_image=y"),this.toolbar?t.isNullOrUndefined(this.toolBarPosition)||(e.push("&:toolbar="),e.push(this.toolBarPosition.toString())):e.push("&:toolbar=n"),t.isValue(this.device)&&(e.push("&:device="),e.push(this.device.toString()));var i=this.$1,n=new t.ObjectEnumerator(i);try{for(;n.moveNext();){var r=n.current();"embed"!==r.key&&"height"!==r.key&&"width"!==r.key&&"device"!==r.key&&"autoSize"!==r.key&&"hideTabs"!==r.key&&"hideToolbar"!==r.key&&"onFirstInteractive"!==r.key&&"onFirstVizSizeKnown"!==r.key&&"toolbarPosition"!==r.key&&"instanceIdToClone"!==r.key&&"display_static_image"!==r.key&&(e.push("&"),e.push(encodeURIComponent(r.key)),e.push("="),e.push(encodeURIComponent(r.value.toString())))}}finally{n.dispose()}return e.push("&:apiID="+this.hostId),t.isValue(this.$1.instanceIdToClone)&&e.push("#"+this.$1.instanceIdToClone),e.join("")}}),t.initClass(E,i,{get_workbook:function(){return t.isNullOrUndefined(this.$E)&&(this.$E=new ce(this)),this.$E},get_viz:function(){return this.$D.$18()},get_publishedSheets:function(){return this.$A},get_name:function(){return this.$y},get_activeSheetImpl:function(){return this.$s},get_activeCustomView:function(){return this.$t},get_isDownloadAllowed:function(){return this.$v},$4:function(e){if(t.isNullOrUndefined(this.$s))return null;var i=E.$2(e);if(t.isNullOrUndefined(i))return null;if(t.referenceEquals(i,this.$s.get_name()))return this.$s;if(this.$s.get_isDashboard()){var n=this.$s.get_worksheets()._get(i);if(t.isValue(n))return n._impl}return null},_setActiveSheetAsync:function(e){if(n._Utility.isNumber(e)){var i=e;if(i<this.$A.get__length()&&i>=0)return this.$1(this.$A.get_item(i).$0);throw n._TableauException.createIndexOutOfRange(i)}var r=E.$2(e),a=this.$A._get(r);if(t.isValue(a))return this.$1(a.$0);if(this.$s.get_isDashboard()){var s=this.$s.get_worksheets()._get(r);if(t.isValue(s)){this.$r=null;var o="";return s.getIsHidden()?this.$r=s._impl:o=s._impl.get_url(),this.$0(s._impl.get_name(),o)}}throw n._TableauException.create("sheetNotInWorkbook","Sheet is not found in Workbook")},_revertAllAsync:function(){var e=new n._Deferred,i=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.RevertAllCommand",1,(function(t){e.resolve()}),(function(t,i){e.reject(n._TableauException.createServerError(i))}));return this.$d(Object).call(this,null,i),e.get_promise()},_update:function(e){this.$5(e)},$1:function(e){return this.$0(e.name,e.url)},$0:function(e,i){var r=new n._Deferred;if(t.isValue(this.$s)&&t.referenceEquals(e,this.$s.get_name()))return r.resolve(this.$s.get_sheet()),r.get_promise();var a={};a["api.switchToSheetName"]=e,a["api.switchToRepositoryUrl"]=i,a["api.oldRepositoryUrl"]=this.$s.get_url();var s=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.SwitchActiveSheetCommand",0,t.mkdel(this,(function(e){this.$D.$1b=t.mkdel(this,(function(){this.$D.$1b=null,r.resolve(this.$s.get_sheet())}))})),(function(e,t){r.reject(n._TableauException.createServerError(t))}));return this.$d(Object).call(this,a,s),r.get_promise()},_updateActiveSheetAsync:function(){var e=new n._Deferred,i={};i["api.switchToSheetName"]=this.$s.get_name(),i["api.switchToRepositoryUrl"]=this.$s.get_url(),i["api.oldRepositoryUrl"]=this.$s.get_url();var r=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.UpdateActiveSheetCommand",0,t.mkdel(this,(function(t){e.resolve(this.$s.get_sheet())})),(function(t,i){e.reject(n._TableauException.createServerError(i))}));return this.$d(Object).call(this,i,r),e.get_promise()},$d:function(e){return function(t,i){this.$x.sendCommand(e).call(this.$x,t,i)}},$5:function(e){var i=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.GetClientInfoCommand",0,t.mkdel(this,(function(i){this.$a(i),t.isValue(e)&&e()})),null);this.$d(Object).call(this,null,i)},$a:function(e){this.$y=e.workbookName,this.$v=e.isDownloadAllowed,this.$D.$P(!e.isAutoUpdate),this.$D.set_instanceId(e.instanceId),this.$3(e),this.$9(e)},$9:function(e){var i=e.currentSheetName,r=this.$A._get(i);if(t.isNullOrUndefined(r)&&t.isNullOrUndefined(this.$r))throw n._TableauException.createInternalError("The active sheet was not specified in baseSheets");if(!t.isValue(this.$s)||!t.referenceEquals(this.$s.get_name(),i)){if(t.isValue(this.$s)){this.$s.set_isActive(!1);var a=this.$A._get(this.$s.get_name());if(t.isValue(a)&&(a.$0.isActive=!1),"story"===this.$s.get_sheetType())this.$s.remove_activeStoryPointChange(t.mkdel(this.$D,this.$D.raiseStoryPointSwitch))}if(t.isValue(this.$r)){var s=$.$ctor(this.$r.get_name(),"worksheet",-1,this.$r.get_size(),this.get_workbook(),"",!0,!0,4294967295);this.$r=null,this.$s=new S(s,this,this.$x,null)}else{for(var o=null,l=0,u=e.publishedSheets.length;l<u;l++)if(t.referenceEquals(e.publishedSheets[l].name,i)){o=e.publishedSheets[l];break}if(t.isNullOrUndefined(o))throw n._TableauException.createInternalError("No base sheet was found corresponding to the active sheet.");var c=t.mkdel(this,(function(e){return this.$A._get(e)}));if("dashboard"===o.sheetType){var h=new m(r.$0,this,this.$x);this.$s=h;var f=E.$0(e.dashboardZones);h.$c(f,c)}else if("story"===o.sheetType){var d=new _(r.$0,this,this.$x,e.story,c);this.$s=d,d.add_activeStoryPointChange(t.mkdel(this.$D,this.$D.raiseStoryPointSwitch))}else this.$s=new S(r.$0,this,this.$x,null);r.$0.isActive=!0}this.$s.set_isActive(!0)}},$3:function(e){var i=e.publishedSheets;if(!t.isNullOrUndefined(i))for(var r=0;r<i.length;r++){var a=i[r],s=a.name,o=this.$A._get(s),l=E.$1(a);if(t.isNullOrUndefined(o)){var u=t.referenceEquals(s,e.currentSheetName),c=n.ApiEnumConverter.convertSheetType(a.sheetType),h=$.$ctor(s,c,r,l,this.get_workbook(),a.repositoryUrl,u,!1,4294967295);o=new ie(h),this.$A._add(s,o)}else o.$0.size=l}},$i:function(){return this.$u},$j:function(e){this.$u=e},$p:function(){return this.$C},$q:function(e){this.$C=e},$n:function(){return this.$B},$o:function(e){this.$B=e},$g:function(){return this.$t},$h:function(e){this.$t=e},$6:function(){return f._getCustomViewsAsync(this,this.$x)},$f:function(e){if(t.isNullOrUndefined(e)||n._Utility.isNullOrEmpty(e))return f._showCustomViewAsync(this,this.$x,null);var i=this.$u._get(e);if(t.isNullOrUndefined(i)){var r=new n._Deferred;return r.reject(n._TableauException.createInvalidCustomViewName(e)),r.get_promise()}return i._impl._showAsync()},$c:function(e){if(n._Utility.isNullOrEmpty(e))throw n._TableauException.createNullOrEmptyParameter("customViewName");var i=this.$u._get(e);if(t.isNullOrUndefined(i)){var r=new n._Deferred;return r.reject(n._TableauException.createInvalidCustomViewName(e)),r.get_promise()}return i._impl.$1()},$b:function(e){if(n._Utility.isNullOrEmpty(e))throw n._TableauException.createInvalidParameter("customViewName");return f._saveNewAsync(this,this.$x,e)},$e:function(){return f._makeCurrentCustomViewDefaultAsync(this,this.$x)},$k:function(){return this.$w},$l:function(e){this.$w=e},$m:function(){return this.$z},$8:function(e){var i=new n._Deferred;if(t.isValue(this.$w))return i.resolve(this.$w.$8()),i.get_promise();var r=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.FetchParametersCommand",0,t.mkdel(this,(function(t){var n=E.$3(e,t);this.$w=n,i.resolve(n.$8())})),(function(e,t){i.reject(n._TableauException.createServerError(t))}));return this.$d(Object).call(this,{},r),i.get_promise()},$7:function(){var e=new n._Deferred,i=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.FetchParametersCommand",0,t.mkdel(this,(function(t){this.$z=E.$4(t),e.resolve(this.$m()._toApiCollection())})),(function(t,i){e.reject(n._TableauException.createServerError(i))}));return this.$d(Object).call(this,{},i),e.get_promise()},$2:function(e,i){var r=new n._Deferred,a=null;if(t.isValue(this.$z)){if(t.isNullOrUndefined(this.$z._get(e)))return r.reject(n._TableauException.createInvalidParameter(e)),r.get_promise();if(a=this.$z._get(e)._impl,t.isNullOrUndefined(a))return r.reject(n._TableauException.createInvalidParameter(e)),r.get_promise()}var s={};if(s["api.setParameterName"]=t.isValue(this.$z)?a.$7():e,t.isValue(i)&&n._Utility.isDate(i)){var o=i,u=n._Utility.serializeDateForServer(o);s["api.setParameterValue"]=u}else s["api.setParameterValue"]=t.isValue(i)?i.toString():null;this.$w=null;var c=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.SetParameterValueCommand",0,t.mkdel(this,(function(i){if(t.isNullOrUndefined(i))r.reject(n._TableauException.create("serverError","server error"));else if(i.isValidPresModel){var a=new l(i);this.$w=a,r.resolve(a.$8())}else r.reject(n._TableauException.createInvalidParameter(e))})),(function(t,i){r.reject(n._TableauException.createInvalidParameter(e))}));return this.$d(Object).call(this,s,c),r.get_promise()}}),t.initClass(S,i,{get_sheet:function(){return this.get_worksheet()},get_worksheet:function(){return t.isNullOrUndefined(this.$N)&&(this.$N=new he(this)),this.$N},get_parentDashboardImpl:function(){return this.$K},get_parentDashboard:function(){return t.isValue(this.$K)?this.$K.get_dashboard():null},$r:function(){this.$G();var e=new n._Deferred,i={};i["api.worksheetName"]=this.get_name();var r=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.GetDataSourcesCommand",0,(function(t){var i=d.processDataSourcesForWorksheet(t);e.resolve(i._toApiCollection())}),(function(t,i){e.reject(n._TableauException.createServerError(i))}));return this.sendCommand(Object).call(this,i,r),e.get_promise()},$q:function(e){this.$G();var i=new n._Deferred,r={};r["api.dataSourceName"]=e,r["api.worksheetName"]=this.get_name();var a=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.GetDataSourceCommand",0,(function(r){var a=d.processDataSource(r);t.isValue(a)?i.resolve(a.get_dataSource()):i.reject(n._TableauException.createServerError("Data source '"+e+"' not found"))}),(function(e,t){i.reject(n._TableauException.createServerError(t))}));return this.sendCommand(Object).call(this,r,a),i.get_promise()},$G:function(){var e=this.get_isActive(),i=t.isValue(this.$K)&&this.$K.get_isActive(),r=t.isValue(this.get_parentStoryPointImpl())&&this.get_parentStoryPointImpl().get_parentStoryImpl().get_isActive();if(!e&&!i&&!r)throw n._TableauException.createNotActiveSheet()},$d:function(e){if(t.isValue(this.get_parentStoryPointImpl())){var i={};i.worksheet=this.get_name(),i.dashboard=t.isValue(this.get_parentDashboardImpl())?this.$K.get_name():this.get_name(),i.flipboardZoneId=this.get_parentStoryPointImpl().get_containedSheetImpl().get_zoneId(),i.storyboard=this.get_parentStoryPointImpl().get_parentStoryImpl().get_name(),i.storyPointId=this.get_parentStoryPointImpl().get_storyPointId(),e["api.visualId"]=i}else{var n=t.isValue(this.get_parentDashboardImpl())?this.get_parentDashboardImpl().get_name():null;this.$M.addVisualIdForWorksheet(e,this.get_name(),n)}},get__filters:function(){return this.$I},set__filters:function(e){this.$I=e},$s:function(e,i,r){if(!n._Utility.isNullOrEmpty(e)&&!n._Utility.isNullOrEmpty(i))throw n._TableauException.createInternalError("Only fieldName OR fieldCaption is allowed, not both.");r=r||new Object;var a=new n._Deferred,s={};this.$d(s),!n._Utility.isNullOrEmpty(i)&&n._Utility.isNullOrEmpty(e)&&(s["api.fieldCaption"]=i),n._Utility.isNullOrEmpty(e)||(s["api.fieldName"]=e),s["api.filterHierarchicalLevels"]=0,s["api.ignoreDomain"]=r.ignoreDomain||!1;var o=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.GetOneFilterInfoCommand",0,t.mkdel(this,(function(e){var i=S.$1(e);if(t.isNullOrUndefined(i)){var n=e,r=Q.$0(this,n);a.resolve(r)}else a.reject(i)})),(function(e,t){a.reject(n._TableauException.createServerError(t))}));return this.sendCommand(Object).call(this,s,o),a.get_promise()},$t:function(e){this.$G(),e=e||new Object;var i=new n._Deferred,r={};this.$d(r),r["api.ignoreDomain"]=e.ignoreDomain||!1;var a=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.GetFiltersListCommand",0,t.mkdel(this,(function(e){this.set__filters(Q.processFiltersList(this,e)),i.resolve(this.get__filters()._toApiCollection())})),(function(e,t){i.reject(n._TableauException.createServerError(t))}));return this.sendCommand(Object).call(this,r,a),i.get_promise()},$e:function(e,t,i,n){return this.$f(e,t,i,n)},$m:function(e){return this.$n(e)},$i:function(e,t){var i=this.$H.normalizeRangeFilterOption(t);return this.$j(e,i)},$k:function(e,t){var i=this.$H.normalizeRelativeDateFilterOptions(t);return this.$l(e,i)},$g:function(e,i,r,a){if(t.isNullOrUndefined(i)&&"all"!==r)throw n._TableauException.createInvalidParameter("values");return this.$h(e,i,r,a)},$n:function(e){this.$G();var t=new n._Deferred,i=this.$H.buildClearFilterCommandsParam(e);this.$d(i);var r=this.$H.createFilterCommandReturnHandler("api.ClearFilterCommand",e,t);return this.sendCommand(Object).call(this,i,r),t.get_promise()},$f:function(e,t,i,r){this.$G();var a=new n._Deferred,s=this.$H.buildApplyFiltersCommandParams(e,t,i,r);this.$d(s);var o=this.$H.createFilterCommandReturnHandler("api.ApplyCategoricalFilterCommand",e,a);return this.sendCommand(Object).call(this,s,o),a.get_promise()},$j:function(e,t){this.$G();var i=this.$H.buildRangeFilterCommandParams(e,t);this.$d(i);var r=new n._Deferred,a=this.$H.createFilterCommandReturnHandler("api.ApplyRangeFilterCommand",e,r);return this.sendCommand(Object).call(this,i,a),r.get_promise()},$l:function(e,t){this.$G();var i=this.$H.buildRelativeDateFilterCommandParams(e,t);this.$d(i);var r=new n._Deferred,a=this.$H.createFilterCommandReturnHandler("api.ApplyRelativeDateFilterCommand",e,r);return this.sendCommand(Object).call(this,i,a),r.get_promise()},$h:function(e,t,i,r){this.$G();var a=this.$H.buildHierarchicalFilterCommandParams(e,t,i,r);this.$d(a);var s=new n._Deferred,o=this.$H.createFilterCommandReturnHandler("api.ApplyHierarchicalFilterCommand",e,s);return this.sendCommand(Object).call(this,a,o),s.get_promise()},get_selectedMarks:function(){return this.$L},set_selectedMarks:function(e){this.$L=e},$p:function(){this.$G();var e=new n._Deferred,i={};this.$d(i);var r=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.ClearSelectedMarksCommand",1,(function(t){e.resolve()}),(function(t,i){e.reject(n._TableauException.createServerError(i))}));return this.sendCommand(Object).call(this,i,r),e.get_promise()},$B:function(e,i,r){return this.$G(),t.isNullOrUndefined(e)&&t.isNullOrUndefined(i)?this.$p():n._Utility.isString(e)&&(n._jQueryShim.isArray(i)||n._Utility.isString(i)||!n.PublicEnums.isValidEnum(n.ApiSelectionUpdateType).call(null,i))?this.$C(e,i,r):n._jQueryShim.isArray(e)?this.$D(e,i):this.$E(e,i)},$v:function(){this.$G();var e=new n._Deferred,i={};this.$d(i);var r=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.FetchSelectedMarksCommand",0,t.mkdel(this,(function(t){this.$L=n.MarkImpl.processActiveMarks(t),e.resolve(this.$L._toApiCollection())})),(function(t,i){e.reject(n._TableauException.createServerError(i))}));return this.sendCommand(Object).call(this,i,r),e.get_promise()},$C:function(e,t,i){var n=[],r=[],a=[],s=[],o=[],l=[];return this.$A(n,r,a,s,o,l,e,t),this.$F(null,n,r,a,s,o,l,i)},$E:function(e,i){var r=e,a=[],s=[],o=[],l=[],u=[],c=[],h=new t.ObjectEnumerator(r);try{for(;h.moveNext();){var f=h.current();e.hasOwnProperty(f.key)&&(n._jQueryShim.isFunction(r[f.key])||this.$A(a,s,o,l,u,c,f.key,f.value))}}finally{h.dispose()}return this.$F(null,a,s,o,l,u,c,i)},$D:function(e,i){for(var r=[],a=[],s=[],o=[],l=[],u=[],c=[],h=0;h<e.length;h++){var f=e[h];if(t.isValue(f.impl.get_tupleId())&&f.impl.get_tupleId()>0)c.push(f.impl.get_tupleId());else for(var m=f.impl.get_pairs(),d=0;d<m.get__length();d++){var p=m.get_item(d);p.hasOwnProperty("fieldName")&&p.hasOwnProperty("value")&&!n._jQueryShim.isFunction(p.fieldName)&&!n._jQueryShim.isFunction(p.value)&&this.$A(r,a,s,o,l,u,p.fieldName,p.value)}}return this.$F(c,r,a,s,o,l,u,i)},$A:function(e,i,r,a,s,o,l,u){var c=u;if(S.$2.test(l))this.$c(r,a,l,u);else if(t.isValue(c.min)||t.isValue(c.max)){var h=new Object;if(t.isValue(c.min))if(n._Utility.isDate(c.min)){var f=c.min;if(!n._Utility.isDateValid(f))throw n._TableauException.createInvalidDateParameter("options.min");h.min=n._Utility.serializeDateForServer(f)}else h.min=c.min;if(t.isValue(c.max))if(n._Utility.isDate(c.max)){var m=c.max;if(!n._Utility.isDateValid(m))throw n._TableauException.createInvalidDateParameter("options.max");h.max=n._Utility.serializeDateForServer(m)}else h.max=c.max;if(t.isValue(c.nullOption)){var d=n.PublicEnums.normalizeEnum(n.ApiNullOption).call(null,c.nullOption,"options.nullOption");h.nullOption=d}else h.nullOption="allValues";var p=JSON.stringify(h);this.$c(s,o,l,p)}else this.$c(e,i,l,u)},$c:function(e,t,i,r){var a=[];if(n._jQueryShim.isArray(r))for(var s=r,o=0;o<s.length;o++)a.push(s[o].toString());else a.push(r.toString());t.push(a),e.push(i)},$F:function(e,i,r,a,s,o,l,u){var c={};if(this.$d(c),u=n.PublicEnums.normalizeEnum(n.ApiSelectionUpdateType).call(null,u,"updateType"),c["api.filterUpdateType"]=u,n._Utility.isNullOrEmpty(e)||(c["api.tupleIds"]=JSON.stringify(e)),!n._Utility.isNullOrEmpty(i)&&!n._Utility.isNullOrEmpty(r)){c["api.categoricalFieldCaption"]=JSON.stringify(i);for(var h=[],f=0;f<r.length;f++){var m=JSON.stringify(r[f]);h.push(m)}c["api.categoricalMarkValues"]=JSON.stringify(h)}if(!n._Utility.isNullOrEmpty(a)&&!n._Utility.isNullOrEmpty(s)){c["api.hierarchicalFieldCaption"]=JSON.stringify(a);for(var d=[],p=0;p<s.length;p++){var $=JSON.stringify(s[p]);d.push($)}c["api.hierarchicalMarkValues"]=JSON.stringify(d)}if(!n._Utility.isNullOrEmpty(o)&&!n._Utility.isNullOrEmpty(l)){c["api.rangeFieldCaption"]=JSON.stringify(o);for(var _=[],g=0;g<l.length;g++){var v=JSON.stringify(l[g]);_.push(v)}c["api.rangeMarkValues"]=JSON.stringify(_)}if(n._Utility.isNullOrEmpty(c["api.tupleIds"])&&n._Utility.isNullOrEmpty(c["api.categoricalFieldCaption"])&&n._Utility.isNullOrEmpty(c["api.hierarchicalFieldCaption"])&&n._Utility.isNullOrEmpty(c["api.rangeFieldCaption"]))throw n._TableauException.createInvalidParameter("fieldNameOrFieldValuesMap");var y=new n._Deferred,w=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.SelectMarksCommand",1,(function(e){var i=S.$0(e);t.isNullOrUndefined(i)?y.resolve():y.reject(i)}),(function(e,t){y.reject(n._TableauException.createServerError(t))}));return this.sendCommand(Object).call(this,c,w),y.get_promise()},$w:function(e){this.$G();var t=new n._Deferred,i=this.$J.getSummaryDataCommandParams(e);this.$d(i);var r=this.$J.getSummaryDataResponseHandler(t);return this.sendCommand(Object).call(this,i,r),t.get_promise()},$x:function(e){this.$G();var t=new n._Deferred,i=this.$J.getUnderlyingDataCommandParams(e);this.$d(i);var r=this.$J.getUnderlyingDataResponseHandler(t);return this.sendCommand(Object).call(this,i,r),t.get_promise()},$o:function(){this.$G();var e=new n._Deferred,i={};this.$d(i);var r=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.ClearHighlightedMarksCommand",1,(function(t){e.resolve()}),(function(t,i){e.reject(n._TableauException.createServerError(i))}));return this.sendCommand(Object).call(this,i,r),e.get_promise()},$y:function(e,i){n._Param.verifyString(e,"fieldName"),this.$G();var r=new n._Deferred,a={};a["api.fieldCaption"]=e,a["api.ObjectTextIDs"]=i,this.$d(a);var s=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.HighlightMarksCommand",0,(function(e){r.resolve()}),(function(e,t){r.reject(n._TableauException.createServerError(t))}));return this.sendCommand(Object).call(this,a,s),r.get_promise()},$z:function(e,i){n._Param.verifyString(e,"fieldName"),n._Param.verifyString(i,"patternMatch"),this.$G();var r=new n._Deferred,a={"api.filterUpdateType":"replace"};a["api.fieldCaption"]=e,a["api.Pattern"]=i,this.$d(a);var s=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.HighlightMarksByPatternMatch",0,(function(e){r.resolve()}),(function(e,t){r.reject(n._TableauException.createServerError(t))}));return this.sendCommand(Object).call(this,a,s),r.get_promise()},$u:function(){this.$G();var e=new n._Deferred,i={};this.$d(i);var r=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.FetchHighlightedMarksCommand",0,t.mkdel(this,(function(t){this.highlightedMarks=n.MarkImpl.processActiveMarks(t),e.resolve(this.highlightedMarks._toApiCollection())})),(function(t,i){e.reject(n._TableauException.createServerError(i))}));return this.sendCommand(Object).call(this,i,r),e.get_promise()}},p),t.initClass(P,i,{getViz:function(){return this.$1},getEventName:function(){return this.$0}}),t.initClass(N,i,{getCustomViewAsync:function(){var e=new n._Deferred,i=null;return t.isValue(this.$2.get__customViewImpl())&&(i=this.$2.get__customViewImpl().$5()),e.resolve(i),e.get_promise()}},P),t.initClass(L,i,{getWorksheet:function(){return this.$2.get_worksheet()}},P),t.initClass(T,i,{getFieldName:function(){return this.$4},getFilterAsync:function(){return this.$3.get__worksheetImpl().$s(this.$3.get__filterFieldName(),null,null)}},L),t.initClass(A,i,{getVizSize:function(){return this.$2}},P),t.initClass(I,i,{getHighlightedMarksAsync:function(){return this.$3.get__worksheetImpl().$u()}},L),t.initInterface(O,i,{add_customViewsListLoad:null,remove_customViewsListLoad:null,handleVizLoad:null,handleVizListening:null,sendScaleFactor:null}),t.initClass(V,i,{registerHandler:function(e){this.$2.registerHandler(e),e.add_customViewsListLoad(t.mkdel(this,this.$0))},unregisterHandler:function(e){this.$2.unregisterHandler(e),e.remove_customViewsListLoad(t.mkdel(this,this.$0))},sendCommand:function(e){return function(i,n,r){if(this.$2.sendCommand(e).call(this.$2,i,n,r),"api.ShowCustomViewCommand"===r.get_commandName()){var a=this.$3[i.get_hostId()];t.isNullOrUndefined(a)&&(a=[],this.$3[i.get_hostId()]=a),a.push(r)}}},$0:function(e){var i=e.get_hostId(),n=this.$3[i];if(!t.isNullOrUndefined(n)){for(var r=0;r<n.length;r++){var a=n[r];t.staticEquals(a.get_successCallback(),null)||a.get_successCallback()(null)}delete this.$3[i]}},$1:function(e,i){if("layoutInfoReq"===e.get_name())w.$1();else if("tableau.completed"===e.get_name()||"completed"===e.get_name())i.handleVizLoad();else if("tableau.listening"===e.get_name())i.handleVizListening();else if("sf?"===e.get_name()&&t.count(e.get_parameters())>0){var n=t.getItem(e.get_parameters(),0);i.sendScaleFactor(n)}}}),t.initClass(k,i,{get_handler:function(){return this.$0},get_router:function(){return this.$1},sendCommand:function(e){return function(t,i){this.$1.sendCommand(e).call(this.$1,this.$0,t,i)}},dispose:function(){this.$1.unregisterHandler(this.$0)}}),t.initClass(x,i,{getMarksAsync:function(){var e=this.$3.get__worksheetImpl();return t.isValue(e.get_selectedMarks())?(new n._Deferred).resolve(e.get_selectedMarks()._toApiCollection()):e.$v()}},L),t.initClass(D,i,{getParameterName:function(){return this.$2.get__parameterName()},getParameterAsync:function(){return this.$2.get__workbookImpl().$8(this.$2.get__parameterName())}},P),t.initClass(R,i,{}),t.initClass(U,i,{getOldStoryPointInfo:function(){return this.$3},getNewStoryPoint:function(){return this.$2}},P),t.initClass(z,i,{getOldSheetName:function(){return this.$3},getNewSheetName:function(){return this.$2}},P),t.initClass(F,i,{getToolbarState:function(){return this.$2.get_toolbarState()}},P),t.initClass(j,i,{add_customViewsListLoad:function(e){this.$1$1=t.delegateCombine(this.$1$1,e)},remove_customViewsListLoad:function(e){this.$1$1=t.delegateRemove(this.$1$1,e)},add_stateReadyForQuery:function(e){this.$1$2=t.delegateCombine(this.$1$2,e)},remove_stateReadyForQuery:function(e){this.$1$2=t.delegateRemove(this.$1$2,e)},$1F:function(e){this.$1$3=t.delegateCombine(this.$1$3,e)},$1G:function(e){this.$1$3=t.delegateRemove(this.$1$3,e)},$1D:function(e){this.$1$4=t.delegateCombine(this.$1$4,e)},$1E:function(e){this.$1$4=t.delegateRemove(this.$1$4,e)},$1B:function(e){this.$1$5=t.delegateCombine(this.$1$5,e)},$1C:function(e){this.$1$5=t.delegateRemove(this.$1$5,e)},$1H:function(e){this.$1$6=t.delegateCombine(this.$1$6,e)},$1I:function(e){this.$1$6=t.delegateRemove(this.$1$6,e)},$1t:function(e){this.$1$7=t.delegateCombine(this.$1$7,e)},$1u:function(e){this.$1$7=t.delegateRemove(this.$1$7,e)},$1x:function(e){this.$1$8=t.delegateCombine(this.$1$8,e)},$1y:function(e){this.$1$8=t.delegateRemove(this.$1$8,e)},$1v:function(e){this.$1$9=t.delegateCombine(this.$1$9,e)},$1w:function(e){this.$1$9=t.delegateRemove(this.$1$9,e)},$1z:function(e){this.$1$10=t.delegateCombine(this.$1$10,e)},$1A:function(e){this.$1$10=t.delegateRemove(this.$1$10,e)},$1L:function(e){this.$1$11=t.delegateCombine(this.$1$11,e)},$1M:function(e){this.$1$11=t.delegateRemove(this.$1$11,e)},$1N:function(e){this.$1$12=t.delegateCombine(this.$1$12,e)},$1O:function(e){this.$1$12=t.delegateRemove(this.$1$12,e)},$1J:function(e){this.$1$13=t.delegateCombine(this.$1$13,e)},$1K:function(e){this.$1$13=t.delegateRemove(this.$1$13,e)},$1P:function(e){this.$1$14=t.delegateCombine(this.$1$14,e)},$1Q:function(e){this.$1$14=t.delegateRemove(this.$1$14,e)},get_hostId:function(){return this.$1n.hostId},set_hostId:function(e){this.$1n.hostId=e},get_iframe:function(){return this.$1e},get_instanceId:function(){return this.$1h},set_instanceId:function(e){this.$1h=e},$18:function(){return this.$1p},$13:function(){return this.$1d},$15:function(){return this.$1i},$14:function(){return"none"===this.$1e.style.display},$16:function(){return this.$1n.parentElement},$17:function(){return this.$1n.get_baseUrl()},$1a:function(){return this.$1s.get_workbook()},get__workbookImpl:function(){return this.$1s},$12:function(){return this.$1c},$19:function(){return this.$1q},getCurrentUrlAsync:function(){var e=new n._Deferred,i=new(t.makeGenericType(n.CommandReturnHandler$1,[String]))("api.GetCurrentUrlCommand",0,(function(t){e.resolve(t)}),(function(t,i){e.reject(n._TableauException.createInternalError(i))}));return this._sendCommand(String).call(this,null,i),e.get_promise()},handleVizListening:function(){this.$8()},handleVizLoad:function(){t.isNullOrUndefined(this.$1q)&&(this.$Q(this.$1f.width+"px",this.$1f.height+"px"),this.$S()),t.isValue(this.$1o)&&(this.$1o.style.display="none"),t.isNullOrUndefined(this.$1s)?this.$1s=new E(this,this.$1j,t.mkdel(this,(function(){this.$x(null)}))):this.$1g||this.$1s._update(t.mkdel(this,(function(){this.$x(null)}))),this.sendScaleFactor("-1")},$1:function(e){var t,i,r,a,s=this.$1q.chromeHeight,o=this.$1q.sheetSize,l=0,u=0;if("exactly"===o.behavior)l=o.maxSize.width,u=o.maxSize.height+s;else switch(o.behavior){case"range":t=o.minSize.width,i=o.maxSize.width,r=o.minSize.height+s,a=o.maxSize.height+s,l=Math.max(t,Math.min(i,e.width)),u=Math.max(r,Math.min(a,e.height));break;case"atleast":t=o.minSize.width,r=o.minSize.height+s,l=Math.max(t,e.width),u=Math.max(r,e.height);break;case"atmost":i=o.maxSize.width,a=o.maxSize.height+s,l=Math.min(i,e.width),u=Math.min(a,e.height);break;case"automatic":l=e.width,u=Math.max(e.height,s);break;default:throw n._TableauException.createInternalError("Unknown SheetSizeBehavior for viz: "+o.behavior.toString())}return n.Size.$ctor(l,u)},$b:function(){var e;return t.isValue(this.$1f)?(e=this.$1f,this.$1f=null):e=n._Utility.computeContentSize(this.$16()),this.$H(e),this.$1(e)},$K:function(){if(t.isValue(this.$1q)){var e=this.$b();if(e.height!==this.$1q.chromeHeight){this.$Q(e.width+"px",e.height+"px");for(var i=0;i<10;i++){var r=this.$b();if(t.referenceEquals(JSON.stringify(e),JSON.stringify(r)))return;e=r,this.$Q(e.width+"px",e.height+"px")}throw n._TableauException.create("maxVizResizeAttempts","Viz resize limit hit. The calculated iframe size did not stabilize after 10 resizes.")}}},handleEventNotification:function(e,t){var i=n._ApiServerNotification.deserialize(t);switch(e){case"api.FirstVizSizeKnownEvent":this.$i(i);break;case"api.VizInteractiveEvent":this.$q(i);break;case"api.MarksSelectionChangedEvent":this.$l(i);break;case"api.MarksHighlightChangedEvent":this.$k(i);break;case"api.FilterChangedEvent":this.$h(i);break;case"api.ParameterChangedEvent":this.$m(i);break;case"api.CustomViewsListLoadedEvent":this.$g(i);break;case"api.CustomViewUpdatedEvent":this.$f(i);break;case"api.CustomViewRemovedEvent":this.$d();break;case"api.CustomViewSetDefaultEvent":this.$e(i);break;case"api.TabSwitchEvent":this.$o(i);break;case"api.ToolbarStateChangedEvent":this.$p(i);break;case"api.StorytellingStateChangedEvent":this.$n(i)}},addEventListener:function(e,t){var i={};if(!n.PublicEnums.tryNormalizeEnum(n.ApiTableauEventName).call(null,e,i))throw n._TableauException.createUnsupportedEventName(e.toString());switch(i.$){case"marksselection":this.$1F(t);break;case"markshighlight":this.$1D(t);break;case"parametervaluechange":this.$1H(t);break;case"filterchange":this.$1B(t);break;case"customviewload":this.$1t(t);break;case"customviewsave":this.$1x(t);break;case"customviewremove":this.$1v(t);break;case"customviewsetdefault":this.$1z(t);break;case"tabswitch":this.$1L(t);break;case"storypointswitch":this.$1J(t);break;case"toolbarstatechange":this.$1N(t);break;case"vizresize":this.$1P(t)}},removeEventListener:function(e,t){var i={};if(!n.PublicEnums.tryNormalizeEnum(n.ApiTableauEventName).call(null,e,i))throw n._TableauException.createUnsupportedEventName(e.toString());switch(i.$){case"marksselection":this.$1G(t);break;case"markshighlight":this.$1E(t);break;case"parametervaluechange":this.$1I(t);break;case"filterchange":this.$1C(t);break;case"customviewload":this.$1u(t);break;case"customviewsave":this.$1y(t);break;case"customviewremove":this.$1w(t);break;case"customviewsetdefault":this.$1A(t);break;case"tabswitch":this.$1M(t);break;case"toolbarstatechange":this.$1O(t);break;case"storypointswitch":this.$1K(t);break;case"vizresize":this.$1Q(t)}},$7:function(){t.isValue(this.$1e)&&(this.$1e.parentNode.removeChild(this.$1e),this.$1e=null),w.$2(this.$1p),this.$1j.get_router().unregisterHandler(this),this.$L()},$S:function(){this.$1e.style.display="block",this.$1e.style.visibility="visible"},$r:function(){this.$1e.style.display="none"},$u:function(){this.$1e.style.visibility="hidden"},$W:function(){this.$t("showExportImageDialog")},$V:function(e){var t=this.$11(e);this.$t("showExportDataDialog",t)},$U:function(e){var t=this.$11(e);this.$t("showExportCrosstabDialog",t)},$X:function(){this.$t("showExportPDFDialog")},$N:function(){return n._Utility.noResultPromiseHelper("api.RevertAllCommand",null,this.$1j)},$J:function(){return n._Utility.noResultPromiseHelper("api.RefreshDataCommand",null,this.$1j)},$Y:function(){this.$t("showShareDialog")},$T:function(){if(!this.get__workbookImpl().get_isDownloadAllowed())throw n._TableauException.create("downloadWorkbookNotAllowed","Download workbook is not allowed");this.$t("showDownloadWorkbookDialog")},$y:function(){return this.$s("pauseAutomaticUpdates")},$M:function(){return this.$s("resumeAutomaticUpdates")},$Z:function(){return this.$s("toggleAutomaticUpdates")},$R:function(e,t){this.$H(n.Size.$ctor(-1,-1)),this.$Q(e,t),this.$1s._updateActiveSheetAsync()},$P:function(e){this.$1c=e},$3:function(){return this.$1n.parentElement},$4:function(){try{w.$0(this.$1p)}catch(i){var e=t.Exception.wrap(i);throw this.$7(),e}this.$1n.fixedSize?(this.$1n.displayStaticImage&&(this.$1o=this.$6(n.Size.$ctor(parseInt(this.$1n.width),parseInt(this.$1n.height))),this.$1o.style.display="block"),this.$1e=this.$5(),this.$S()):(this.$1f=n._Utility.computeContentSize(this.$16()),0!==this.$1f.width&&0!==this.$1f.height||(this.$1f=n.Size.$ctor(800,600)),this.$1e=this.$5(),this.$u(),this.$1n.displayStaticImage&&(this.$1o=this.$6(this.$1f),this.$1o.style.display="block")),n._Utility.hasWindowPostMessage()||(n._Utility.isIE()?this.$1e.onreadystatechange=this.$c():this.$1e.onload=this.$c()),this.$1i=!this.$1n.toolbar,this.$1d=!this.$1n.tabs,this.$1j.get_router().registerHandler(this),this.$1e.src=this.$1n.get_url()},$O:function(){try{if(!n._Utility.hasWindowPostMessage()||t.isNullOrUndefined(this.$1e)||!t.isValue(this.$1e.contentWindow))return}catch(e){return}var e=n._Utility.visibleContentRectInDocumentCoordinates(this.get_iframe()),i=n._Utility.contentRectInDocumentCoordinates(this.get_iframe()),r=new n.NonApiCommand("layoutInfoResp",[(e.left-i.left).toString(),(e.top-i.top).toString(),e.width.toString(),e.height.toString()]);this.$1e.contentWindow.postMessage(r.serialize(),"*")},$8:function(){if(n._Utility.hasWindowPostMessage()&&!t.isNullOrUndefined(this.$1e)&&t.isValue(this.$1e.contentWindow)){var e=new n.NonApiCommand("tableau.enableVisibleRectCommunication",[]);this.$1e.contentWindow.postMessage(e.serialize(),"*")}},$I:function(){return n._Utility.noResultPromiseHelper("api.Redo",null,this.$1j)},$10:function(){return n._Utility.noResultPromiseHelper("api.Undo",null,this.$1j)},sendScaleFactor:function(e){var i=document.documentElement.clientWidth/window.innerWidth,r=new n.NonApiCommand("sf",[e,i.toString(),(0).toString(),(0).toString()]);t.isValue(this.$1e)&&t.isValue(this.$1e.contentWindow)&&this.$1e.contentWindow.postMessage(r.serialize(),"*")},_sendCommand:function(e){return function(t,i){this.$1j.sendCommand(e).call(this.$1j,t,i)}},$E:function(e){t.staticEquals(this.$1$6,null)||this.$1$6(new D("parametervaluechange",this.$1p,e))},$z:function(e){this.get__workbookImpl()._update(t.mkdel(this,(function(){t.staticEquals(this.$1$7,null)||this.$1$7(new N("customviewload",this.$1p,t.isValue(e)?e._impl:null))})))},$B:function(e){this.get__workbookImpl()._update(t.mkdel(this,(function(){t.staticEquals(this.$1$8,null)||this.$1$8(new N("customviewsave",this.$1p,e._impl))})))},$A:function(e){t.staticEquals(this.$1$9,null)||this.$1$9(new N("customviewremove",this.$1p,e._impl))},$C:function(e){t.staticEquals(this.$1$10,null)||this.$1$10(new N("customviewsetdefault",this.$1p,e._impl))},$G:function(e,i){t.staticEquals(this.$1$11,null)||this.$1$11(new z("tabswitch",this.$1p,e,i))},raiseStoryPointSwitch:function(e,i){t.staticEquals(this.$1$13,null)||this.$1$13(new U("storypointswitch",this.$1p,e,i))},$F:function(){t.staticEquals(this.$1$2,null)||this.$1$2(this)},$D:function(){t.staticEquals(this.$1$1,null)||this.$1$1(this)},$H:function(e){t.staticEquals(this.$1$14,null)||this.$1$14(new M("vizresize",this.$1p,e))},$Q:function(e,t){this.$1n.width=e,this.$1n.height=t,this.$1e.style.width=this.$1n.width,this.$1e.style.height=this.$1n.height},$11:function(e){if(t.isNullOrUndefined(e))return null;var i=this.$1s.$4(e);if(t.isNullOrUndefined(i))throw n._TableauException.createNotActiveSheet();return i.get_name()},$s:function(e){if("pauseAutomaticUpdates"!==e&&"resumeAutomaticUpdates"!==e&&"toggleAutomaticUpdates"!==e)throw n._TableauException.createInternalError(null);var i={};i["api.invokeCommandName"]=e;var r=new n._Deferred,a=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.InvokeCommandCommand",0,t.mkdel(this,(function(e){t.isValue(e)&&t.isValue(e.isAutoUpdate)&&(this.$1c=!e.isAutoUpdate),r.resolve(this.$1c)})),(function(e,t){r.reject(n._TableauException.createServerError(t))}));return this._sendCommand(Object).call(this,i,a),r.get_promise()},$t:function(e,i){if("showExportImageDialog"!==e&&"showExportDataDialog"!==e&&"showExportCrosstabDialog"!==e&&"showExportPDFDialog"!==e&&"showShareDialog"!==e&&"showDownloadWorkbookDialog"!==e)throw n._TableauException.createInternalError(null);var r={};r["api.invokeCommandName"]=e,t.isValue(i)&&(r["api.invokeCommandParam"]=i);var a=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.InvokeCommandCommand",0,null,null);this._sendCommand(Object).call(this,r,a)},$i:function(e){var t=JSON.parse(e.get_data());this.$j(t)},$q:function(e){t.isValue(this.$1s)&&t.referenceEquals(this.$1s.get_name(),e.get_workbookName())?this.$x(null):this.$F()},$l:function(e){if(!t.staticEquals(this.$1$3,null)&&t.referenceEquals(this.$1s.get_name(),e.get_workbookName())){var i=null,n=this.$1s.get_activeSheetImpl();if(n.get_isStory()&&(n=n.get_activeStoryPointImpl().get_containedSheetImpl()),t.referenceEquals(n.get_name(),e.get_worksheetName()))i=n;else if(n.get_isDashboard()){i=n.get_worksheets()._get(e.get_worksheetName())._impl}t.isValue(i)&&(i.set_selectedMarks(null),this.$1$3(new x("marksselection",this.$1p,i)))}},$k:function(e){if(!t.staticEquals(this.$1$4,null)&&t.referenceEquals(this.$1s.get_name(),e.get_workbookName())){var i=null,n=this.$1s.get_activeSheetImpl();if(n.get_isStory()&&(n=n.get_activeStoryPointImpl().get_containedSheetImpl()),t.referenceEquals(n.get_name(),e.get_worksheetName()))i=n;else if(n.get_isDashboard()){i=n.get_worksheets()._get(e.get_worksheetName())._impl}t.isValue(i)&&(i.highlightedMarks=null,this.$1$4(new I("markshighlight",this.$1p,i)))}},$h:function(e){if(!t.staticEquals(this.$1$5,null)&&t.referenceEquals(this.$1s.get_name(),e.get_workbookName())){var i=null,n=this.$1s.get_activeSheetImpl();if(t.referenceEquals(n.get_name(),e.get_worksheetName()))i=n;else if(n.get_isDashboard()){i=n.get_worksheets()._get(e.get_worksheetName())._impl}else if(n.get_isStory()){var r=n.get_activeStoryPointImpl().get_containedSheetImpl();if(r.get_isDashboard())i=r.get_worksheets()._get(e.get_worksheetName())._impl;else t.referenceEquals(r.get_name(),e.get_worksheetName())&&(i=r)}if(t.isValue(i)){var a=JSON.parse(e.get_data()),s=a[0],o=a[1];this.$1$5(new T("filterchange",this.$1p,i,s,o))}}},$m:function(e){if(!t.staticEquals(this.$1$6,null)&&t.referenceEquals(this.$1s.get_name(),e.get_workbookName())){this.$1s.$l(null);var i=e.get_data();this.$E(i)}},$g:function(e){var i=JSON.parse(e.get_data()),n=t.mkdel(this,(function(){f._processCustomViews(this.$1s,this.$1j,i)})),r=t.mkdel(this,(function(){this.$D(),t.staticEquals(this.$1$7,null)||i.customViewLoaded||this.$z(this.$1s.get_activeCustomView())}));t.isNullOrUndefined(this.$1s)?(this.$1g=!0,this.$1s=new E(this,this.$1j,t.mkdel(this,(function(){n(),this.$x(r),this.$1g=!1})))):(n(),this.$9(r))},$f:function(e){var i=JSON.parse(e.get_data());if(t.isNullOrUndefined(this.$1s)&&(this.$1s=new E(this,this.$1j,null)),t.isValue(this.$1s)&&f._processCustomViewUpdate(this.$1s,this.$1j,i,!0),!t.staticEquals(this.$1$8,null))for(var n=this.$1s.$p()._toApiCollection(),r=0,a=n.length;r<a;r++)this.$B(n[r])},$d:function(){if(!t.staticEquals(this.$1$9,null))for(var e=this.$1s.$n()._toApiCollection(),i=0,n=e.length;i<n;i++)this.$A(e[i])},$e:function(e){var i=JSON.parse(e.get_data());if(t.isValue(this.$1s)&&f._processCustomViews(this.$1s,this.$1j,i),!t.staticEquals(this.$1$10,null)&&t.isValue(i.defaultCustomViewId))for(var n=this.$1s.$i(),r=0;r<n.get__length();r++){var a=n.get_item(r);if(a.getDefault()){this.$C(a);break}}},$o:function(e){this.$1s._update(t.mkdel(this,(function(){if(t.isValue(this.$1b)&&this.$1b(),t.referenceEquals(this.$1s.get_name(),e.get_workbookName())){var i=e.get_worksheetName(),n=e.get_data();this.$G(i,n)}this.$x(null)})))},$p:function(e){var i=JSON.parse(e.get_data()),n=new y(this,i);t.staticEquals(this.$1$12,null)||this.$1$12(new F("toolbarstatechange",this.$1p,n))},$n:function(e){var t=this.$1s.get_activeSheetImpl();"story"===t.get_sheetType()&&t.update(JSON.parse(e.get_data()))},$x:function(e){if(!this.$1k){var i=this.$1l;window.setTimeout(t.mkdel(this,(function(){t.staticEquals(i,null)||i(new P("firstinteractive",this.$1p)),t.staticEquals(e,null)||e()})),0),this.$1k=!0}this.$F()},$9:function(e){var i=new Date,r=null;(r=t.mkdel(this,(function(){var t=new Date;if(this.$1k)e();else{if(t-i>3e5)throw n._TableauException.createInternalError("Timed out while waiting for the viz to become interactive");window.setTimeout(r,10)}})))()},$2:function(){n._Utility.isIE()?"complete"===this.$1e.readyState&&this.handleVizLoad():this.handleVizLoad()},$v:function(){window.setTimeout(t.mkdel(this,this.$2),3e3)},$6:function(e){var t=document.createElement("div");return t.style.background="transparent url('"+this.$1n.staticImageUrl+"') no-repeat scroll 0 0",t.style.left="8px",t.style.top=this.$1n.tabs?"31px":"9px",t.style.position="absolute",t.style.width=e.width+"px",t.style.height=e.height+"px",this.$3().appendChild(t),t},$5:function(){if(t.isNullOrUndefined(this.$3()))return null;var e=document.createElement("IFrame");return e.frameBorder="0",e.setAttribute("allowTransparency","true"),e.setAttribute("allowFullScreen","true"),e.setAttribute("title",this.$a()),e.marginHeight="0",e.marginWidth="0",e.style.display="block",this.$1n.fixedSize?(e.style.width=this.$1n.width,e.style.height=this.$1n.height,this.$1n.iframeSizedToWindow&&e.setAttribute("scrolling","no")):(e.style.width="1px",e.style.height="1px",e.setAttribute("scrolling","no")),n._Utility.isSafari()&&e.addEventListener("mousewheel",t.mkdel(this,this.$w),!1),this.$3().appendChild(e),e},$a:function(){var e=window.navigator.language;if("zh-CN"===e)return"数据可视化";switch(e.substr(0,2)){case"fr":return"Visualisation de données";case"es":return"Visualización de datos";case"pt":return"Visualização de dados";case"ja":return"データ ビジュアライゼーション";case"de":return"Datenvisualisierung";case"ko":return"데이터 비주얼리제이션";case"en":default:return"data visualization"}},$w:function(e){},$c:function(){return t.mkdel(this,(function(e){this.$v()}))},$j:function(e){var i=n.SheetSizeFactory.fromSizeConstraints(e.sizeConstraints);this.$1q=H.$ctor(i,e.chromeHeight),t.isValue(this.$1m)&&this.$1m(new A("firstvizsizeknown",this.$1p,this.$1q)),this.$1n.fixedSize||(this.$K(),this.$0(),this.$S())},$L:function(){t.isNullOrUndefined(this.$1r)||(n._Utility.hasWindowAddEventListener()?window.removeEventListener("resize",this.$1r,!1):window.self.detachEvent("onresize",this.$1r),this.$1r=null)},$0:function(){t.isValue(this.$1r)||(this.$1r=t.mkdel(this,(function(){this.$K()})),n._Utility.hasWindowAddEventListener()?window.addEventListener("resize",this.$1r,!1):window.self.attachEvent("onresize",this.$1r))},switchToViz:function(e){var i=new n._Deferred,r={};r["api.invokeCommandParam"]=e;var a=new(t.makeGenericType(n.CommandReturnHandler$1,[Object]))("api.SwitchViz",1,(function(e){i.resolve()}),(function(e,t){i.reject(n._TableauException.createServerError(t))}));return this.$1j.sendCommand(Object).call(this.$1j,r,a),i.get_promise()}},null,[O]),t.initClass(M,i,{getAvailableSize:function(){return this.$2}},P),t.initClass(H,i,{},Object),t.initClass(Q,i,{getFilterType:function(){return this.$6},getFieldName:function(){return this.$1},getWorksheet:function(){return this.$7.get_worksheet()},getFieldAsync:function(){var e=new n._Deferred;if(t.isNullOrUndefined(this.$3)){var i=t.mkdel(this,(function(t){return this.$3=new J(t,this.$1,this.$5,this.$4),e.resolve(this.$3),null}));this.$7.$q(this.$2).then(i,(function(t){return e.reject(t),null}))}else window.setTimeout(t.mkdel(this,(function(){e.resolve(this.$3)})),0);return e.get_promise()},_update:function(e){this.$0(e),this._updateFromJson(e)},_addFieldParams:function(e){},_updateFromJson:null,$0:function(e){this.$1=e.caption,this.$6=n.ApiEnumConverter.convertFilterType(e.filterType),this.$3=null,this.$2=e.dataSourceName,this.$5=n.ApiEnumConverter.convertFieldRole(t.coalesce(e.fieldRole,"unknown")),this.$4=n.ApiEnumConverter.convertFieldAggregation(t.coalesce(e.fieldAggregation,"NONE"))}}),t.initClass(W,i,{getIsExcludeMode:function(){return this.$a},getAppliedValues:function(){return this.$9},_updateFromJson:function(e){this.$8(e)},$8:function(e){if(this.$a=e.isExclude,t.isValue(e.appliedValues)){this.$9=[];for(var i=0;i<e.appliedValues.length;i++){var r=e.appliedValues[i];this.$9.push(n._Utility.getDataValue(r))}}}},Q),t.initClass(G,i,{getWorkbook:function(){return this._impl.$b()},getUrl:function(){return this._impl.$a()},getName:function(){return this._impl.$7()},setName:function(e){this._impl.$8(e)},getOwnerName:function(){return this._impl.$9()},getAdvertised:function(){return this._impl.$3()},setAdvertised:function(e){this._impl.$4(e)},getDefault:function(){return this._impl.$6()},saveAsync:function(){return this._impl.$2()}}),t.initClass(te,i,{getName:function(){return this._impl.get_name()},getIndex:function(){return this._impl.get_index()},getWorkbook:function(){return this._impl.get_workbookImpl().get_workbook()},getSize:function(){return this._impl.get_size()},getIsHidden:function(){return this._impl.get_isHidden()},getIsActive:function(){return this._impl.get_isActive()},getSheetType:function(){return this._impl.get_sheetType()},getUrl:function(){return this._impl.get_url()},changeSizeAsync:function(e){return this._impl.changeSizeAsync(e)}}),t.initClass(q,i,{getParentStoryPoint:function(){return this._impl.get_parentStoryPoint()},getObjects:function(){return this._impl.get_objects()._toApiCollection()},getWorksheets:function(){return this._impl.get_worksheets()._toApiCollection()}},te),t.initClass(B,i,{getObjectType:function(){return this.$2.objectType},getDashboard:function(){return this.$0},getWorksheet:function(){return this.$1},getPosition:function(){return this.$2.position},getSize:function(){return this.$2.size}}),t.initClass(K,i,{getName:function(){return this.$0.get_name()},getFields:function(){return this.$0.get_fields()._toApiCollection()},getIsPrimary:function(){return this.$0.get_isPrimary()}}),t.initClass(J,i,{getDataSource:function(){return this.$0},getName:function(){return this.$3},getRole:function(){return this.$2},getAggregation:function(){return this.$1}}),t.initClass(Y,i,{_addFieldParams:function(e){e["api.filterHierarchicalLevels"]=this.$9},_updateFromJson:function(e){this.$8(e)},$8:function(e){this.$9=e.levels}},Q),t.initClass(X,i,{getName:function(){return this._impl.$7()},getCurrentValue:function(){return this._impl.$2()},getDataType:function(){return this._impl.$3()},getAllowableValuesType:function(){return this._impl.$1()},getAllowableValues:function(){return this._impl.$0()},getMinValue:function(){return this._impl.$6()},getMaxValue:function(){return this._impl.$5()},getStepSize:function(){return this._impl.$9()},getDateStepPeriod:function(){return this._impl.$4()}}),t.initClass(Z,i,{getMin:function(){return this.$d},getMax:function(){return this.$c},getIncludeNullValues:function(){return this.$b},getDomainMin:function(){return this.$a},getDomainMax:function(){return this.$9},_updateFromJson:function(e){this.$8(e)},$8:function(e){this.$a=n._Utility.getDataValue(e.domainMinValue),this.$9=n._Utility.getDataValue(e.domainMaxValue),this.$d=n._Utility.getDataValue(e.minValue),this.$c=n._Utility.getDataValue(e.maxValue),this.$b=e.includeNullValues}},Q),t.initClass(ee,i,{getPeriod:function(){return this.$9},getRange:function(){return this.$b},getRangeN:function(){return this.$a},_updateFromJson:function(e){this.$8(e)},$8:function(e){t.isValue(e.periodType)&&(this.$9=n.ApiEnumConverter.convertPeriodType(t.unbox(e.periodType))),t.isValue(e.rangeType)&&(this.$b=n.ApiEnumConverter.convertDateRange(t.unbox(e.rangeType))),t.isValue(e.rangeN)&&(this.$a=t.unbox(e.rangeN))}},Q),t.initClass(ie,i,{getName:function(){return this.$0.name},getSheetType:function(){return this.$0.sheetType},getSize:function(){return this.$0.size},getIndex:function(){return this.$0.index},getUrl:function(){return this.$0.url},getIsActive:function(){return this.$0.isActive},getIsHidden:function(){return this.$0.isHidden},getWorkbook:function(){return this.$0.workbook}}),t.initClass(ne,i,{getActiveStoryPoint:function(){return this._impl.get_activeStoryPointImpl().get_storyPoint()},getStoryPointsInfo:function(){return this._impl.get_storyPointsInfo()},activatePreviousStoryPointAsync:function(){return this._impl.activatePreviousStoryPointAsync()},activateNextStoryPointAsync:function(){return this._impl.activateNextStoryPointAsync()},activateStoryPointAsync:function(e){return this._impl.activateStoryPointAsync(e)},revertStoryPointAsync:function(e){return this._impl.revertStoryPointAsync(e)}},te),t.initClass(re,i,{getCaption:function(){return this.$0.get_caption()},getContainedSheet:function(){return t.isValue(this.$0.get_containedSheetImpl())?this.$0.get_containedSheetImpl().get_sheet():null},getIndex:function(){return this.$0.get_index()},getIsActive:function(){return this.$0.get_isActive()},getIsUpdated:function(){return this.$0.get_isUpdated()},getParentStory:function(){return this.$0.get_parentStoryImpl().get_story()}}),t.initClass(ae,i,{getCaption:function(){return this._impl.caption},getIndex:function(){return this._impl.index},getIsActive:function(){return this._impl.isActive},getIsUpdated:function(){return this._impl.isUpdated},getParentStory:function(){return this._impl.parentStoryImpl.get_story()}}),t.initClass(se,i,{getViz:function(){return this._impl.get_viz()},isButtonEnabled:function(e){return this._impl.isButtonEnabled(e)}}),t.initClass(oe,i,{getMajor:function(){return this.$0},getMinor:function(){return this.$2},getPatch:function(){return this.$3},getMetadata:function(){return this.$1},toString:function(){var e=this.$0+"."+this.$2+"."+this.$3;return t.isValue(this.$1)&&this.$1.length>0&&(e+="-"+this.$1),e}}),t.initClass(le,i,{getAreTabsHidden:function(){return this._impl.$13()},getIsToolbarHidden:function(){return this._impl.$15()},getIsHidden:function(){return this._impl.$14()},getInstanceId:function(){return this._impl.get_instanceId()},getParentElement:function(){return this._impl.$16()},getUrl:function(){return this._impl.$17()},getVizSize:function(){return this._impl.$19()},getWorkbook:function(){return this._impl.$1a()},getAreAutomaticUpdatesPaused:function(){return this._impl.$12()},getCurrentUrlAsync:function(){return this._impl.getCurrentUrlAsync()},addEventListener:function(e,t){this._impl.addEventListener(e,t)},removeEventListener:function(e,t){this._impl.removeEventListener(e,t)},dispose:function(){this._impl.$7()},switchToViz:function(e){return this._impl.switchToViz(e)},show:function(){this._impl.$S()},hide:function(){this._impl.$r()},showExportDataDialog:function(e){this._impl.$V(e)},showExportCrossTabDialog:function(e){this._impl.$U(e)},showExportImageDialog:function(){this._impl.$W()},showExportPDFDialog:function(){this._impl.$X()},revertAllAsync:function(){return this._impl.$N()},refreshDataAsync:function(){return this._impl.$J()},showShareDialog:function(){this._impl.$Y()},showDownloadWorkbookDialog:function(){this._impl.$T()},pauseAutomaticUpdatesAsync:function(){return this._impl.$y()},resumeAutomaticUpdatesAsync:function(){return this._impl.$M()},toggleAutomaticUpdatesAsync:function(){return this._impl.$Z()},refreshSize:function(){this._impl.$K()},setFrameSize:function(e,t){var i=e,r=t;n._Utility.isNumber(e)&&(i=e.toString()+"px"),n._Utility.isNumber(t)&&(r=t.toString()+"px"),this._impl.$R(i,r)},redoAsync:function(){return this._impl.$I()},undoAsync:function(){return this._impl.$10()}}),t.initClass(ue,i,{}),t.initClass(ce,i,{getViz:function(){return this.$0.get_viz()},getPublishedSheetsInfo:function(){return this.$0.get_publishedSheets()._toApiCollection()},getName:function(){return this.$0.get_name()},getActiveSheet:function(){return this.$0.get_activeSheetImpl().get_sheet()},getActiveCustomView:function(){return this.$0.get_activeCustomView()},activateSheetAsync:function(e){return this.$0._setActiveSheetAsync(e)},revertAllAsync:function(){return this.$0._revertAllAsync()},getCustomViewsAsync:function(){return this.$0.$6()},showCustomViewAsync:function(e){return this.$0.$f(e)},removeCustomViewAsync:function(e){return this.$0.$c(e)},rememberCustomViewAsync:function(e){return this.$0.$b(e)},setActiveCustomViewAsDefaultAsync:function(){return this.$0.$e()},getParametersAsync:function(){return this.$0.$7()},changeParameterValueAsync:function(e,t){return this.$0.$2(e,t)}}),t.initClass(he,i,{getParentDashboard:function(){return this._impl.get_parentDashboard()},getParentStoryPoint:function(){return this._impl.get_parentStoryPoint()},getDataSourcesAsync:function(){return this._impl.$r()},getFilterAsync:function(e,t){return this._impl.$s(null,e,t)},getFiltersAsync:function(e){return this._impl.$t(e)},applyFilterAsync:function(e,t,i,n){return this._impl.$e(e,t,i,n)},clearFilterAsync:function(e){return this._impl.$m(e)},applyRangeFilterAsync:function(e,t){return this._impl.$i(e,t)},applyRelativeDateFilterAsync:function(e,t){return this._impl.$k(e,t)},applyHierarchicalFilterAsync:function(e,t,i,n){return this._impl.$g(e,t,i,n)},clearSelectedMarksAsync:function(){return this._impl.$p()},selectMarksAsync:function(e,t,i){return this._impl.$B(e,t,i)},getSelectedMarksAsync:function(){return this._impl.$v()},getSummaryDataAsync:function(e){return this._impl.$w(e)},getUnderlyingDataAsync:function(e){return this._impl.$x(e)},clearHighlightedMarksAsync:function(){return this._impl.$o()},highlightMarksAsync:function(e,t){return this._impl.$y(e,t)},highlightMarksByPatternMatchAsync:function(e,t){return this._impl.$z(e,t)},getHighlightedMarksAsync:function(){return this._impl.$u()}},te),w.$5=[],p.noZoneId=4294967295,S.$2=new RegExp("\\[[^\\]]+\\]\\.","g"),oe.$0=new oe(2,2,1,"null")}(),window.tableau=window.tableauSoftware=e.tableauSoftware,i.Promise=n._PromiseImpl,n._Deferred=n._DeferredImpl,n._Collection=n._CollectionImpl,n._ApiBootstrap.initialize(),window.tableau._apiLoaded=!0}();const n=function(i,n){let r=null;const a=this;return a.destroy=()=>{r&&r.dispose()},new Promise(((s,o)=>{const l=document.createElement("div");if(l.classList.add(e,t),i.append(l),n.url){const e={hideTabs:n.hideTabs||!1,hideToolbar:n.hideToolbar||!1,device:n.device,width:"100%",height:"100%",onFirstInteractive:()=>{l.classList.remove(t),s(a)}};r=new window.tableau.Viz(l,n.url,e)}else s(a)}))};return n.install=e=>{e.addBlock("tableau",n)},"undefined"!=typeof window&&window.Presenta&&window.Presenta.use(n),n}));
